<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>DomainAuth Version 1</title>
<meta content="Gus Narea" name="author">
<meta content='
       This document defines DomainAuth, a protocol to attribute digital signatures to domain names in such a way that verification can occur entirely offline without a prior distribution of public keys. 
       Each signature is distributed as part of a self-contained "signature bundle" that encapsulates a complete chain of trust comprising: (1) a DNSSEC chain from the root zone to a TXT record containing a public key or its digest, (2) an X.509 certificate chain from the key specified in the TXT record to the final signing key, and (3) the digital signature in the form of a CMS SignedData structure. 
       Finally, signatures can be attributed to the domain name itself (e.g. "example.com") or specific users (e.g. "alice" of "example.com"). 
    ' name="description">
<meta content="xml2rfc 3.28.0" name="generator">
<meta content="dnssec" name="keyword">
<meta content="x509" name="keyword">
<meta content="cms" name="keyword">
<meta content="authentication" name="keyword">
<meta content="draft-narea-domainauth-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.0
    Python 3.12.9
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-narea-domainauth.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DomainAuthV1</td>
<td class="right">April 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Narea</td>
<td class="center">Expires 3 October 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-narea-domainauth-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-04-01" class="published">1 April 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-10-03">3 October 2025</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">G. Narea</div>
<div class="org">Relaycorp</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">DomainAuth Version 1</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines DomainAuth, a protocol to attribute digital signatures to domain names in such a way that verification can occur entirely offline without a prior distribution of public keys.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">Each signature is distributed as part of a self-contained "signature bundle" that encapsulates a complete chain of trust comprising: (1) a DNSSEC chain from the root zone to a TXT record containing a public key or its digest, (2) an X.509 certificate chain from the key specified in the TXT record to the final signing key, and (3) the digital signature in the form of a CMS SignedData structure.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">Finally, signatures can be attributed to the domain name itself (e.g. "example.com") or specific users (e.g. "alice" of "example.com").<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://docs.veraid.net/domainauth-spec/draft-narea-domainauth.html">https://docs.veraid.net/domainauth-spec/draft-narea-domainauth.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-narea-domainauth/">https://datatracker.ietf.org/doc/draft-narea-domainauth/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/CheVeraId/domainauth-spec">https://github.com/CheVeraId/domainauth-spec</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 3 October 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-problem-statement" class="internal xref">Problem Statement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-design-goals" class="internal xref">Design Goals</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-architecture" class="internal xref">Architecture</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-workflow-summary" class="internal xref">Workflow Summary</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-organisation-setup" class="internal xref">Organisation Setup</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="auto internal xref">2.2.2</a>.  <a href="#name-certificate-issuance" class="internal xref">Certificate Issuance</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="auto internal xref">2.2.3</a>.  <a href="#name-signature-bundle-production" class="internal xref">Signature Bundle Production</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.4">
                    <p id="section-toc.1-1.2.2.2.2.4.1"><a href="#section-2.2.4" class="auto internal xref">2.2.4</a>.  <a href="#name-signature-bundle-verificati" class="internal xref">Signature Bundle Verification</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-trust-model" class="internal xref">Trust Model</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-dns-integration" class="internal xref">DNS Integration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-dnssec-configuration" class="internal xref">DNSSEC Configuration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-txt-record" class="internal xref">TXT Record</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-ttl-override" class="internal xref">TTL Override</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-dnssec-chain-serialisation" class="internal xref">DNSSEC Chain Serialisation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-x509-certificate-profile" class="internal xref">X.509 Certificate Profile</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-organisation-certificate" class="internal xref">Organisation Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-member-certificate" class="internal xref">Member Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-intermediate-certificate" class="internal xref">Intermediate Certificate</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-member-id-bundle" class="internal xref">Member Id Bundle</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-cms-signeddata-structure" class="internal xref">CMS SignedData Structure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-signature-types" class="internal xref">Signature Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-member-signatures" class="internal xref">Member Signatures</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-organisation-signatures" class="internal xref">Organisation Signatures</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-signature-metadata" class="internal xref">Signature Metadata</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-signature-bundle" class="internal xref">Signature Bundle</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-verification-procedure" class="internal xref">Verification Procedure</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-cryptographic-algorithms" class="internal xref">Cryptographic Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-digital-signature-algorithm" class="internal xref">Digital Signature Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-hash-functions" class="internal xref">Hash Functions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-maximum-validity-period" class="internal xref">Maximum Validity Period</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-data-serialisation" class="internal xref">Data Serialisation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-test-service" class="internal xref">Test Service</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-veraid" class="internal xref">VeraId</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-letro" class="internal xref">Letro</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-dnssec-dependency" class="internal xref">DNSSEC Dependency</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-phishing-attacks" class="internal xref">Phishing Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="auto internal xref">13.3</a>.  <a href="#name-domain-ownership-changes" class="internal xref">Domain Ownership Changes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#section-13.4" class="auto internal xref">13.4</a>.  <a href="#name-offline-verification-limita" class="internal xref">Offline Verification Limitations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#section-13.5" class="auto internal xref">13.5</a>.  <a href="#name-denial-of-service" class="internal xref">Denial of Service</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.6">
                <p id="section-toc.1-1.13.2.6.1"><a href="#section-13.6" class="auto internal xref">13.6</a>.  <a href="#name-key-management" class="internal xref">Key Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.7">
                <p id="section-toc.1-1.13.2.7.1"><a href="#section-13.7" class="auto internal xref">13.7</a>.  <a href="#name-audit-trails" class="internal xref">Audit Trails</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-domainauth-signature-algori" class="internal xref">DomainAuth Signature Algorithm Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-domainauth-key-digest-type-" class="internal xref">DomainAuth Key Digest Type Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="auto internal xref">16</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#section-16.1" class="auto internal xref">16.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#section-16.2" class="auto internal xref">16.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-asn1-schemas" class="internal xref">ASN.1 Schemas</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-oid-registry" class="internal xref">OID Registry</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-service-design-guidance" class="internal xref">Service Design Guidance</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-service-security-considerat" class="internal xref">Service Security Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-service-user-experience-con" class="internal xref">Service User Experience Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-implementation-guidance" class="internal xref">Implementation Guidance</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-E" class="auto internal xref">Appendix E</a>.  <a href="#name-organisation-operation-guid" class="internal xref">Organisation Operation Guidance</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.1">
                <p id="section-toc.1-1.21.2.1.1"><a href="#appendix-E.1" class="auto internal xref">E.1</a>.  <a href="#name-tld-dnssec-considerations" class="internal xref">TLD DNSSEC Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.2">
                <p id="section-toc.1-1.21.2.2.1"><a href="#appendix-E.2" class="auto internal xref">E.2</a>.  <a href="#name-organisation-key-management" class="internal xref">Organisation Key Management</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-F" class="auto internal xref">Appendix F</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#appendix-G" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Public Key Infrastructures typically require continuous Internet connectivity for certificate validation or prior distribution of public keys, creating significant limitations for offline or intermittently connected environments.  This document addresses the challenge of securely attributing content to domain names in scenarios where verification must occur entirely offline, without reliance on real-time certificate status checking or pre-distributed trust anchors.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">DomainAuth solves this verification challenge by creating self-contained "signature bundles" that encapsulate the complete trust chain required for validation.  Each bundle comprises three cryptographically linked components: a DNSSEC chain extending from the DNS root to a domain's TXT record containing key material, an X.509 certificate chain from the domain to the signing entity, and a CMS SignedData structure containing the digital signature.  This architecture leverages established standards whilst eliminating the need for continuous connectivity or prior trust establishment.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This specification defines the protocol components, data structures, and verification procedures that constitute the DomainAuth protocol.  It covers the DNS integration mechanism, cryptographic requirements, certificate management practices, and signature verification processes.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="problem-statement">
<section id="section-1.1">
        <h3 id="name-problem-statement">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-problem-statement" class="section-name selfRef">Problem Statement</a>
        </h3>
<p id="section-1.1-1">The protocol was initially designed and implemented to provide users of the offline messaging application Letro <span>[<a href="#LETRO" class="cite xref">LETRO</a>]</span> with identifiers that are customisable, user friendly, universally unique, and verifiable.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Letro is powered by the delay-tolerant network Awala <span>[<a href="#AWALA" class="cite xref">AWALA</a>]</span>, which offers an end-to-end encrypted sneakernet to transport data between a region disconnected from the Internet and a location with access to the Internet.  In the most extreme cases, this physical transport may take several weeks, during which users should be able to produce and verify digital signatures without relying on online services.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Attacks by powerful adversaries, such as nation-state actors, are part of the threat model, given that Awala and Letro explicitly target people disconnected from the Internet due to conflict or government-sponsored censorship.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">Despite its origin in delay-tolerant networking, DomainAuth has broader applicability and can be useful when the Internet is available, such as the following use cases:<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-5.1">
            <p id="section-1.1-5.1.1">Client authentication.  A client could prove its identity to a server by sending a short-lived token signed with DomainAuth; this would be analogous to using a JSON Web Token <span>[<a href="#JWT" class="cite xref">JWT</a>]</span>, except that it can be verified without a prior distribution of public keys or remote operations.  Alternatively, the client could sign each message sent to the server.<a href="#section-1.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-5.2">
            <p id="section-1.1-5.2.1">Artefact signing.  Documents, applications, libraries, and other files could be signed on behalf of a domain name, without vendor-specific gatekeeping mechanisms.  This could unlock further use cases, such as enabling users to share original content whilst proving authenticity and integrity, instead of sharing URLs to resources that could be blocked at the network level.<a href="#section-1.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-5.3">
            <p id="section-1.1-5.3.1">Peer-to-peer web hosting.  A next-generation of websites could be hosted on a peer-to-peer network, with files reliably attributed to their respective domain names.<a href="#section-1.1-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.1-6">The present document is meant to provide the foundation for all the use cases above in a generic manner.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="design-goals">
<section id="section-1.2">
        <h3 id="name-design-goals">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-design-goals" class="section-name selfRef">Design Goals</a>
        </h3>
<p id="section-1.2-1">DomainAuth is designed with the following primary goals:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.2-2">
<li id="section-1.2-2.1">
            <p id="section-1.2-2.1.1"><strong>Offline verification:</strong> All signature bundles contain sufficient information to be independently verified without requiring external network queries.<a href="#section-1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-2.2">
            <p id="section-1.2-2.2.1"><strong>Decentralisation:</strong> The protocol avoids the need for centralised authorities beyond the DNS hierarchy itself.  Each domain owner has exclusive control over their domain and its associated members.<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-2.3">
            <p id="section-1.2-2.3.1"><strong>User-friendly identifiers:</strong> Identities are based on familiar, human-readable domain names and user names rather than cryptographically-derived values.<a href="#section-1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-2.4">
            <p id="section-1.2-2.4.1"><strong>Build upon well-established standards:</strong> DNSSEC for securing DNS responses, X.509 for certificate management, and CMS for digital signatures.<a href="#section-1.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-2.5">
            <p id="section-1.2-2.5.1"><strong>Minimal trust assumptions:</strong> The protocol reduces trust dependencies by leveraging DNSSEC, limiting potential credential issuance attacks to DNS hierarchy operators (primarily IANA and TLD operators).<a href="#section-1.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-2.6">
            <p id="section-1.2-2.6.1"><strong>Contextual binding:</strong> Signatures are bound to specific "services", preventing their unauthorised use across different contexts.<a href="#section-1.2-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-1.3">
        <h3 id="name-conventions-and-terminology">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
        </h3>
<p id="section-1.3-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">The following terms are used:<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-3.1">
            <p id="section-1.3-3.1.1"><strong>Organisation:</strong> A domain name that participates in the DomainAuth protocol by configuring DNSSEC and publishing the necessary DomainAuth TXT record(s).<a href="#section-1.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-3.2">
            <p id="section-1.3-3.2.1"><strong>Member:</strong> An entity that produces signatures on behalf of an organisation. Members are either:<a href="#section-1.3-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-3.2.2.1">
                <p id="section-1.3-3.2.2.1.1"><strong>Users:</strong> Identified by a unique user name within an organisation.<a href="#section-1.3-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.3-3.2.2.2">
                <p id="section-1.3-3.2.2.2.1"><strong>Bots:</strong> Acting on behalf of the organisation as a whole.<a href="#section-1.3-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.3-3.3">
            <p id="section-1.3-3.3.1"><strong>DomainAuth TXT Record:</strong> A DNS TXT record at <code>_domainauth.&lt;domain&gt;</code> that contains the organisation's public key information.<a href="#section-1.3-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-3.4">
            <p id="section-1.3-3.4.1"><strong>Organisation Certificate:</strong> An X.509 certificate owned by an organisation that serves as the root of trust for all signatures produced on behalf of that organisation.<a href="#section-1.3-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-3.5">
            <p id="section-1.3-3.5.1"><strong>Member Certificate:</strong> An X.509 certificate issued by the organisation certificate to a member.<a href="#section-1.3-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-3.6">
            <p id="section-1.3-3.6.1"><strong>Member Id Bundle:</strong> A data structure containing a member certificate, its issuing organisation certificate, and the DNSSEC chain proving the authenticity of the organisation's DomainAuth TXT record.<a href="#section-1.3-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-3.7">
            <p id="section-1.3-3.7.1"><strong>Signature Bundle:</strong> A data structure containing a digital signature and chain of trust that enables offline verification.  There are two types of signature bundles:<a href="#section-1.3-3.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-3.7.2.1">
                <p id="section-1.3-3.7.2.1.1"><strong>Member Signature Bundle:</strong> A signature bundle containing a signature produced by a member using their private key.<a href="#section-1.3-3.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.3-3.7.2.2">
                <p id="section-1.3-3.7.2.2.1"><strong>Organisation Signature Bundle:</strong> A signature bundle containing a signature produced directly by an organisation using its private key, with a required member attribution that assigns authorship of the content to a specific member.<a href="#section-1.3-3.7.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.3-3.8">
            <p id="section-1.3-3.8.1"><strong>DNSSEC Chain:</strong> A sequence of DNS responses that allows a verifier to cryptographically validate the authenticity of a DNS record.<a href="#section-1.3-3.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-3.9">
            <p id="section-1.3-3.9.1"><strong>Service:</strong> A protocol or system that employs DomainAuth signatures for a specific use case.  Each service defines the context in which a signature is valid, and its own rules for signature creation and verification.<a href="#section-1.3-3.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="protocol-overview">
<section id="section-2">
      <h2 id="name-protocol-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<div id="architecture">
<section id="section-2.1">
        <h3 id="name-architecture">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-architecture" class="section-name selfRef">Architecture</a>
        </h3>
<p id="section-2.1-1">DomainAuth is built on three foundational layers:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.1-2">
<li id="section-2.1-2.1">
            <p id="section-2.1-2.1.1"><strong>DNS and DNSSEC Layer:</strong><a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1.2.1">
                <p id="section-2.1-2.1.2.1.1">Provides the domain name hierarchy and DNSSEC-based verification of domain ownership.<a href="#section-2.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.1.2.2">
                <p id="section-2.1-2.1.2.2.1">The DNSSEC chain connects the DNS root of trust to the organisation's domain, enabling offline validation without prior key distribution.<a href="#section-2.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.1.2.3">
                <p id="section-2.1-2.1.2.3.1">The DomainAuth TXT record bridges DNSSEC and PKI by publishing the organisation's public key information in a standardised, discoverable way.<a href="#section-2.1-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-2.1-2.2">
            <p id="section-2.1-2.2.1"><strong>PKI Layer:</strong><a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.2.2.1">
                <p id="section-2.1-2.2.2.1.1">Establishes a per-organisation PKI where each organisation issues certificates to its members.<a href="#section-2.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.2.2.2">
                <p id="section-2.1-2.2.2.2.1">The Organisation certificate functions as the domain-specific trust anchor that binds the organisation's public key to its domain name.<a href="#section-2.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.2.2.3">
                <p id="section-2.1-2.2.2.3.1">Member certificates extend the organisation's trust to specific members, containing identity information that enables them to produce signatures.<a href="#section-2.1-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-2.1-2.3">
            <p id="section-2.1-2.3.1"><strong>Signature Layer:</strong><a href="#section-2.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.3.2.1">
                <p id="section-2.1-2.3.2.1.1">Enables members to produce digital signatures on behalf of their organisation.<a href="#section-2.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.3.2.2">
                <p id="section-2.1-2.3.2.2.1">Signature bundles package digital signatures with all verification material, enabling offline validation.<a href="#section-2.1-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-2.1-3">These layers interact differently depending on the signature type:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-4.1">
            <p id="section-2.1-4.1.1">In <strong>member signatures</strong>, the chain of trust flows from the DNSSEC chain to the organisation certificate, then to the member certificate, and finally to the signature, providing end-to-end cryptographic proof of authorship.<a href="#section-2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-4.2">
            <p id="section-2.1-4.2.1">In <strong>organisation signatures</strong>, the chain of trust flows from the DNSSEC chain directly to the organisation certificate and then to the signature, with member attribution provided as a claim rather than a cryptographic proof.<a href="#section-2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-5">Furthermore, Member Id Bundles are a key architectural component that packages the complete chain of trust (DNSSEC chain, organisation certificate, and member certificate) into a single message, enabling members to produce verifiable signatures offline.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="workflow-summary">
<section id="section-2.2">
        <h3 id="name-workflow-summary">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-workflow-summary" class="section-name selfRef">Workflow Summary</a>
        </h3>
<p id="section-2.2-1">The DomainAuth protocol involves the following key workflows:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<div id="organisation-setup">
<section id="section-2.2.1">
          <h4 id="name-organisation-setup">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-organisation-setup" class="section-name selfRef">Organisation Setup</a>
          </h4>
<p id="section-2.2.1-1">First, the organisation must have DNSSEC properly configured for its domain.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2">Then, the organisation must generate an asymmetric key pair and publish its public key information in a DomainAuth TXT record at <code>_domainauth.&lt;domain&gt;</code> as described in <a href="#txt-record" class="auto internal xref">Section 3.2</a>.<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1-3">Multiple such records are allowed, which can be useful for key rotation or binding different keys to different services.<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certificate-issuance">
<section id="section-2.2.2">
          <h4 id="name-certificate-issuance">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-certificate-issuance" class="section-name selfRef">Certificate Issuance</a>
          </h4>
<p id="section-2.2.2-1">The organisation must obtain an X.509 certificate for its public key, or reuse an existing certificate valid during the intended validity period.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2-2">When issuing a member certificate, the organisation must distribute it along with the organisation certificate.  This can be done with a Member Id Bundle as specified in <a href="#member-id-bundle" class="auto internal xref">Section 5</a>, which is desirable in services meant to be used offline as it also contains the DNSSEC chain.<a href="#section-2.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-bundle-production">
<section id="section-2.2.3">
          <h4 id="name-signature-bundle-production">
<a href="#section-2.2.3" class="section-number selfRef">2.2.3. </a><a href="#name-signature-bundle-production" class="section-name selfRef">Signature Bundle Production</a>
          </h4>
<p id="section-2.2.3-1">A member would produce a signature bundle as follows:<a href="#section-2.2.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2.3-2">
<li id="section-2.2.3-2.1">
              <p id="section-2.2.3-2.1.1">Use their private key to produce a CMS SignedData structure, encapsulating the member's certificate.<a href="#section-2.2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.3-2.2">
              <p id="section-2.2.3-2.2.1">Obtain the DNSSEC chain from the DomainAuth TXT record. This chain could be provided by the organisation (e.g. in the form of a Member Id Bundle), retrieved from a cache, or resolved from DNS if online.<a href="#section-2.2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.3-2.3">
              <p id="section-2.2.3-2.3.1">Construct a signature bundle with the CMS SignedData structure, the organisation certificate, and the DNSSEC chain.<a href="#section-2.2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-2.2.3-3">Similarly, an organisation would produce a signature bundle as follows:<a href="#section-2.2.3-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2.3-4">
<li id="section-2.2.3-4.1">
              <p id="section-2.2.3-4.1.1">Use its private key to produce a CMS SignedData structure, without encapsulating the organisation's certificate.<a href="#section-2.2.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.3-4.2">
              <p id="section-2.2.3-4.2.1">Obtain the DNSSEC chain from the DomainAuth TXT record, either from a cache or by resolving it from DNS if online.<a href="#section-2.2.3-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.3-4.3">
              <p id="section-2.2.3-4.3.1">Construct a signature bundle with the CMS SignedData structure, the organisation certificate, and the DNSSEC chain.<a href="#section-2.2.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-2.2.3-5">In both cases, the signer can choose to encapsulate the plaintext in the CMS SignedData structure or distribute it separately.<a href="#section-2.2.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-bundle-verification">
<section id="section-2.2.4">
          <h4 id="name-signature-bundle-verificati">
<a href="#section-2.2.4" class="section-number selfRef">2.2.4. </a><a href="#name-signature-bundle-verificati" class="section-name selfRef">Signature Bundle Verification</a>
          </h4>
<p id="section-2.2.4-1">The verification process involves validating the entire chain of trust as follows:<a href="#section-2.2.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2.4-2">
<li id="section-2.2.4-2.1">
              <p id="section-2.2.4-2.1.1">Verify the DNSSEC chain.<a href="#section-2.2.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.4-2.2">
              <p id="section-2.2.4-2.2.1">Verify the organisation certificate using the public key from the TXT record.<a href="#section-2.2.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.4-2.3">
              <p id="section-2.2.4-2.3.1">Determine the certificate of the signer of the CMS SignedData structure.  If it is an organisation signature, use the organisation certificate.  Otherwise, use the certificate of the member, which is encapsulated in the CMS SignedData structure.<a href="#section-2.2.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.4-2.4">
              <p id="section-2.2.4-2.4.1">Verify the CMS SignedData structure against the certificate of the signer.<a href="#section-2.2.4-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.4-2.5">
              <p id="section-2.2.4-2.5.1">Verify that the signature is valid for the intended service and time period.<a href="#section-2.2.4-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-2.2.4-3">Alternatively, the verifier can start with the digital signature, then verify the organisation certificate and finally the DNSSEC chain.<a href="#section-2.2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.2.4-4">For more detailed information on the verification process, particularly regarding validity periods, see <a href="#verification-procedure" class="auto internal xref">Section 7.1</a>.<a href="#section-2.2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="trust-model">
<section id="section-2.3">
        <h3 id="name-trust-model">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-trust-model" class="section-name selfRef">Trust Model</a>
        </h3>
<p id="section-2.3-1">DomainAuth's trust model is anchored in DNSSEC and offers key distinctions from traditional PKIs:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1">
            <p id="section-2.3-2.1.1"><strong>Domain-specific trust roots:</strong> Each organisation can only issue certificates for itself and its members, enforcing a strict hierarchy where domain control is the only path to certificate issuance.<a href="#section-2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.2">
            <p id="section-2.3-2.2.1"><strong>Self-contained verification:</strong> The inclusion of complete DNSSEC chains and certificates in signature bundles enables fully offline verification without prior key distribution.<a href="#section-2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.3">
            <p id="section-2.3-2.3.1"><strong>Credential lifecycle:</strong> DomainAuth favours short-lived credentials over revocation mechanisms, reducing complexity for disconnected operation.<a href="#section-2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.4">
            <p id="section-2.3-2.4.1"><strong>Trust inheritance:</strong> By relying on DNSSEC, DomainAuth inherits both its security properties and limitations, with trust ultimately rooted in the DNS hierarchy, including the root zone and TLD operators.<a href="#section-2.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="dns-integration">
<section id="section-3">
      <h2 id="name-dns-integration">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-dns-integration" class="section-name selfRef">DNS Integration</a>
      </h2>
<p id="section-3-1">This document makes no distinction between different types of DNS zones, with the exception of the root zone which <span class="bcp14">MUST NOT</span> participate in DomainAuth.  The root zone exclusion avoids representation challenges in user interfaces (where it would appear as a dot or empty string) and eliminates the need for implementations to handle this special case.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">TLDs, apex domains, and subdomains are all treated equivalently.  Any domain at any level in the DNS hierarchy, except the root zone, <span class="bcp14">MAY</span> implement DomainAuth.  Each participating domain operates entirely independently from its parent zones, with no hierarchical relationship or inherited trust.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Throughout this document, the terms "domain" and "domain name" refer to any such zone without regard to its hierarchical position.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="dnssec-configuration">
<section id="section-3.1">
        <h3 id="name-dnssec-configuration">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-dnssec-configuration" class="section-name selfRef">DNSSEC Configuration</a>
        </h3>
<p id="section-3.1-1">Participating domains <span class="bcp14">MUST</span> have a complete DNSSEC chain of trust from the root zone to the DomainAuth TXT record.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Newly registered domains <span class="bcp14">SHOULD</span> wait at least the maximum validity period in <a href="#maximum-validity-period" class="auto internal xref">Section 9</a> before enabling DomainAuth to prevent potential attacks using DNSSEC chains from previous domain owners.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="txt-record">
<section id="section-3.2">
        <h3 id="name-txt-record">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-txt-record" class="section-name selfRef">TXT Record</a>
        </h3>
<p id="section-3.2-1">Each organisation participating in the DomainAuth protocol <span class="bcp14">MUST</span> publish a TXT record at <code>_domainauth.&lt;domain&gt;</code> with the following fields separated by simple spaces:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-2">
<li id="section-3.2-2.1">
            <p id="section-3.2-2.1.1"><strong>Version</strong> (required): A positive integer denoting the version of the DomainAuth TXT record format, set to <code>0</code> (zero) for this version of the specification.<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.2">
            <p id="section-3.2-2.2.1"><strong>Key Algorithm</strong> (required): A positive integer denoting the key algorithm as registered in the "DomainAuth Signature Algorithm Registry" (<a href="#domainauth-signature-algorithm-registry" class="auto internal xref">Section 15.1</a>).  See also <a href="#digital-signature-algorithms" class="auto internal xref">Section 8.1</a>.<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.3">
            <p id="section-3.2-2.3.1"><strong>Key Digest Type</strong> (required): A positive integer denoting the key digest type used to identify the key, as registered in the "DomainAuth Key Digest Type Registry" (<a href="#domainauth-key-digest-type-registry" class="auto internal xref">Section 15.2</a>).<a href="#section-3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.4">
            <p id="section-3.2-2.4.1"><strong>Key Id</strong> (required): The representation of the key identifier.  For example, per <a href="#digital-signature-algorithms" class="auto internal xref">Section 8.1</a>, for an RSA key, this is the Base64-encoded digest of the public key.<a href="#section-3.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.5">
            <p id="section-3.2-2.5.1"><strong>TTL Override</strong> (required): A positive integer representing the number of seconds for the maximum validity period of signatures.  This value <span class="bcp14">MUST</span> be at least 1 second and not exceed the limit specified in <a href="#maximum-validity-period" class="auto internal xref">Section 9</a>. Refer to <a href="#ttl-override" class="auto internal xref">Section 3.3</a> for more details.<a href="#section-3.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.6">
            <p id="section-3.2-2.6.1"><strong>Service OID</strong> (optional): An Object Identifier (in dotted decimal notation) binding the key to a specific service.  If omitted, the key is valid for any service.<a href="#section-3.2-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.2-3">For example, the following TXT record specifies an RSA-2048 key identified by its SHA-512 digest with a TTL override of 24 hours (86,400 seconds) and no service binding:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-4">
<pre>
_domainauth.example.com. IN TXT "0 1 3 dGhpcyBpcyBub3QgYSByZWFsIGtleSBkaWdlc3Q 86400"
</pre><a href="#section-3.2-4" class="pilcrow">¶</a>
</div>
<p id="section-3.2-5">Multiple TXT records <span class="bcp14">MAY</span> be published at the same zone to support different keys, key algorithms, or services.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ttl-override">
<section id="section-3.3">
        <h3 id="name-ttl-override">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-ttl-override" class="section-name selfRef">TTL Override</a>
        </h3>
<p id="section-3.3-1">The TTL override field in the DomainAuth TXT record enables verification of DNS records and DNSSEC signatures for longer periods than their respective specifications would allow, which is essential for delay-tolerant use cases where users may be offline for extended periods.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">DNS records and DNSSEC signatures typically have TTL values that may be as short as a few minutes or hours.  The TTL override mechanism allows the DNSSEC chain to remain verifiable for a significantly longer period, regardless of the TTL in such records.  Refer to <a href="#maximum-validity-period" class="auto internal xref">Section 9</a> for the maximum validity period.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">During verification, the TTL override creates a restricted time window that extends backwards from the end of the requested verification period by the specified number of seconds.  Verification will succeed if the DNSSEC signatures (RRSIGs) were valid at any point during this window, even if they would have expired according to their original validity periods.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">For example, if a DNSSEC signature has a standard validity period of 3600 seconds (1 hour) but the DomainAuth TXT record specifies a TTL override of 604,800 seconds (7 days), a signature bundle can still be verified up to 7 days after creation, even when offline.  If a verifier attempts to verify a signature bundle 5 days after it was created, the verification would succeed with the TTL override, whereas it would fail with only the 1-hour DNSSEC signature validity period.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dnssec-chain-serialisation">
<section id="section-3.4">
        <h3 id="name-dnssec-chain-serialisation">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-dnssec-chain-serialisation" class="section-name selfRef">DNSSEC Chain Serialisation</a>
        </h3>
<p id="section-3.4-1">The serialised chain <span class="bcp14">MUST</span> be encoded as the ASN.1 <code>DnssecChain</code> structure below, where each <code>OCTET STRING</code> contains a complete DNS message as detailed in <span>[<a href="#DNS" class="cite xref">DNS</a>]</span>:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-2">
<pre>
DnssecChain ::= SET OF OCTET STRING
</pre><a href="#section-3.4-2" class="pilcrow">¶</a>
</div>
<p id="section-3.4-3">This chain <span class="bcp14">MUST</span> include all DNSSEC responses necessary to validate the <code>_domainauth.&lt;domain&gt;/TXT</code> record from the trust anchor.  However, the root zone DS records <span class="bcp14">SHOULD</span> be omitted, since they will be ignored by verifiers as described in <a href="#verification-procedure" class="auto internal xref">Section 7.1</a>.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">Implementations <span class="bcp14">SHOULD</span> optimise the serialisation to minimise redundancy and size whilst ensuring completeness for offline verification.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="x509-certificate-profile">
<section id="section-4">
      <h2 id="name-x509-certificate-profile">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-x509-certificate-profile" class="section-name selfRef">X.509 Certificate Profile</a>
      </h2>
<p id="section-4-1">All X.509 certificates <span class="bcp14">MUST</span> comply with <span>[<a href="#X.509" class="cite xref">X.509</a>]</span>. Additionally, each certificate <span class="bcp14">MUST</span>:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">Have a validity period of at least 1 second and not exceeding the limit specified in <a href="#maximum-validity-period" class="auto internal xref">Section 9</a>.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">Only use the algorithms specified in <a href="#cryptographic-algorithms" class="auto internal xref">Section 8</a>.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">Additional requirements and recommendations apply to specific certificate types as described in the following sections.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div id="organisation-certificate">
<section id="section-4.1">
        <h3 id="name-organisation-certificate">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-organisation-certificate" class="section-name selfRef">Organisation Certificate</a>
        </h3>
<p id="section-4.1-1">This is a certificate whose subject key is referenced by the DomainAuth TXT record.  The following requirements and recommendations apply:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">Its Subject Distinguished Name <span class="bcp14">MUST</span> contain the Common Name attribute (OID <code>2.5.4.3</code>) set to the organisation's domain name with a trailing dot (e.g. <code>example.com.</code>).<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">When the certificate is used to issue other certificates, the Basic Constraints extension from <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.9" class="relref">Section 4.2.1.9</a> of [<a href="#X.509" class="cite xref">X.509</a>]</span> <span class="bcp14">MUST</span> be present and marked as critical.  Additionally, the CA flag <span class="bcp14">MUST</span> be enabled, and the Path Length Constraint <span class="bcp14">SHOULD</span> be set to the lowest possible value for the length of the intended certificate chains.<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">When the certificate is used directly to sign CMS SignedData structures, the Basic Constraints extension <span class="bcp14">MAY</span> be absent.  If present, it <span class="bcp14">SHOULD</span> have the CA flag disabled.<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-3">Whilst the organisation certificate is typically self-issued, it <span class="bcp14">MAY</span> be issued by another certificate authority. In such cases, the issuer of the organisation certificate and any other certificates in the certification path to the organisation certificate are not considered part of the DomainAuth protocol, and any such parent certificates <span class="bcp14">SHOULD NOT</span> be included in the Signature Bundle. Verification of the organisation certificate is performed solely using the public key referenced in the DomainAuth TXT record.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="member-certificate">
<section id="section-4.2">
        <h3 id="name-member-certificate">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-member-certificate" class="section-name selfRef">Member Certificate</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-4.2-1.1">
            <p id="section-4.2-1.1.1">Its Subject Distinguished Name <span class="bcp14">MUST</span> contain the Common Name attribute (OID <code>2.5.4.3</code>) set to the member's name in the case of users or the at sign (<code>@</code>) in the case of bots.<a href="#section-4.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-1.2">
            <p id="section-4.2-1.2.1">The Basic Constraints extension from <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.9" class="relref">Section 4.2.1.9</a> of [<a href="#X.509" class="cite xref">X.509</a>]</span> <span class="bcp14">MAY</span> be absent.  If present, it <span class="bcp14">SHOULD</span> have the CA flag disabled.<a href="#section-4.2-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="intermediate-certificate">
<section id="section-4.3">
        <h3 id="name-intermediate-certificate">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-intermediate-certificate" class="section-name selfRef">Intermediate Certificate</a>
        </h3>
<p id="section-4.3-1">Organisations <span class="bcp14">MAY</span> issue intermediate certificates to delegate the responsibility of issuing member certificates and organisation signatures to other entities.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">When an intermediate certificate is used, the Basic Constraints extension from <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.9" class="relref">Section 4.2.1.9</a> of [<a href="#X.509" class="cite xref">X.509</a>]</span> <span class="bcp14">MUST</span> be present and marked as critical.  Additionally, the CA flag <span class="bcp14">MUST</span> be enabled, and the Path Length Constraint <span class="bcp14">SHOULD</span> be set to the lowest possible value for the length of the intended certificate chains.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">Note that if an intermediate certificate is assigned a Common Name, it could also be used as a member certificate and it could therefore produce member signatures.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="member-id-bundle">
<section id="section-5">
      <h2 id="name-member-id-bundle">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-member-id-bundle" class="section-name selfRef">Member Id Bundle</a>
      </h2>
<p id="section-5-1">The Member Id Bundle is a self-contained message that provides all the information needed for a member to produce verifiable signatures.  It is serialised using ASN.1 with the following structure:<a href="#section-5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-2">
<pre>
MemberIdBundle ::= SEQUENCE {
    version                  [0] INTEGER,
    dnssecChain              [1] DnssecChain,
    organisationCertificate  [2] Certificate,
    memberCertificate        [3] Certificate,
    intermediateCertificates [4] SET OF Certificate OPTIONAL
}
</pre><a href="#section-5-2" class="pilcrow">¶</a>
</div>
<p id="section-5-3">Where:<a href="#section-5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1">
          <p id="section-5-4.1.1"><code>version</code> is the format version, set to <code>0</code> (zero) in this version of the specification.<a href="#section-5-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-4.2">
          <p id="section-5-4.2.1"><code>dnssecChain</code> contains the serialised DNSSEC chain proving the authenticity of the organisation's DomainAuth TXT record.<a href="#section-5-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-4.3">
          <p id="section-5-4.3.1"><code>organisationCertificate</code> is the organisation's X.509 certificate.<a href="#section-5-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-4.4">
          <p id="section-5-4.4.1"><code>memberCertificate</code> is the X.509 certificate issued to the member by the organisation.<a href="#section-5-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-4.5">
          <p id="section-5-4.5.1"><code>intermediateCertificates</code> is a set of X.509 certificates issued by the organisation to other entities that can sign member certificates.  It <span class="bcp14">SHOULD NOT</span> include certificates extraneous to the chain between the organisation certificate and the member certificate.<a href="#section-5-4.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-5">The Member Id Bundle links the member to their organisation and provides all the cryptographic material needed to verify this relationship.  It serves as a precursor to signature production and is typically distributed to members by their organisation's certificate management system.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">Member Id Bundles are not inherently confidential, as they contain only public information, but their integrity is critical for secure signature production.<a href="#section-5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cms-signeddata-structure">
<section id="section-6">
      <h2 id="name-cms-signeddata-structure">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-cms-signeddata-structure" class="section-name selfRef">CMS SignedData Structure</a>
      </h2>
<p id="section-6-1">DomainAuth signatures use CMS SignedData structures as specified in <span><a href="https://rfc-editor.org/rfc/rfc5652#section-5" class="relref">Section 5</a> of [<a href="#CMS" class="cite xref">CMS</a>]</span>, with additional requirements and recommendations:<a href="#section-6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1">
          <p id="section-6-2.1.1"><code>signerInfos</code> field:<a href="#section-6-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1.2.1">
              <p id="section-6-2.1.2.1.1">There <span class="bcp14">MUST</span> be exactly one <code>SignerInfo</code>.<a href="#section-6-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6-2.1.2.2">
              <p id="section-6-2.1.2.2.1">The digest and signature algorithms <span class="bcp14">MUST</span> comply with <a href="#cryptographic-algorithms" class="auto internal xref">Section 8</a>.<a href="#section-6-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6-2.1.2.3">
              <p id="section-6-2.1.2.3.1">The following signed attributes <span class="bcp14">MUST</span> be included:<a href="#section-6-2.1.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1.2.3.2.1">
                  <p id="section-6-2.1.2.3.2.1.1">Content Type attribute described in <span><a href="https://rfc-editor.org/rfc/rfc5652#section-11.1" class="relref">Section 11.1</a> of [<a href="#CMS" class="cite xref">CMS</a>]</span>.<a href="#section-6-2.1.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6-2.1.2.3.2.2">
                  <p id="section-6-2.1.2.3.2.2.1">Message Digest attribute described in <span><a href="https://rfc-editor.org/rfc/rfc5652#section-11.2" class="relref">Section 11.2</a> of [<a href="#CMS" class="cite xref">CMS</a>]</span>.<a href="#section-6-2.1.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6-2.1.2.3.2.3">
                  <p id="section-6-2.1.2.3.2.3.1">DomainAuth signature metadata attribute as outlined in <a href="#signature-metadata" class="auto internal xref">Section 6.2</a>.<a href="#section-6-2.1.2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-6-2.1.2.4">
              <p id="section-6-2.1.2.4.1">The <code>SignerInfo.sid</code> field <span class="bcp14">MUST</span> use the <code>issuerAndSerialNumber</code> choice specified in <span><a href="https://rfc-editor.org/rfc/rfc5652#section-5.3" class="relref">Section 5.3</a> of [<a href="#CMS" class="cite xref">CMS</a>]</span>.<a href="#section-6-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-6-2.2">
          <p id="section-6-2.2.1"><code>certificates</code> field:<a href="#section-6-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.2.2.1">
              <p id="section-6-2.2.2.1.1">Any intermediate certificates between the organisation and the signer <span class="bcp14">MUST</span> be included.<a href="#section-6-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6-2.2.2.2">
              <p id="section-6-2.2.2.2.1">The organisation certificate <span class="bcp14">SHOULD NOT</span> be included, since it is already included in the Signature Bundle.<a href="#section-6-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6-2.2.2.3">
              <p id="section-6-2.2.2.3.1">Certificates outside the certification path between the organisation and the signer <span class="bcp14">SHOULD NOT</span> be included.<a href="#section-6-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
<div id="signature-types">
<section id="section-6.1">
        <h3 id="name-signature-types">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-signature-types" class="section-name selfRef">Signature Types</a>
        </h3>
<p id="section-6.1-1">DomainAuth supports two distinct types of signatures, offering different levels of assurance and operational flexibility:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div id="member-signatures">
<section id="section-6.1.1">
          <h4 id="name-member-signatures">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-member-signatures" class="section-name selfRef">Member Signatures</a>
          </h4>
<p id="section-6.1.1-1">Member signatures are produced by members (users or bots) using their own private key.  They are suitable for scenarios requiring strong non-repudiation at the individual member level, or when members need to produce signatures whilst being offline for extended periods.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">The member's certificate <span class="bcp14">MUST</span> be included in the <code>SignedData.certificates</code> field.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="organisation-signatures">
<section id="section-6.1.2">
          <h4 id="name-organisation-signatures">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-organisation-signatures" class="section-name selfRef">Organisation Signatures</a>
          </h4>
<p id="section-6.1.2-1">Organisation signatures are produced using the organisation's private key or a delegated signing key. These signatures involve attributing the signature to a member and are suitable when member certificate management is impractical.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">The SignerInfo structure <span class="bcp14">MUST</span> include the DomainAuth member attribution in its signed attributes, using the OID <code>1.3.6.1.4.1.58708.1.2</code> and the value defined in the ASN.1 structure below:<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.2-3">
<pre>
MemberAttribution ::= UTF8String
</pre><a href="#section-6.1.2-3" class="pilcrow">¶</a>
</div>
<p id="section-6.1.2-4">The member attribution value <span class="bcp14">MUST</span> conform to the restrictions defined in <a href="#phishing-attacks" class="auto internal xref">Section 13.2</a>. For users, this is the user name; for bots, this is the at sign (<code>@</code>).<a href="#section-6.1.2-4" class="pilcrow">¶</a></p>
<p id="section-6.1.2-5">Member attribution is a claim made by the organisation, not cryptographically proven by the member.  Verifiers <span class="bcp14">SHOULD</span> present this distinction clearly to end users.<a href="#section-6.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="signature-metadata">
<section id="section-6.2">
        <h3 id="name-signature-metadata">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-signature-metadata" class="section-name selfRef">Signature Metadata</a>
        </h3>
<p id="section-6.2-1">Each SignedData structure includes metadata that binds the signature to a specific service and validity period.  This metadata is included as a signed attribute in the SignerInfo structure.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The signature metadata attribute <span class="bcp14">MUST</span> use the OID <code>1.3.6.1.4.1.58708.1.0</code> and be encoded as the <code>SignatureMetadata</code> ASN.1 structure below:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-3">
<pre>
SignatureMetadata ::= SEQUENCE {
    serviceOid      [0] OBJECT IDENTIFIER,
    validityPeriod  [1] DatePeriod
}

DatePeriod ::= SEQUENCE {
    start  [0] GeneralizedTime,
    end    [1] GeneralizedTime
}
</pre><a href="#section-6.2-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2-4">Where:<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-5.1">
            <p id="section-6.2-5.1.1"><code>serviceOid</code> is the Object Identifier of the service for which the signature is valid.<a href="#section-6.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-5.2">
            <p id="section-6.2-5.2.1"><code>validityPeriod</code> specifies the time period during which the signature is considered valid.  The <code>start</code> and <code>end</code> fields <span class="bcp14">MUST</span> be expressed in Greenwich Mean Time (GMT) and <span class="bcp14">MUST</span> include seconds.  Therefore, both times will follow the format <code>YYYYMMDDHHMMSSZ</code>. Both the start and end times are inclusive, meaning the signature is valid at exactly the start time and remains valid until exactly the end time.<a href="#section-6.2-5.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="signature-bundle">
<section id="section-7">
      <h2 id="name-signature-bundle">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-signature-bundle" class="section-name selfRef">Signature Bundle</a>
      </h2>
<p id="section-7-1">The Signature Bundle is the primary artefact of the DomainAuth protocol, containing a digital signature and all the information needed to verify it offline.  It is serialised using ASN.1 with the following structure:<a href="#section-7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7-2">
<pre>
SignatureBundle ::= SEQUENCE {
    version                  [0] INTEGER,
    dnssecChain              [1] DnssecChain,
    organisationCertificate  [2] Certificate,
    signature                [3] ContentInfo
}
</pre><a href="#section-7-2" class="pilcrow">¶</a>
</div>
<p id="section-7-3">Where:<a href="#section-7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.1">
          <p id="section-7-4.1.1"><code>version</code> is the format version, set to <code>0</code> (zero) in this version of the specification.<a href="#section-7-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.2">
          <p id="section-7-4.2.1"><code>dnssecChain</code> contains the serialised DNSSEC chain proving the authenticity of the organisation's DomainAuth TXT record.<a href="#section-7-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.3">
          <p id="section-7-4.3.1"><code>organisationCertificate</code> is the organisation's X.509 certificate.<a href="#section-7-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.4">
          <p id="section-7-4.4.1"><code>signature</code> is a CMS <code>ContentInfo</code> containing the SignedData structure.<a href="#section-7-4.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-5">The specific contents of the <code>signature</code> field depend on whether it is a member signature or an organisation signature, as detailed in <a href="#cms-signeddata-structure" class="auto internal xref">Section 6</a>.<a href="#section-7-5" class="pilcrow">¶</a></p>
<div id="verification-procedure">
<section id="section-7.1">
        <h3 id="name-verification-procedure">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-verification-procedure" class="section-name selfRef">Verification Procedure</a>
        </h3>
<p id="section-7.1-1">Implementations <span class="bcp14">MUST</span> verify the syntactic validity of the signature bundle against its ASN.1 schema and reject malformed values.  Refer to <a href="#data-serialisation" class="auto internal xref">Section 10</a> for more information on serialisation formats.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">A fundamental aspect of the verification procedure is to establish that all components—the DNSSEC chain, X.509 certificate path and the signature itself—were simultaneously valid for at least one second within the specified verification period.  This temporal intersection of validity periods ensures the cryptographic continuity of the trust chain at the time of verification.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">Implementations <span class="bcp14">MUST</span> verify every syntactically-valid signature bundle as follows, and fail if any step fails:<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.1-4">
<li id="section-7.1-4.1">
            <p id="section-7.1-4.1.1"><strong>Establish the verification parameters.</strong> The verifier <span class="bcp14">MUST</span> specify the following parameters:<a href="#section-7.1-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-4.1.2.1">
                <p id="section-7.1-4.1.2.1.1">Plaintext: The content to be verified if it is detached from the SignedData structure (i.e. the field <code>SignedData.encapContentInfo.eContent</code> is absent). This value <span class="bcp14">MUST NOT</span> be provided if the plaintext is encapsulated.<a href="#section-7.1-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-4.1.2.2">
                <p id="section-7.1-4.1.2.2.1">Service: The OID of the service for which the signature must be valid.<a href="#section-7.1-4.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-4.1.2.3">
                <p id="section-7.1-4.1.2.3.1">Validity period: The inclusive time range during which the signature bundle must be valid for at least one second (e.g. 1st January 1970 00:00:00 UTC to 31st January 1970 23:59:59 UTC). This period <span class="bcp14">MAY</span> be specified as a specific time (e.g. 1st January 1970 00:00:00 UTC), in which case it <span class="bcp14">MUST</span> be converted to a 1-second period where the start and end are the same as the specified time.<a href="#section-7.1-4.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.1-4.1.3">
The verifier <span class="bcp14">MAY</span> override the root zone DS record(s) only for testing purposes or to reflect updated IANA trust anchors before the underlying DNSSEC implementation updates its copy.<a href="#section-7.1-4.1.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-4.2">
            <p id="section-7.1-4.2.1"><strong>Identify the relevant DomainAuth TXT record and determine the verification time window for the DNSSEC chain:</strong><a href="#section-7.1-4.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.1-4.2.2">
<li id="section-7.1-4.2.2.1">
                <p id="section-7.1-4.2.2.1.1">Extract the domain name from the Common Name attribute in the organisation certificate's Distinguished Name.<a href="#section-7.1-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-7.1-4.2.2.2">
                <p id="section-7.1-4.2.2.2.1">Extract all records in the RRSet for <code>_domainauth.&lt;domain&gt;/TXT</code>.<a href="#section-7.1-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-7.1-4.2.2.3">
                <p id="section-7.1-4.2.2.3.1">Parse each TXT record rdata, per the rules in <a href="#txt-record" class="auto internal xref">Section 3.2</a>.<a href="#section-7.1-4.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-7.1-4.2.2.4">
                <p id="section-7.1-4.2.2.4.1">Locate records matching the subject key specification from the organisation certificate (key algorithm and key id) and the service OID specified by the verifier (either matching exactly or with an absent service OID). If multiple matching records exist, use the one with the specific service OID; if none exists, use the wildcard record.  If multiple records of the same type (specific or wildcard) match, verification <span class="bcp14">MUST</span> fail.<a href="#section-7.1-4.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-7.1-4.2.2.5">
                <p id="section-7.1-4.2.2.5.1">Extract the TTL override value from the identified TXT record.<a href="#section-7.1-4.2.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-7.1-4.2.2.6">
                <p id="section-7.1-4.2.2.6.1">Calculate a verification time window for the DNSSEC chain as follows:<a href="#section-7.1-4.2.2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-4.2.2.6.2.1">
                    <p id="section-7.1-4.2.2.6.2.1.1">End time: The end of the required verification period (as specified by the verifier).<a href="#section-7.1-4.2.2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-7.1-4.2.2.6.2.2">
                    <p id="section-7.1-4.2.2.6.2.2.1">Start time: The maximum (later) of:<a href="#section-7.1-4.2.2.6.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-4.2.2.6.2.2.2.1">
                        <p id="section-7.1-4.2.2.6.2.2.2.1.1">The start of the required verification period (as specified by the verifier).<a href="#section-7.1-4.2.2.6.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-7.1-4.2.2.6.2.2.2.2">
                        <p id="section-7.1-4.2.2.6.2.2.2.2.1">The end time minus the TTL override value in seconds.<a href="#section-7.1-4.2.2.6.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ol>
</li>
          <li id="section-7.1-4.3">
            <p id="section-7.1-4.3.1"><strong>Verify the DNSSEC chain</strong> from the root zone to the <code>_domainauth.&lt;domain&gt;/TXT</code> RRSet as described in <span>[<a href="#DNSSEC" class="cite xref">DNSSEC</a>]</span>. The chain is considered valid if all DNSSEC signatures in the chain were simultaneously valid (i.e., not expired and not in the future) for at least one second within the verification time window calculated in the previous step.<a href="#section-7.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-4.4">
            <p id="section-7.1-4.4.1"><strong>Verify the X.509 certificate chain</strong> from the organisation certificate to the signer's certificate as specified in <span>[<a href="#X.509" class="cite xref">X.509</a>]</span>, using any additional certificates in the <code>SignedData.certificates</code> field as potential intermediate certificates when constructing the chain.  Note that the chain will comprise a single certificate when the organisation itself is the signer.<a href="#section-7.1-4.4.1" class="pilcrow">¶</a></p>
<p id="section-7.1-4.4.2">
The certificate chain <span class="bcp14">MUST</span> overlap with the verification time window and the DNSSEC chain for at least one second, meaning there must be at least one second during which all certificates in the chain were simultaneously valid and this second falls within both the verification time window and the period when the DNSSEC chain was valid.<a href="#section-7.1-4.4.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-4.5">
            <p id="section-7.1-4.5.1"><strong>Verify the CMS SignedData structure</strong> as described in <span><a href="https://rfc-editor.org/rfc/rfc5652#section-5.6" class="relref">Section 5.6</a> of [<a href="#CMS" class="cite xref">CMS</a>]</span>, using the signer's certificate from the <code>SignedData.certificates</code> field or the organisation certificate if the signer is the organisation itself.<a href="#section-7.1-4.5.1" class="pilcrow">¶</a></p>
<p id="section-7.1-4.5.2">
The signature metadata attribute <span class="bcp14">MUST</span> be present in the signed attributes of the SignerInfo structure.  Additionally:<a href="#section-7.1-4.5.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-4.5.3.1">
                <p id="section-7.1-4.5.3.1.1">The service OID <span class="bcp14">MUST</span> match that specified by the verifier.<a href="#section-7.1-4.5.3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-4.5.3.2">
                <p id="section-7.1-4.5.3.2.1">The validity period <span class="bcp14">MUST</span> overlap with the verification time window, the X.509 certificate chain and the DNSSEC chain for at least one second, meaning there must be a minimum one-second period during which the signature was valid, all certificates were valid, and the DNSSEC chain was valid.<a href="#section-7.1-4.5.3.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.1-4.5.4">
If present, the member attribution attribute <span class="bcp14">MUST</span> be in the signed attributes of the SignerInfo structure, and its value <span class="bcp14">MUST</span> be a valid member name as specified in <a href="#phishing-attacks" class="auto internal xref">Section 13.2</a>. If absent, the signer <span class="bcp14">MUST</span> be a member whose certificate meets the requirements specified in <a href="#member-certificate" class="auto internal xref">Section 4.2</a>.<a href="#section-7.1-4.5.4" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-4.6">
            <p id="section-7.1-4.6.1"><strong>Produce verification output:</strong><a href="#section-7.1-4.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-4.6.2.1">
                <p id="section-7.1-4.6.2.1.1">The organisation name without a trailing dot (e.g. <code>example.com</code>). This string <span class="bcp14">MUST</span> be represented using Unicode, converting from Punycode if necessary.<a href="#section-7.1-4.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-4.6.2.2">
                <p id="section-7.1-4.6.2.2.1">If the signer is a user, their name <span class="bcp14">MUST</span> be a Unicode string.  The name <span class="bcp14">MUST</span> be taken from the signer certificate in the case of member signatures, or from the member attribution in the case of organisation signatures.  If the signer is a bot, no name <span class="bcp14">MUST</span> be produced (not even an empty string).<a href="#section-7.1-4.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-4.6.2.3">
                <p id="section-7.1-4.6.2.3.1">Whether the signature was produced by the member or the organisation.<a href="#section-7.1-4.6.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-7.1-5">Alternatively, the verification <span class="bcp14">MAY</span> start with the SignedData structure and end with the DNSSEC chain as described below, as long as the validity periods across all components still overlap for at least one second:<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.1-6">
<li id="section-7.1-6.1">
            <p id="section-7.1-6.1.1">Establish the verification parameters.<a href="#section-7.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-6.2">
            <p id="section-7.1-6.2.1">Verify the CMS SignedData structure.<a href="#section-7.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-6.3">
            <p id="section-7.1-6.3.1">Verify the X.509 certificate chain.<a href="#section-7.1-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-6.4">
            <p id="section-7.1-6.4.1">Identify the relevant DomainAuth TXT record and determine the verification time window for the DNSSEC chain.<a href="#section-7.1-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-6.5">
            <p id="section-7.1-6.5.1">Verify the DNSSEC chain.<a href="#section-7.1-6.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-6.6">
            <p id="section-7.1-6.6.1">Produce verification output.<a href="#section-7.1-6.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-7.1-7">The verification process <span class="bcp14">MUST</span> be performed in full, without skipping any steps.<a href="#section-7.1-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cryptographic-algorithms">
<section id="section-8">
      <h2 id="name-cryptographic-algorithms">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-cryptographic-algorithms" class="section-name selfRef">Cryptographic Algorithms</a>
      </h2>
<p id="section-8-1">This section describes the cryptographic algorithms used in the X.509 certificates and CMS SignedData structures, but not to the DNSSEC chain.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Algorithms not explicitly allowed by this specification <span class="bcp14">MUST</span> be rejected.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Services <span class="bcp14">MAY</span> recommend specific algorithms within the set of algorithms allowed by this specification.<a href="#section-8-3" class="pilcrow">¶</a></p>
<div id="digital-signature-algorithms">
<section id="section-8.1">
        <h3 id="name-digital-signature-algorithm">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-digital-signature-algorithm" class="section-name selfRef">Digital Signature Algorithms</a>
        </h3>
<p id="section-8.1-1">For ease of adoption and interoperability reasons, this specification only requires support for RSA Signature Scheme with Appendix - Probabilistic Signature Scheme (RSA-PSS), as detailed in <span><a href="https://rfc-editor.org/rfc/rfc8017#section-8.1" class="relref">Section 8.1</a> of [<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>.  The DomainAuth Signature Algorithm Registry, as specified in <a href="#domainauth-signature-algorithm-registry" class="auto internal xref">Section 15.1</a>, <span class="bcp14">MAY</span> introduce support for additional signature algorithms and restrict the use of RSA-PSS (including its deprecation).<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Implementations <span class="bcp14">MUST</span> support RSA-PSS in X.509 certificates as specified in <span>[<a href="#RFC4055" class="cite xref">RFC4055</a>]</span> and CMS SignedData structures according to <span>[<a href="#RFC4056" class="cite xref">RFC4056</a>]</span>.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">RSA keys with moduli less than 2048 bits <span class="bcp14">MUST</span> be rejected.  RSA keys with modulus size of 2048 <span class="bcp14">MUST</span> be supported, and greater sizes <span class="bcp14">SHOULD</span> be supported.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">Due to the size of RSA public keys, they <span class="bcp14">MUST</span> be identified in TXT records using a digest. The process for creating this identifier involves:<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.1-5">
<li id="section-8.1-5.1">
            <p id="section-8.1-5.1.1">Taking the public key in its ASN.1 DER-serialised form as a Subject Public Key Info (defined in <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.1.2.7" class="relref">Section 4.1.2.7</a> of [<a href="#X.509" class="cite xref">X.509</a>]</span>).<a href="#section-8.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.1-5.2">
            <p id="section-8.1-5.2.1">Computing a digest of this serialised key using a hash function from the DomainAuth Key Digest Type Registry (<a href="#domainauth-key-digest-type-registry" class="auto internal xref">Section 15.2</a>).<a href="#section-8.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.1-5.3">
            <p id="section-8.1-5.3.1">Encoding the resulting digest using Base64 without padding (<span>[<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>).<a href="#section-8.1-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-8.1-6">This encoded digest is then used as the Key Id in the TXT record.<a href="#section-8.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hash-functions">
<section id="section-8.2">
        <h3 id="name-hash-functions">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-hash-functions" class="section-name selfRef">Hash Functions</a>
        </h3>
<p id="section-8.2-1">This section pertains specifically to the hash functions used within digital signatures themselves (e.g., X.509 certificates, CMS SignedData structures), distinct from their use in key identification.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">For ease of adoption and interoperability reasons, implementations <span class="bcp14">MUST</span> support SHA-256, SHA-384, and SHA-512 as established in <span>[<a href="#NIST.FIPS.180-4" class="cite xref">NIST.FIPS.180-4</a>]</span>.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">The DomainAuth Key Digest Type Registry, as described in <a href="#domainauth-key-digest-type-registry" class="auto internal xref">Section 15.2</a>, separately governs the use of hash functions for key identification.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="maximum-validity-period">
<section id="section-9">
      <h2 id="name-maximum-validity-period">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-maximum-validity-period" class="section-name selfRef">Maximum Validity Period</a>
      </h2>
<p id="section-9-1">Digital signatures <span class="bcp14">MUST NOT</span> have a validity period greater than 7,776,000 seconds (90 days). This limit applies to DNSSEC RRSIG records, X.509 certificates, and CMS SignedData structures (including the signature metadata).<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Similarly, verifiers <span class="bcp14">MUST NOT</span> allow a validity period greater than this limit when verifying signatures over a time period.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">Services <span class="bcp14">SHOULD</span> specify a maximum validity period shorter than the protocol-level limit where feasible.  This approach improves security by limiting the window of vulnerability in case of key compromise or other security incidents.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">Applications built on DomainAuth services <span class="bcp14">MAY</span> impose even shorter validity periods based on their specific security requirements and threat models.<a href="#section-9-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="data-serialisation">
<section id="section-10">
      <h2 id="name-data-serialisation">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-data-serialisation" class="section-name selfRef">Data Serialisation</a>
      </h2>
<p id="section-10-1">All data structures in the DomainAuth protocol are defined using Abstract Syntax Notation One (ASN.1), as referenced in <span>[<a href="#ASN.1" class="cite xref">ASN.1</a>]</span>.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Implementations <span class="bcp14">MUST</span> support Distinguished Encoding Rules (DER) as presented in <span>[<a href="#ASN.1" class="cite xref">ASN.1</a>]</span>.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">Services <span class="bcp14">MAY</span> require or recommend additional ASN.1 encoding rules.<a href="#section-10-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="test-service">
<section id="section-11">
      <h2 id="name-test-service">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-test-service" class="section-name selfRef">Test Service</a>
      </h2>
<p id="section-11-1">Service-agnostic implementations <span class="bcp14">SHOULD</span> use the test service OID <code>1.3.6.1.4.1.58708.1.1</code> for testing purposes.  Service implementations <span class="bcp14">MUST NOT</span> use this service.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">This service is not subject to additional requirements or recommendations.<a href="#section-11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-status">
<section id="section-12">
      <h2 id="name-implementation-status">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-12-1">This section records the status of known implementations of the protocol defined by this specification at the time of posting of this Internet-Draft, and is based on a proposal described in <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>. The description of implementations in this section is intended to assist the IETF in its decision processes in progressing drafts to RFCs.  Please note that the listing of any individual implementation here does not imply endorsement by the IETF.  Furthermore, no effort has been spent to verify the information presented here that was supplied by IETF contributors.  This is not intended as, and must not be construed to be, a catalog of available implementations or their features.  Readers are advised to note that other implementations may exist.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">According to <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>, "this will allow reviewers and working groups to assign due consideration to documents that have the benefit of running code, which may serve as evidence of valuable experimentation and feedback that have made the implemented protocols more mature.  It is up to the individual working groups to use this information as they see fit".<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3"><em>Note to RFC Editor: Please remove this section before publication.</em><a href="#section-12-3" class="pilcrow">¶</a></p>
<div id="veraid">
<section id="section-12.1">
        <h3 id="name-veraid">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-veraid" class="section-name selfRef">VeraId</a>
        </h3>
<p id="section-12.1-1">DomainAuth is the successor to the VeraId protocol described in <span>[<a href="#VERAID" class="cite xref">VERAID</a>]</span>. DomainAuth and VeraId are functionally identical, except for the following differences:<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-2.1">
            <p id="section-12.1-2.1.1">DNS TXT record:<a href="#section-12.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-2.1.2.1">
                <p id="section-12.1-2.1.2.1.1">Name: DomainAuth uses <code>_domainauth.example.com.</code>, whilst VeraId uses <code>_veraid.example.com.</code>.<a href="#section-12.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.1-2.1.2.2">
                <p id="section-12.1-2.1.2.2.1">Value: DomainAuth requires the value to begin with the number <code>0</code>, denoting the version of the DomainAuth TXT record format, followed by a space.  This value does not have a version number in VeraId.<a href="#section-12.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-12.1-2.2">
            <p id="section-12.1-2.2.1">VeraId does not explicitly support intermediate certificates, and its implementations do not support them.  Consequently, the <code>intermediateCertificates</code> field in the Member Id Bundle is not present in VeraId.<a href="#section-12.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-2.3">
            <p id="section-12.1-2.3.1">VeraId only allows ASN.1 DER serialisation.<a href="#section-12.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-2.4">
            <p id="section-12.1-2.4.1">Cryptographic algorithms:<a href="#section-12.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-2.4.2.1">
                <p id="section-12.1-2.4.2.1.1">Signature algorithms: VeraId only supports RSA-PSS with modulus sizes of 2048, 3072, and 4096 bits.  Support for EdDSA signatures was considered, but not implemented due to lack of support in the target Hardware Security Modules (HSMs), as documented in <a href="https://issuetracker.google.com/issues/232422224">https://issuetracker.google.com/issues/232422224</a>.<a href="#section-12.1-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.1-2.4.2.2">
                <p id="section-12.1-2.4.2.2.1">Hash functions: VeraId only supports SHA-256, SHA-384, and SHA-512.<a href="#section-12.1-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.1-2.4.2.3">
                <p id="section-12.1-2.4.2.3.1">Key identification: VeraId only supports key digests (equivalent to Key Digest Types 1-3 in DomainAuth) as a consequence of its support for RSA keys only, and does not support direct use of public keys (Key Digest Type 0) for key identification.<a href="#section-12.1-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-12.1-2.5">
            <p id="section-12.1-2.5.1">VeraId does not offer protection against IDN homograph attacks (see <a href="#phishing-attacks" class="auto internal xref">Section 13.2</a>).<a href="#section-12.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-2.6">
            <p id="section-12.1-2.6.1">VeraId only disallows at-signs (<code>@</code>), tabs, and new lines in user names.  Otherwise, user names are case-sensitive and may contain spaces in VeraId.<a href="#section-12.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-2.7">
            <p id="section-12.1-2.7.1">VeraId unnecessarily requires X.509 certificates to have the Authority Key Identifier and Subject Key Identifier extensions.<a href="#section-12.1-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-12.1-3">VeraId is led by the author of this document, who intends to deprecate the VeraId specification in favour of DomainAuth and update the reference implementations to fully comply with this specification.<a href="#section-12.1-3" class="pilcrow">¶</a></p>
<p id="section-12.1-4">The following reference implementations of VeraId are available, all implemented by Relaycorp and undergoing independent security audits with reports expected by mid-April 2025:<a href="#section-12.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-12.1-5">
<li id="section-12.1-5.1">
            <p id="section-12.1-5.1.1"><strong>VeraId JavaScript Library</strong><a href="#section-12.1-5.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-5.1.2.1">
                <p id="section-12.1-5.1.2.1.1">URL: <a href="https://github.com/relaycorp/veraid-js">https://github.com/relaycorp/veraid-js</a><a href="#section-12.1-5.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.1-5.1.2.2">
                <p id="section-12.1-5.1.2.2.1">Maturity: Used in production in the VeraId Authority application.<a href="#section-12.1-5.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.1-5.1.2.3">
                <p id="section-12.1-5.1.2.3.1">Coverage: The entire protocol as outlined in <span>[<a href="#VERAID" class="cite xref">VERAID</a>]</span>.<a href="#section-12.1-5.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.1-5.1.2.4">
                <p id="section-12.1-5.1.2.4.1">Licensing: MIT licence.<a href="#section-12.1-5.1.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-12.1-5.2">
            <p id="section-12.1-5.2.1"><strong>VeraId JVM Library</strong><a href="#section-12.1-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-5.2.2.1">
                <p id="section-12.1-5.2.2.1.1">URL: <a href="https://github.com/relaycorp/veraid-jvm">https://github.com/relaycorp/veraid-jvm</a><a href="#section-12.1-5.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.1-5.2.2.2">
                <p id="section-12.1-5.2.2.2.1">Maturity: Used in the Android version of Letro <span>[<a href="#LETRO" class="cite xref">LETRO</a>]</span>.<a href="#section-12.1-5.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.1-5.2.2.3">
                <p id="section-12.1-5.2.2.3.1">Coverage: The entire protocol except for Organisation Signature Bundles.<a href="#section-12.1-5.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.1-5.2.2.4">
                <p id="section-12.1-5.2.2.4.1">Licensing: Apache 2.0 licence.<a href="#section-12.1-5.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-12.1-5.3">
            <p id="section-12.1-5.3.1"><strong>VeraId Authority</strong><a href="#section-12.1-5.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-5.3.2.1">
                <p id="section-12.1-5.3.2.1.1">URL: <a href="https://github.com/relaycorp/veraid-authority">https://github.com/relaycorp/veraid-authority</a><a href="#section-12.1-5.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.1-5.3.2.2">
                <p id="section-12.1-5.3.2.2.1">Description: A multi-tenant, cloud-native application for managing organisation members and issuing Member Id Bundles.<a href="#section-12.1-5.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.1-5.3.2.3">
                <p id="section-12.1-5.3.2.3.1">Maturity: Used in production in Letro <span>[<a href="#LETRO" class="cite xref">LETRO</a>]</span>.<a href="#section-12.1-5.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.1-5.3.2.4">
                <p id="section-12.1-5.3.2.4.1">Coverage: Uses the VeraId JavaScript Library to issue Member Id Bundles and Organisation Signature Bundles.<a href="#section-12.1-5.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.1-5.3.2.5">
                <p id="section-12.1-5.3.2.5.1">Licensing: Business Source License version 1.1.<a href="#section-12.1-5.3.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-12.1-6">To facilitate functional testing, VeraId implementations use a dedicated VeraId TXT record at <code>lib-testing.veraid.net</code>, bound to the test service (<a href="#test-service" class="auto internal xref">Section 11</a>), whose organisation's private key is publicly available in the source code for the projects above.<a href="#section-12.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="letro">
<section id="section-12.2">
        <h3 id="name-letro">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-letro" class="section-name selfRef">Letro</a>
        </h3>
<p id="section-12.2-1"><span>[<a href="#LETRO" class="cite xref">LETRO</a>]</span> is the only VeraId service as of this writing.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-2.1">
            <p id="section-12.2-2.1.1">Organisation: Relaycorp<a href="#section-12.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.2">
            <p id="section-12.2-2.2.1">URLs:<a href="#section-12.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-2.2.2.1">
                <p id="section-12.2-2.2.2.1.1"><a href="https://github.com/relaycorp/letro-android">https://github.com/relaycorp/letro-android</a><a href="#section-12.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.2-2.2.2.2">
                <p id="section-12.2-2.2.2.2.1"><a href="https://docs.relaycorp.tech/letro-server/">https://docs.relaycorp.tech/letro-server/</a><a href="#section-12.2-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-12.2-2.3">
            <p id="section-12.2-2.3.1">Maturity: Experimental.<a href="#section-12.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.4">
            <p id="section-12.2-2.4.1">Coverage: The implementation exercises the entire protocol specified in <span>[<a href="#VERAID" class="cite xref">VERAID</a>]</span>, except for organisation signatures and bot members.  It uses the VeraId JVM Library to issue member signatures on Android, and the VeraId Authority to issue Member Id Bundles under a variety of domain names operated by Relaycorp (e.g. <code>applepie.rocks</code>, <code>cuppa.fans</code>).<a href="#section-12.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.5">
            <p id="section-12.2-2.5.1">Licensing: Freely distributable with acknowledgement (GNU GPLv3 and GNU AGPLv3 licences).<a href="#section-12.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.6">
            <p id="section-12.2-2.6.1">Contact: <a href="https://relaycorp.tech/">https://relaycorp.tech/</a><a href="#section-12.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.7">
            <p id="section-12.2-2.7.1">Last updated: 2024<a href="#section-12.2-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-13">
      <h2 id="name-security-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="dnssec-dependency">
<section id="section-13.1">
        <h3 id="name-dnssec-dependency">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-dnssec-dependency" class="section-name selfRef">DNSSEC Dependency</a>
        </h3>
<p id="section-13.1-1">DomainAuth's security model relies fundamentally on DNSSEC, which introduces specific security considerations:<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-13.1-2">
<li id="section-13.1-2.1">
            <p id="section-13.1-2.1.1"><strong>Trust Anchors:</strong><a href="#section-13.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.1-2.1.2.1">
                <p id="section-13.1-2.1.2.1.1">The DomainAuth protocol inherits trust from the DNSSEC root zone.<a href="#section-13.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.1.2.2">
                <p id="section-13.1-2.1.2.2.1">Compromise of the root KSK would undermine the entire system.<a href="#section-13.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.1.2.3">
                <p id="section-13.1-2.1.2.3.1">Implementations <span class="bcp14">MUST</span> securely manage and update DNSSEC trust anchors.<a href="#section-13.1-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.1.2.4">
                <p id="section-13.1-2.1.2.4.1">Whilst the protocol allows overriding root zone DS records, this <span class="bcp14">MUST</span> only be done for testing or to reflect updated IANA trust anchors.  Using alternative DNS roots in production contradicts the unique DNS root principle outlined in <span>[<a href="#RFC2826" class="cite xref">RFC2826</a>]</span>.<a href="#section-13.1-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.1-2.2">
            <p id="section-13.1-2.2.1"><strong>TLD Control:</strong><a href="#section-13.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.1-2.2.2.1">
                <p id="section-13.1-2.2.2.1.1">Many TLDs are controlled by governments or private entities.<a href="#section-13.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.2.2.2">
                <p id="section-13.1-2.2.2.2.1">A malicious TLD operator could theoretically issue fraudulent DNSSEC responses for domains under their zone.<a href="#section-13.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.2.2.3">
                <p id="section-13.1-2.2.2.3.1">Organisations <span class="bcp14">SHOULD</span> consider the governance of their TLD when assessing security, including reviewing the relevant DNSSEC Practice Statement.<a href="#section-13.1-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.1-2.3">
            <p id="section-13.1-2.3.1"><strong>DNSSEC Implementation Vulnerabilities:</strong><a href="#section-13.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.1-2.3.2.1">
                <p id="section-13.1-2.3.2.1.1">Flaws in DNSSEC implementations could affect DomainAuth security.<a href="#section-13.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.3.2.2">
                <p id="section-13.1-2.3.2.2.1">Implementations <span class="bcp14">SHOULD</span> use well-tested, actively maintained DNSSEC libraries.<a href="#section-13.1-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.3.2.3">
                <p id="section-13.1-2.3.2.3.1">Security updates for DNSSEC components <span class="bcp14">SHOULD</span> be promptly applied.<a href="#section-13.1-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-13.1-3">Whilst these dependencies introduce potential vulnerabilities, the distributed nature of DNS provides significant security advantages compared to centralised PKI models, particularly for offline verification scenarios.<a href="#section-13.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="phishing-attacks">
<section id="section-13.2">
        <h3 id="name-phishing-attacks">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-phishing-attacks" class="section-name selfRef">Phishing Attacks</a>
        </h3>
<p id="section-13.2-1">To mitigate Internationalised Domain Name (IDN) homograph attacks, user interfaces <span class="bcp14">SHOULD</span> adopt the guidelines from Section 2.11.2 (Recommendations for User Agents) of <span>[<a href="#UTR36" class="cite xref">UTR36</a>]</span>.<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<p id="section-13.2-2">To mitigate phishing attacks leveraging user names, such names <span class="bcp14">MUST</span> be normalised to the PRECIS UsernameCaseMapped profile as specified in <span><a href="https://rfc-editor.org/rfc/rfc8265#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC8265" class="cite xref">RFC8265</a>]</span>, but spaces (U+0020) and at signs (U+0040) <span class="bcp14">MUST NOT</span> be allowed.<a href="#section-13.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="domain-ownership-changes">
<section id="section-13.3">
        <h3 id="name-domain-ownership-changes">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-domain-ownership-changes" class="section-name selfRef">Domain Ownership Changes</a>
        </h3>
<p id="section-13.3-1">Organisations <span class="bcp14">SHOULD</span> delay implementing DomainAuth until at least the period specified in <a href="#maximum-validity-period" class="auto internal xref">Section 9</a> has elapsed since the domain was registered or acquired.  This prevents the DNSSEC chain from the previous owner from remaining valid.<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<p id="section-13.3-2">Domain ownership changes represent a fundamental challenge to any domain-based authentication system.  DomainAuth's approach of using short-lived certificates and signatures helps mitigate these risks by limiting the time window during which historical signatures remain valid.<a href="#section-13.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="offline-verification-limitations">
<section id="section-13.4">
        <h3 id="name-offline-verification-limita">
<a href="#section-13.4" class="section-number selfRef">13.4. </a><a href="#name-offline-verification-limita" class="section-name selfRef">Offline Verification Limitations</a>
        </h3>
<p id="section-13.4-1">Offline verification introduces specific security considerations:<a href="#section-13.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.4-2.1">
            <p id="section-13.4-2.1.1"><strong>Time Synchronisation.</strong> Verifiers rely on accurate local clocks to determine if signatures and certificates are within their validity periods.  Devices with incorrect time settings may incorrectly accept expired signatures or reject valid ones.<a href="#section-13.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.4-2.2">
            <p id="section-13.4-2.2.1"><strong>Replay Attacks.</strong> Services <span class="bcp14">SHOULD</span> implement additional measures (e.g., nonces) for replay-sensitive operations.<a href="#section-13.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.4-2.3">
            <p id="section-13.4-2.3.1"><strong>Revocation Limitations.</strong> Offline verification cannot check real-time revocation status, and therefore the protocol relies on short validity periods rather than revocation checking.<a href="#section-13.4-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="denial-of-service">
<section id="section-13.5">
        <h3 id="name-denial-of-service">
<a href="#section-13.5" class="section-number selfRef">13.5. </a><a href="#name-denial-of-service" class="section-name selfRef">Denial of Service</a>
        </h3>
<p id="section-13.5-1">Several aspects of the protocol present potential denial of service vectors:<a href="#section-13.5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-13.5-2">
<li id="section-13.5-2.1">
            <p id="section-13.5-2.1.1"><strong>Resource-exhaustion attacks</strong>: Attackers could submit malformed or excessively complex signature bundles requiring significant resources to parse and validate, particularly during DNSSEC chain and certificate validation.<a href="#section-13.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-13.5-2.2">
            <p id="section-13.5-2.2.1"><strong>Large bundles</strong>: The protocol doesn't inherently limit signature bundle size.  Services <span class="bcp14">SHOULD</span> enforce maximum bundle sizes appropriate to their use case to prevent resource exhaustion.<a href="#section-13.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-13.5-2.3">
            <p id="section-13.5-2.3.1"><strong>Certificate chain complexity</strong>: Bundles with extremely long certificate chains may cause excessive processing time or memory consumption during validation.<a href="#section-13.5-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="key-management">
<section id="section-13.6">
        <h3 id="name-key-management">
<a href="#section-13.6" class="section-number selfRef">13.6. </a><a href="#name-key-management" class="section-name selfRef">Key Management</a>
        </h3>
<p id="section-13.6-1">Proper key management is essential for the security of the DomainAuth protocol.  The following requirements and recommendations apply:<a href="#section-13.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.6-2.1">
            <p id="section-13.6-2.1.1"><strong>Key Generation.</strong> DomainAuth REQUIRES a Cryptographically-Secure Pseudorandom Number Generator (CSPRNG) compliant with <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span>. Implementations <span class="bcp14">SHOULD</span> integrate an existing CSPRNG instead of creating their own.<a href="#section-13.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.6-2.2">
            <p id="section-13.6-2.2.1"><strong>Key Storage.</strong> Private keys <span class="bcp14">MUST</span> be protected from unauthorised access.  Organisation private keys <span class="bcp14">SHOULD</span> be stored with the highest level of protection available, preferably in Hardware Security Modules (HSMs). Member private keys <span class="bcp14">SHOULD</span> be protected with appropriate measures, such as operating system security mechanisms or hardware tokens.<a href="#section-13.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.6-2.3">
            <p id="section-13.6-2.3.1"><strong>Key Rotation.</strong> Organisations <span class="bcp14">SHOULD</span> establish a regular schedule for rotating their keys.  Given the nature of the protocol, DomainAuth TXT records for old keys <span class="bcp14">MAY</span> be removed as soon as the new key is deployed without affecting signatures produced with the old key.<a href="#section-13.6-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.6-2.4">
            <p id="section-13.6-2.4.1"><strong>Key Compromise.</strong> In the event of a key compromise, immediate rotation is <span class="bcp14">REQUIRED</span> and the compromised key's TXT record <span class="bcp14">MUST</span> be removed as soon as possible.<a href="#section-13.6-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="audit-trails">
<section id="section-13.7">
        <h3 id="name-audit-trails">
<a href="#section-13.7" class="section-number selfRef">13.7. </a><a href="#name-audit-trails" class="section-name selfRef">Audit Trails</a>
        </h3>
<p id="section-13.7-1">Organisations implementing DomainAuth <span class="bcp14">SHOULD</span> maintain comprehensive audit logs of key management operations and certificate lifecycle events to support security incident investigation and facilitate non-repudiation.<a href="#section-13.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.7-2.1">
            <p id="section-13.7-2.1.1"><strong>Key Event Logging:</strong><a href="#section-13.7-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.7-2.1.2.1">
                <p id="section-13.7-2.1.2.1.1">Organisations <span class="bcp14">MUST</span> log key generation, rotation, and retirement events.<a href="#section-13.7-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.7-2.1.2.2">
                <p id="section-13.7-2.1.2.2.1">Each log entry <span class="bcp14">SHOULD</span> include the key identifier, timestamp, operation type, and authorised operator identity.<a href="#section-13.7-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.7-2.1.2.3">
                <p id="section-13.7-2.1.2.3.1">Key material itself <span class="bcp14">MUST NOT</span> be included in logs.<a href="#section-13.7-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-13.7-2.2">
            <p id="section-13.7-2.2.1"><strong>Certificate Operations:</strong><a href="#section-13.7-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.7-2.2.2.1">
                <p id="section-13.7-2.2.2.1.1">Certificate issuance and renewal events <span class="bcp14">MUST</span> be logged.<a href="#section-13.7-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.7-2.2.2.2">
                <p id="section-13.7-2.2.2.2.1">Logs <span class="bcp14">SHOULD</span> include certificate subject, issuer, serial number, validity period, and authorising entity.<a href="#section-13.7-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-13.7-2.3">
            <p id="section-13.7-2.3.1"><strong>Member Management:</strong><a href="#section-13.7-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.7-2.3.2.1">
                <p id="section-13.7-2.3.2.1.1">Member registration, name changes, and removal operations <span class="bcp14">MUST</span> be logged.<a href="#section-13.7-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.7-2.3.2.2">
                <p id="section-13.7-2.3.2.2.1">Logs <span class="bcp14">SHOULD</span> include the affected member identifier and the authorising entity.<a href="#section-13.7-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-13.7-2.4">
            <p id="section-13.7-2.4.1"><strong>Signature Operations:</strong><a href="#section-13.7-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.7-2.4.2.1">
                <p id="section-13.7-2.4.2.1.1">Organisations <span class="bcp14">SHOULD</span> log signature creation events for organisation signatures.<a href="#section-13.7-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.7-2.4.2.2">
                <p id="section-13.7-2.4.2.2.1">Member signatures <span class="bcp14">MAY</span> be logged depending on service requirements.<a href="#section-13.7-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.7-2.4.2.3">
                <p id="section-13.7-2.4.2.3.1">Logs <span class="bcp14">SHOULD</span> include signer identifier, signature validity period, service OID, and a content reference or hash.<a href="#section-13.7-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-13.7-2.5">
            <p id="section-13.7-2.5.1"><strong>Log Security:</strong><a href="#section-13.7-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.7-2.5.2.1">
                <p id="section-13.7-2.5.2.1.1">Audit logs <span class="bcp14">MUST</span> be protected against unauthorised modification and access.<a href="#section-13.7-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.7-2.5.2.2">
                <p id="section-13.7-2.5.2.2.1">Logs <span class="bcp14">SHOULD</span> be stored with integrity protection mechanisms.<a href="#section-13.7-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.7-2.5.2.3">
                <p id="section-13.7-2.5.2.3.1">In high-risk environments, organisations <span class="bcp14">SHOULD</span> implement tamper-evident logging.<a href="#section-13.7-2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-14">
      <h2 id="name-privacy-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-14-1">DomainAuth is focused on authentication and integrity.  Confidentiality, a key property of privacy, is outside the scope of this protocol.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">The protocol's PKI design, where each organisation manages its own certificate hierarchy, helps avoid unnecessary information disclosure.  By allowing an organisation to serve as the certificate authority for its members, this approach minimises the data that would otherwise need to be shared with verifiers, thereby reducing the risk of user information leakage or enabling user enumeration attacks.<a href="#section-14-2" class="pilcrow">¶</a></p>
<p id="section-14-3">Signature bundles do not contain sensitive personal data beyond what is necessary for identity verification, following the principle of data minimisation.  The protocol also supports the use of bot signatures that do not identify specific individuals.<a href="#section-14-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-15">
      <h2 id="name-iana-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-15-1">This document requests IANA to create a new registry group called "DomainAuth Protocol Parameters".<a href="#section-15-1" class="pilcrow">¶</a></p>
<div id="domainauth-signature-algorithm-registry">
<section id="section-15.1">
        <h3 id="name-domainauth-signature-algori">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-domainauth-signature-algori" class="section-name selfRef">DomainAuth Signature Algorithm Registry</a>
        </h3>
<p id="section-15.1-1">IANA is requested to create a new registry titled "DomainAuth Signature Algorithm Registry" under the "DomainAuth Protocol Parameters" registry group.<a href="#section-15.1-1" class="pilcrow">¶</a></p>
<p id="section-15.1-2">The registry policy is Specification Required as set forth in <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-15.1-2" class="pilcrow">¶</a></p>
<p id="section-15.1-3">Each entry in this registry includes the following fields:<a href="#section-15.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1-4.1">
            <p id="section-15.1-4.1.1">Value: A numeric identifier for the signature algorithm.<a href="#section-15.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.1-4.2">
            <p id="section-15.1-4.2.1">Algorithm: Name of the signature algorithm.<a href="#section-15.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.1-4.3">
            <p id="section-15.1-4.3.1">Reference: Reference to the document that defines the algorithm.<a href="#section-15.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.1-4.4">
            <p id="section-15.1-4.4.1">Status: Either "Active", "Deprecated", or "Obsolete".<a href="#section-15.1-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-15.1-5">The initial entries in this registry are:<a href="#section-15.1-5" class="pilcrow">¶</a></p>
<span id="name-initial-entries-in-the-doma"></span><table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-initial-entries-in-the-doma" class="selfRef">Initial entries in the DomainAuth Signature Algorithm Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Algorithm</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">RSA-PSS with modulus 2048 bits</td>
              <td class="text-left" rowspan="1" colspan="1">(This document)</td>
              <td class="text-left" rowspan="1" colspan="1">Active</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">RSA-PSS with modulus 3072 bits</td>
              <td class="text-left" rowspan="1" colspan="1">(This document)</td>
              <td class="text-left" rowspan="1" colspan="1">Active</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">RSA-PSS with modulus 4096 bits</td>
              <td class="text-left" rowspan="1" colspan="1">(This document)</td>
              <td class="text-left" rowspan="1" colspan="1">Active</td>
            </tr>
          </tbody>
        </table>
<p id="section-15.1-7">The designated expert(s) <span class="bcp14">MUST</span> ensure that the proposed algorithm is appropriate for digital signatures and that the specification adequately defines its parameters and security properties.  The expert <span class="bcp14">MUST</span> consider whether the algorithm has undergone sufficient security analysis and whether its inclusion would promote interoperability.<a href="#section-15.1-7" class="pilcrow">¶</a></p>
<p id="section-15.1-8">Algorithms <span class="bcp14">MUST</span> be marked as "Deprecated" if cryptographic vulnerabilities are discovered that could significantly affect their security properties.  Algorithms <span class="bcp14">SHOULD</span> be marked as "Obsolete" if they should no longer be used due to serious security vulnerabilities.  Implementers <span class="bcp14">SHOULD NOT</span> use deprecated algorithms for new signatures and <span class="bcp14">MUST NOT</span> use obsolete algorithms.<a href="#section-15.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="domainauth-key-digest-type-registry">
<section id="section-15.2">
        <h3 id="name-domainauth-key-digest-type-">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-domainauth-key-digest-type-" class="section-name selfRef">DomainAuth Key Digest Type Registry</a>
        </h3>
<p id="section-15.2-1">IANA is requested to create a new registry titled "DomainAuth Key Digest Type Registry" under the "DomainAuth Protocol Parameters" registry group.<a href="#section-15.2-1" class="pilcrow">¶</a></p>
<p id="section-15.2-2">The registry policy is Specification Required as set forth in <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-15.2-2" class="pilcrow">¶</a></p>
<p id="section-15.2-3">Each entry in this registry includes the following fields:<a href="#section-15.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.2-4.1">
            <p id="section-15.2-4.1.1">Value: A numeric identifier for the key digest type.<a href="#section-15.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.2-4.2">
            <p id="section-15.2-4.2.1">Hash Function: If applicable, the name of the hash function used to derive the key identifier from the public key.<a href="#section-15.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.2-4.3">
            <p id="section-15.2-4.3.1">Reference: Reference to the document that defines the key digest type.<a href="#section-15.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.2-4.4">
            <p id="section-15.2-4.4.1">Status: Either "Active", "Deprecated", or "Obsolete".<a href="#section-15.2-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-15.2-5">The initial entries in this registry are:<a href="#section-15.2-5" class="pilcrow">¶</a></p>
<span id="name-initial-entries-in-the-domai"></span><table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-initial-entries-in-the-domai" class="selfRef">Initial entries in the DomainAuth Key Digest Type Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Hash Function</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">None</td>
              <td class="text-left" rowspan="1" colspan="1">(This document)</td>
              <td class="text-left" rowspan="1" colspan="1">Active</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">SHA-256</td>
              <td class="text-left" rowspan="1" colspan="1">(This document)</td>
              <td class="text-left" rowspan="1" colspan="1">Active</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">SHA-384</td>
              <td class="text-left" rowspan="1" colspan="1">(This document)</td>
              <td class="text-left" rowspan="1" colspan="1">Active</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">SHA-512</td>
              <td class="text-left" rowspan="1" colspan="1">(This document)</td>
              <td class="text-left" rowspan="1" colspan="1">Active</td>
            </tr>
          </tbody>
        </table>
<p id="section-15.2-7">Key Digest Type <code>0</code> (<code>None</code>) is reserved for future cryptographic algorithms where the public key itself is compact enough to be included directly in the Key Id field of the DomainAuth TXT record (<a href="#txt-record" class="auto internal xref">Section 3.2</a>).<a href="#section-15.2-7" class="pilcrow">¶</a></p>
<p id="section-15.2-8">The designated expert(s) <span class="bcp14">MUST</span> ensure that the proposed key digest type is cryptographically suitable for identifying public keys, and that the specification adequately defines its parameters and security properties.<a href="#section-15.2-8" class="pilcrow">¶</a></p>
<p id="section-15.2-9">Key digest types <span class="bcp14">MUST</span> be marked as "Deprecated" if cryptographic vulnerabilities are discovered that could significantly affect their security properties.  Key digest types <span class="bcp14">SHOULD</span> be marked as "Obsolete" if they should no longer be used due to serious security vulnerabilities.  Implementers <span class="bcp14">SHOULD NOT</span> use deprecated key digest types for new signatures and <span class="bcp14">MUST NOT</span> use obsolete key digest types.<a href="#section-15.2-9" class="pilcrow">¶</a></p>
<p id="section-15.2-10"><em>Note to RFC Editor: Please replace all instances of <code>(This document)</code> with the RFC number of this document upon publication.</em><a href="#section-15.2-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-16">
      <h2 id="name-references">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-16.1">
        <h3 id="name-normative-references">
<a href="#section-16.1" class="section-number selfRef">16.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="ASN.1">[ASN.1]</dt>
        <dd>
<span class="refAuthor">International Telecommunications Union</span>, <span class="refTitle">"Information Technology — ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ITU-T Recommendation X.690</span>, <time datetime="1994" class="refDate">1994</time>. </dd>
<dd class="break"></dd>
<dt id="CMS">[CMS]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5652">https://www.rfc-editor.org/rfc/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNS">[DNS]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1035">https://www.rfc-editor.org/rfc/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNSSEC">[DNSSEC]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refTitle">"DNS Security Extensions (DNSSEC)"</span>, <span class="seriesInfo">BCP 237</span>, <span class="seriesInfo">RFC 9364</span>, <span class="seriesInfo">DOI 10.17487/RFC9364</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9364">https://www.rfc-editor.org/rfc/rfc9364</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST.FIPS.180-4">[NIST.FIPS.180-4]</dt>
        <dd>
<span class="refAuthor">Dang, Q. H.</span> and <span class="refAuthor">NIST</span>, <span class="refTitle">"Secure Hash Standard"</span>, <span class="seriesInfo">NIST Federal Information Processing Standards Publications 180-4</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.180-4</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4055">[RFC4055]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Kaliski, B.</span>, and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 4055</span>, <span class="seriesInfo">DOI 10.17487/RFC4055</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4055">https://www.rfc-editor.org/rfc/rfc4055</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4056">[RFC4056]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Use of the RSASSA-PSS Signature Algorithm in Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 4056</span>, <span class="seriesInfo">DOI 10.17487/RFC4056</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4056">https://www.rfc-editor.org/rfc/rfc4056</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4086">https://www.rfc-editor.org/rfc/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7942">[RFC7942]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7942">https://www.rfc-editor.org/rfc/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8265">[RFC8265]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">A. Melnikov</span>, <span class="refTitle">"Preparation, Enforcement, and Comparison of Internationalized Strings Representing Usernames and Passwords"</span>, <span class="seriesInfo">RFC 8265</span>, <span class="seriesInfo">DOI 10.17487/RFC8265</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8265">https://www.rfc-editor.org/rfc/rfc8265</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="UTR36">[UTR36]</dt>
        <dd>
<span class="refAuthor">Davis, M.</span> and <span class="refAuthor">M. Suignard</span>, <span class="refTitle">"UTR #36: Unicode Security Considerations"</span>, <time datetime="2014-09-19" class="refDate">19 September 2014</time>, <span>&lt;<a href="https://www.unicode.org/reports/tr36/tr36-15.html">https://www.unicode.org/reports/tr36/tr36-15.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.509">[X.509]</dt>
      <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-16.2">
        <h3 id="name-informative-references">
<a href="#section-16.2" class="section-number selfRef">16.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AWALA">[AWALA]</dt>
        <dd>
<span class="refAuthor">Narea, G.</span>, <span class="refTitle">"Awala"</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://specs.awala.network/">https://specs.awala.network/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JWT">[JWT]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LETRO">[LETRO]</dt>
        <dd>
<span class="refAuthor">Narea, G.</span>, <span class="refTitle">"Letro"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://letro.app/en/">https://letro.app/en/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2826">[RFC2826]</dt>
        <dd>
<span class="refAuthor">IAB</span>, <span class="refTitle">"IAB Technical Comment on the Unique DNS Root"</span>, <span class="seriesInfo">RFC 2826</span>, <span class="seriesInfo">DOI 10.17487/RFC2826</span>, <time datetime="2000-05" class="refDate">May 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2826">https://www.rfc-editor.org/rfc/rfc2826</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8017">https://www.rfc-editor.org/rfc/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="VERAID">[VERAID]</dt>
      <dd>
<span class="refAuthor">Narea, G.</span>, <span class="refTitle">"VeraId V1 Specification"</span>, <time datetime="2025" class="refDate">2025</time>, <span>&lt;<a href="https://veraid.net/spec/">https://veraid.net/spec/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="asn1-schemas">
<section id="appendix-A">
      <h2 id="name-asn1-schemas">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-asn1-schemas" class="section-name selfRef">ASN.1 Schemas</a>
      </h2>
<p id="appendix-A-1">The following ASN.1 schemas define the data structures used in the DomainAuth protocol:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-2">
<pre>
-- Top-level schemas for DomainAuth components

-- DNSSEC chain is a set of DNS messages
DnssecChain ::= SET OF OCTET STRING

-- Member Id Bundle
MemberIdBundle ::= SEQUENCE {
    version                  [0] INTEGER,
    dnssecChain              [1] DnssecChain,
    organisationCertificate  [2] Certificate,
    memberCertificate        [3] Certificate,
    intermediateCertificates [4] SET OF Certificate OPTIONAL
}

-- Signature Bundle
SignatureBundle ::= SEQUENCE {
    version                  [0] INTEGER,
    dnssecChain              [1] DnssecChain,
    organisationCertificate  [2] Certificate,
    signature                [3] ContentInfo
}

-- Signature metadata (included as a signed attribute)
SignatureMetadata ::= SEQUENCE {
    serviceOid      [0] OBJECT IDENTIFIER,
    validityPeriod  [1] DatePeriod
}

-- Date period structure
DatePeriod ::= SEQUENCE {
    start  [0] GeneralizedTime,
    end    [1] GeneralizedTime
}

-- Member attribution (included as a signed attribute in organisation signatures)
MemberAttribution ::= UTF8String
</pre><a href="#appendix-A-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A-3">All DomainAuth data structures <span class="bcp14">MUST</span> be encoded using ASN.1 as specified in <a href="#data-serialisation" class="auto internal xref">Section 10</a>.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">The ASN.1 structures reference standard types from other specifications:<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-5.1">
          <p id="appendix-A-5.1.1">Certificate is defined in <span>[<a href="#X.509" class="cite xref">X.509</a>]</span>.<a href="#appendix-A-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.2">
          <p id="appendix-A-5.2.1">ContentInfo is defined in <span>[<a href="#CMS" class="cite xref">CMS</a>]</span>.<a href="#appendix-A-5.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-6">All implementations <span class="bcp14">MUST</span> strictly adhere to these schemas.<a href="#appendix-A-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oid-registry">
<section id="appendix-B">
      <h2 id="name-oid-registry">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-oid-registry" class="section-name selfRef">OID Registry</a>
      </h2>
<p id="appendix-B-1">The following Object Identifiers (OIDs) are defined for use in the DomainAuth protocol, under the <code>1.3.6.1.4.1.58708.1</code> (iso.org.dod.internet.private.enterprise.relaycorp.domainauth) arc:<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.1">
          <p id="appendix-B-2.1.1"><code>1.3.6.1.4.1.58708.1.0</code>: Signature Metadata Attribute.<a href="#appendix-B-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.2">
          <p id="appendix-B-2.2.1"><code>1.3.6.1.4.1.58708.1.1</code>: Test Service.<a href="#appendix-B-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.3">
          <p id="appendix-B-2.3.1"><code>1.3.6.1.4.1.58708.1.2</code>: Member Attribution Attribute.<a href="#appendix-B-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="service-design-guidance">
<section id="appendix-C">
      <h2 id="name-service-design-guidance">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-service-design-guidance" class="section-name selfRef">Service Design Guidance</a>
      </h2>
<p id="appendix-C-1">This non-normative section summarises key considerations for system designers creating services that utilise DomainAuth, drawing upon requirements and recommendations specified elsewhere in this document.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">Service designers are required to obtain a unique OID for their service, distinct from the DomainAuth OID arc (see <a href="#oid-registry" class="auto internal xref">Appendix B</a>), as this OID is embedded within the signature metadata (<a href="#signature-metadata" class="auto internal xref">Section 6.2</a>) and used during verification (<a href="#verification-procedure" class="auto internal xref">Section 7.1</a>). Note that organisations have the option to bind specific keys to a service OID via the DomainAuth TXT record (<a href="#txt-record" class="auto internal xref">Section 3.2</a>), which verifiers are required to account for when matching signatures to keys.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">Consideration should be given to incorporating version information either within the OID structure or the service-specific plaintext data being signed, to facilitate future upgrades to the plaintext format.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<p id="appendix-C-4">Given the reliance on local clocks for offline verification (<a href="#offline-verification-limitations" class="auto internal xref">Section 13.4</a>), services may find it beneficial to establish a minimum signature validity duration (e.g., several minutes) to accommodate potential clock skew.  Remember that the overall verification requires temporal overlap between the DNSSEC chain's validity window (influenced by the TTL override <a href="#ttl-override" class="auto internal xref">Section 3.3</a>), the certificate chain's validity (<a href="#x509-certificate-profile" class="auto internal xref">Section 4</a>), and the signature metadata's validity period (<a href="#verification-procedure" class="auto internal xref">Section 7.1</a>).<a href="#appendix-C-4" class="pilcrow">¶</a></p>
<p id="appendix-C-5">Whilst the protocol mandates ASN.1 DER encoding (<a href="#data-serialisation" class="auto internal xref">Section 10</a>), services have the option to specify alternative ASN.1 encoding rules, but service-level implementations bear the responsibility for any necessary conversions if the underlying DomainAuth library does not support the alternative rules (<a href="#data-serialisation" class="auto internal xref">Section 10</a>).<a href="#appendix-C-5" class="pilcrow">¶</a></p>
<p id="appendix-C-6">Services need to determine which signature types (Member, Organisation, or both) are appropriate for their use case (<a href="#signature-types" class="auto internal xref">Section 6.1</a>), and whether plaintext will be encapsulated or detached (<a href="#signature-bundle-production" class="auto internal xref">Section 2.2.3</a>).<a href="#appendix-C-6" class="pilcrow">¶</a></p>
<div id="service-security-considerations">
<section id="appendix-C.1">
        <h3 id="name-service-security-considerat">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-service-security-considerat" class="section-name selfRef">Service Security Considerations</a>
        </h3>
<p id="appendix-C.1-1">The validity period for signatures, specified in the signature metadata (<a href="#signature-metadata" class="auto internal xref">Section 6.2</a>), is required to adhere to the maximum limit defined in <a href="#maximum-validity-period" class="auto internal xref">Section 9</a>. It is recommended that services define their own maximum validity period, as short as possible for their use case, to enhance security (<a href="#maximum-validity-period" class="auto internal xref">Section 9</a>).<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<p id="appendix-C.1-2">DomainAuth specifies mandatory-to-implement cryptographic algorithms (<a href="#cryptographic-algorithms" class="auto internal xref">Section 8</a>). Services have the option to recommend specific algorithms from the allowed set but cannot mandate unsupported ones.<a href="#appendix-C.1-2" class="pilcrow">¶</a></p>
<p id="appendix-C.1-3">Service implementations must not override root zone DS records except for testing or to reflect updated IANA trust anchors.  Services using DomainAuth should clearly distinguish test environments from production.<a href="#appendix-C.1-3" class="pilcrow">¶</a></p>
<p id="appendix-C.1-4">Services designers should also consider the following potential attack vectors:<a href="#appendix-C.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.1-5.1">
            <p id="appendix-C.1-5.1.1"><strong>Replay attacks:</strong> DomainAuth provides authenticity and integrity but does not inherently mitigate replay attacks.  Services may need to implement additional measures, such as nonces, depending on the application's sensitivity to replays (<a href="#offline-verification-limitations" class="auto internal xref">Section 13.4</a>).<a href="#appendix-C.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-5.2">
            <p id="appendix-C.1-5.2.1"><strong>Phishing attacks:</strong> Service logic built upon the verified identity ought to correctly handle the required Unicode representation of domain names, and the specific normalisation and character restrictions applicable to user names (<a href="#phishing-attacks" class="auto internal xref">Section 13.2</a>, <a href="#verification-procedure" class="auto internal xref">Section 7.1</a>). Adhering to guidelines like those in <span>[<a href="#UTR36" class="cite xref">UTR36</a>]</span> for displaying Internationalised Domain Names can help mitigate homograph attacks.<a href="#appendix-C.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-5.3">
            <p id="appendix-C.1-5.3.1"><strong>Denial of service:</strong> Service designers should establish limits on signature bundle size to mitigate resource exhaustion attacks (<a href="#denial-of-service" class="auto internal xref">Section 13.5</a>).<a href="#appendix-C.1-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-C.1-6">Services may define their own requirements for logging signature events, which would complement the organisation-level audit trails recommended in <a href="#audit-trails" class="auto internal xref">Section 13.7</a>.<a href="#appendix-C.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="service-user-experience-considerations">
<section id="appendix-C.2">
        <h3 id="name-service-user-experience-con">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-service-user-experience-con" class="section-name selfRef">Service User Experience Considerations</a>
        </h3>
<p id="appendix-C.2-1">Presenting DomainAuth verification results clearly is important for users to understand the basis of trust.  Since DomainAuth supports different signature types with distinct trust implications, user interfaces can play a crucial role in conveying this information accurately.<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
<p id="appendix-C.2-2">Designers should consider the following points when crafting the user experience for DomainAuth services:<a href="#appendix-C.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.2-3.1">
            <p id="appendix-C.2-3.1.1"><strong>Communicating signature origin.</strong> Consider distinguishing between member signatures (cryptographically proven) and organisation signatures (where the organisation vouches for content with member attribution). For organisation signatures, the attribution may be presented as a claim by the organisation (e.g., "Vouched for by example.com, attributed to alice") rather than implying direct proof from the member.  However, the distinction may or may not be relevant depending on the service.<a href="#appendix-C.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-3.2">
            <p id="appendix-C.2-3.2.1"><strong>Representing bot signatures.</strong> When displaying signatures associated with bots, the interface has to attribute the signature to the organisation itself, omitting any specific user name (e.g. "Signed by example.com").<a href="#appendix-C.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-3.3">
            <p id="appendix-C.2-3.3.1"><strong>Displaying identifiers safely.</strong><a href="#appendix-C.2-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.2-3.3.2.1">
                <p id="appendix-C.2-3.3.2.1.1">Consider implementing IDN homograph attack mitigations, such as those suggested in <span>[<a href="#UTR36" class="cite xref">UTR36</a>]</span>.<a href="#appendix-C.2-3.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.2-3.3.2.2">
                <p id="appendix-C.2-3.3.2.2.1">Display the user name exactly as provided by the verification process (which is based on normalised data per <a href="#phishing-attacks" class="auto internal xref">Section 13.2</a>).<a href="#appendix-C.2-3.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.2-3.3.2.3">
                <p id="appendix-C.2-3.3.2.3.1">Avoid truncating user names or domain names to prevent ambiguity or misrepresentation.<a href="#appendix-C.2-3.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.2-3.3.2.4">
                <p id="appendix-C.2-3.3.2.4.1">Visually distinguish the user name part from the domain name part of an identifier (e.g., "alice of example.com", "alice@example.com").<a href="#appendix-C.2-3.3.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="implementation-guidance">
<section id="appendix-D">
      <h2 id="name-implementation-guidance">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-implementation-guidance" class="section-name selfRef">Implementation Guidance</a>
      </h2>
<p id="appendix-D-1">This non-normative section provides guidance for developers implementing DomainAuth libraries.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">Implementations should ensure strict compliance with the ASN.1 schemas (<a href="#asn1-schemas" class="auto internal xref">Appendix A</a>), serialisation formats (<a href="#data-serialisation" class="auto internal xref">Section 10</a>), and cryptographic algorithms (<a href="#cryptographic-algorithms" class="auto internal xref">Section 8</a>). Separating core protocol functionality from service-specific logic enables reuse across multiple services.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<p id="appendix-D-3">For testing purposes, implementers should consider establishing a dedicated DNSSEC-enabled test domain with a DomainAuth TXT record whose private key is publicly available, bound specifically to the test service OID (<code>1.3.6.1.4.1.58708.1.1</code>). This approach is secure when properly scoped: the domain is controlled by the implementation team, the key is bound only to the test service, and documentation clearly indicates these are for testing only.  Serialised DNSSEC chains can also serve as test fixtures, allowing offline testing.<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<p id="appendix-D-4">Implementations have to provide the ability to override root zone DS records, which is only intended for local testing environments or to reflect updated IANA trust anchors before the underlying DNSSEC implementation is updated.<a href="#appendix-D-4" class="pilcrow">¶</a></p>
<p id="appendix-D-5">The verification procedure should support both verification orders described in <a href="#verification-procedure" class="auto internal xref">Section 7.1</a>: either starting with the DNSSEC chain and ending with the signature, or vice versa.  A critical aspect is validating that all components in the trust chain (DNSSEC records, certificates, and signatures) have validity periods that overlap for at least one second.  Implementations should also handle multiple TXT records correctly, selecting the appropriate one based on key information and service OID.<a href="#appendix-D-5" class="pilcrow">¶</a></p>
<p id="appendix-D-6">Error handling should categorise failures based on verification steps (<a href="#verification-procedure" class="auto internal xref">Section 7.1</a>), with different diagnostic detail levels for debugging versus production.  Performance optimisations may include caching verified DNSSEC chains, using efficient ASN.1 parsing libraries, ensuring thread safety, and optimising certificate validation operations.<a href="#appendix-D-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="organisation-operation-guidance">
<section id="appendix-E">
      <h2 id="name-organisation-operation-guid">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-organisation-operation-guid" class="section-name selfRef">Organisation Operation Guidance</a>
      </h2>
<p id="appendix-E-1">This non-normative section provides guidance for organisations operating domains that participate in the DomainAuth protocol.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">Before implementation, organisations should ensure their domain has been under their control for at least the maximum validity period (<a href="#maximum-validity-period" class="auto internal xref">Section 9</a>) and consider TLD governance (<a href="#dnssec-dependency" class="auto internal xref">Section 13.1</a>). DNSSEC must be properly configured, with processes established for key rollovers.<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<div id="tld-dnssec-considerations">
<section id="appendix-E.1">
        <h3 id="name-tld-dnssec-considerations">
<a href="#appendix-E.1" class="section-number selfRef">E.1. </a><a href="#name-tld-dnssec-considerations" class="section-name selfRef">TLD DNSSEC Considerations</a>
        </h3>
<p id="appendix-E.1-1">When selecting a domain for DomainAuth implementation, organisations should carefully assess the security practices of the TLD operator, as mentioned in <a href="#dnssec-dependency" class="auto internal xref">Section 13.1</a>. Factors to consider include:<a href="#appendix-E.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E.1-2.1">
            <p id="appendix-E.1-2.1.1">The TLD operator's jurisdiction and potential vulnerability to government influence.<a href="#appendix-E.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.1-2.2">
            <p id="appendix-E.1-2.2.1">The cryptographic algorithms used for DNSSEC by the TLD.<a href="#appendix-E.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.1-2.3">
            <p id="appendix-E.1-2.3.1">The TLD's DNSSEC Practice Statement.<a href="#appendix-E.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.1-2.4">
            <p id="appendix-E.1-2.4.1">The TLD operator's history of security incidents or vulnerabilities.<a href="#appendix-E.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-E.1-3">For security-critical applications, organisations may wish to select TLDs with strong security practices and jurisdictions with robust legal protections.<a href="#appendix-E.1-3" class="pilcrow">¶</a></p>
<p id="appendix-E.1-4">Similar considerations apply to the DNS hosting provider used for the domain, as they represent another potential attack vector.  The security practices, DNSSEC support, access controls, and jurisdictional factors of the entity responsible for hosting the domain's DNS records can significantly impact the overall security of a DomainAuth implementation.<a href="#appendix-E.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="organisation-key-management">
<section id="appendix-E.2">
        <h3 id="name-organisation-key-management">
<a href="#appendix-E.2" class="section-number selfRef">E.2. </a><a href="#name-organisation-key-management" class="section-name selfRef">Organisation Key Management</a>
        </h3>
<p id="appendix-E.2-1">Key management practices should include secure generation (potentially using HSMs as suggested in <a href="#key-management" class="auto internal xref">Section 13.6</a>), protected storage, and scheduled rotation.  Organisations may publish multiple TXT records for different keys, algorithms, or services, which facilitates smooth key rotation.  The TTL override value in TXT records significantly affects verification windows and should be set appropriately for the service's offline requirements.<a href="#appendix-E.2-1" class="pilcrow">¶</a></p>
<p id="appendix-E.2-2">The organisation certificate serves as the trust anchor for all members, making its protection particularly important.  For member management, establish clear processes for certificate issuance, naming conventions that comply with normalisation requirements (<a href="#phishing-attacks" class="auto internal xref">Section 13.2</a>), secure distribution of Member Id Bundles, and handling departing members.<a href="#appendix-E.2-2" class="pilcrow">¶</a></p>
<p id="appendix-E.2-3">Operational security measures should include regular verification of DomainAuth TXT records, comprehensive logging (<a href="#audit-trails" class="auto internal xref">Section 13.7</a>), certificate inventory maintenance, and monitoring for unauthorised DNS modifications.  Incident response procedures should address key compromise, DNS hijacking, and trust recovery, noting that the limited validity period of signatures helps contain security incident impact.<a href="#appendix-E.2-3" class="pilcrow">¶</a></p>
<p id="appendix-E.2-4">Due to the residual risks regarding offline verification (<a href="#offline-verification-limitations" class="auto internal xref">Section 13.4</a>), organisations should implement additional safeguards:<a href="#appendix-E.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E.2-5.1">
            <p id="appendix-E.2-5.1.1">Keep validity periods as short as operationally feasible.<a href="#appendix-E.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-5.2">
            <p id="appendix-E.2-5.2.1">Implement robust monitoring for potential compromise indicators.<a href="#appendix-E.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-5.3">
            <p id="appendix-E.2-5.3.1">Maintain secure backup procedures for cryptographic materials.<a href="#appendix-E.2-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-5.4">
            <p id="appendix-E.2-5.4.1">Have emergency procedures in place to respond to security incidents, including communication plans to notify relying parties.<a href="#appendix-E.2-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-F">
      <h2 id="name-acknowledgements">
<a href="#appendix-F" class="section-number selfRef">Appendix F. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-F-1">The author is grateful to the Open Technology Fund for funding the implementation of VeraId, which heavily influenced the final specification of the VeraId protocol, and therefore DomainAuth as its successor.<a href="#appendix-F-1" class="pilcrow">¶</a></p>
<p id="appendix-F-2">The author would also like to thank the authors of <span>[<a href="#DNS" class="cite xref">DNS</a>]</span>, <span>[<a href="#DNSSEC" class="cite xref">DNSSEC</a>]</span>, <span>[<a href="#X.509" class="cite xref">X.509</a>]</span>, <span>[<a href="#CMS" class="cite xref">CMS</a>]</span>, and <span>[<a href="#ASN.1" class="cite xref">ASN.1</a>]</span>, which underpin the present protocol.<a href="#appendix-F-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-G">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Gus Narea</span></div>
<div dir="auto" class="left"><span class="org">Relaycorp</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gus@relaycorp.tech" class="email">gus@relaycorp.tech</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
