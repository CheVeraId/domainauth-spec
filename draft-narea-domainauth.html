<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Cyrillic,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>DomainAuth Version 1</title>
<meta content="Gus Narea" name="author">
<meta content='
       This document defines DomainAuth, a protocol to attribute digital signatures to domain names in such a way that verification can occur entirely offline without a prior distribution of public keys. 
       Each signature is distributed as part of a self-contained "signature bundle" that encapsulates a complete chain of trust comprising: (1) a DNSSEC chain from the root zone to a TXT record containing a public key or its digest, (2) an X.509 certificate chain from the key specified in the TXT record to the final signing key, and (3) the digital signature in the form of a CMS SignedData structure. 
       Finally, signatures can be attributed to the domain name itself (e.g. "example.com") or specific users (e.g. "alice" of "example.com"). 
    ' name="description">
<meta content="xml2rfc 3.28.0" name="generator">
<meta content="dnssec" name="keyword">
<meta content="x509" name="keyword">
<meta content="cms" name="keyword">
<meta content="authentication" name="keyword">
<meta content="draft-narea-domainauth-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.0
    Python 3.12.9
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-narea-domainauth.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DomainAuthV1</td>
<td class="right">March 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Narea</td>
<td class="center">Expires 29 September 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-narea-domainauth-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-03-28" class="published">28 March 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-09-29">29 September 2025</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">G. Narea</div>
<div class="org">Relaycorp</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">DomainAuth Version 1</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines DomainAuth, a protocol to attribute digital signatures to domain names in such a way that verification can occur entirely offline without a prior distribution of public keys.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">Each signature is distributed as part of a self-contained "signature bundle" that encapsulates a complete chain of trust comprising: (1) a DNSSEC chain from the root zone to a TXT record containing a public key or its digest, (2) an X.509 certificate chain from the key specified in the TXT record to the final signing key, and (3) the digital signature in the form of a CMS SignedData structure.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">Finally, signatures can be attributed to the domain name itself (e.g. "example.com") or specific users (e.g. "alice" of "example.com").<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://docs.veraid.net/domainauth-spec/draft-narea-domainauth.html">https://docs.veraid.net/domainauth-spec/draft-narea-domainauth.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-narea-domainauth/">https://datatracker.ietf.org/doc/draft-narea-domainauth/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/CheVeraId/domainauth-spec">https://github.com/CheVeraId/domainauth-spec</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 29 September 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-problem-statement" class="internal xref">Problem Statement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-design-goals" class="internal xref">Design Goals</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-architecture" class="internal xref">Architecture</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-workflow-summary" class="internal xref">Workflow Summary</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-organisation-setup" class="internal xref">Organisation Setup</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="auto internal xref">2.2.2</a>.  <a href="#name-certificate-issuance" class="internal xref">Certificate Issuance</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="auto internal xref">2.2.3</a>.  <a href="#name-signature-bundle-production" class="internal xref">Signature Bundle Production</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.4">
                    <p id="section-toc.1-1.2.2.2.2.4.1"><a href="#section-2.2.4" class="auto internal xref">2.2.4</a>.  <a href="#name-signature-bundle-verificati" class="internal xref">Signature Bundle Verification</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-trust-model" class="internal xref">Trust Model</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-dns-integration" class="internal xref">DNS Integration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-dnssec-configuration" class="internal xref">DNSSEC Configuration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-txt-record" class="internal xref">TXT Record</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-ttl-override" class="internal xref">TTL Override</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-dnssec-chain-serialisation" class="internal xref">DNSSEC Chain Serialisation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-x509-certificate-profile" class="internal xref">X.509 Certificate Profile</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-organisation-certificate" class="internal xref">Organisation Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-member-certificate" class="internal xref">Member Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-intermediate-certificate" class="internal xref">Intermediate Certificate</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-member-id-bundle" class="internal xref">Member Id Bundle</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-cms-signeddata-structure" class="internal xref">CMS SignedData Structure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-signature-types" class="internal xref">Signature Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-member-signatures" class="internal xref">Member Signatures</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-organisation-signatures" class="internal xref">Organisation Signatures</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-signature-metadata" class="internal xref">Signature Metadata</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-signature-bundle" class="internal xref">Signature Bundle</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-verification-process" class="internal xref">Verification Process</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-cryptographic-algorithms" class="internal xref">Cryptographic Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-digital-signature-algorithm" class="internal xref">Digital Signature Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="auto internal xref">8.1.1</a>.  <a href="#name-rsa-pss" class="internal xref">RSA-PSS</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-hash-functions" class="internal xref">Hash Functions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-maximum-validity-period" class="internal xref">Maximum Validity Period</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-naming-conventions-and-rest" class="internal xref">Naming Conventions and Restrictions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-services" class="internal xref">Services</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-service-oids" class="internal xref">Service OIDs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-service-specific-validation" class="internal xref">Service-Specific Validation Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-implementation-guidelines" class="internal xref">Implementation Guidelines</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="auto internal xref">11.4</a>.  <a href="#name-data-serialisation" class="internal xref">Data Serialisation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-veraid-javascript-library" class="internal xref">VeraId JavaScript Library</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-veraid-jvm-library" class="internal xref">VeraId JVM Library</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-veraid-authority" class="internal xref">VeraId Authority</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="auto internal xref">12.4</a>.  <a href="#name-letro" class="internal xref">Letro</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-dnssec-dependency" class="internal xref">DNSSEC Dependency</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-homographic-and-character-e" class="internal xref">Homographic and Character Encoding Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="auto internal xref">13.3</a>.  <a href="#name-domain-ownership-changes" class="internal xref">Domain Ownership Changes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#section-13.4" class="auto internal xref">13.4</a>.  <a href="#name-offline-verification-limita" class="internal xref">Offline Verification Limitations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#section-13.5" class="auto internal xref">13.5</a>.  <a href="#name-organisation-signatures-and" class="internal xref">Organisation Signatures and Member Attribution</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.6">
                <p id="section-toc.1-1.13.2.6.1"><a href="#section-13.6" class="auto internal xref">13.6</a>.  <a href="#name-key-management" class="internal xref">Key Management</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-asn1-schemas" class="internal xref">ASN.1 Schemas</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-oid-registry" class="internal xref">OID Registry</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-implementation-guidance" class="internal xref">Implementation Guidance</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-performance-optimisations" class="internal xref">Performance Optimisations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-implementation-recommendati" class="internal xref">Implementation Recommendations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3">
                <p id="section-toc.1-1.18.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-user-interface-guidelines" class="internal xref">User Interface Guidelines</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Public Key Infrastructures typically require continuous Internet connectivity for certificate validation or prior distribution of public keys, creating significant limitations for offline or intermittently connected environments. This document addresses the challenge of securely attributing content to domain names in scenarios where verification must occur entirely offline, without reliance on real-time certificate status checking or pre-distributed trust anchors.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">DomainAuth solves this verification challenge by creating self-contained "signature bundles" that encapsulate the complete trust chain required for validation. Each bundle comprises three cryptographically linked components: a DNSSEC chain extending from the DNS root to a domain's TXT record containing key material, an X.509 certificate chain from the domain to the signing entity, and a CMS SignedData structure containing the digital signature. This architecture leverages established standards whilst eliminating the need for continuous connectivity or prior trust establishment.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This specification defines the protocol components, data structures, and verification procedures that constitute the DomainAuth protocol. It covers the DNS integration mechanism, cryptographic requirements, certificate management practices, and signature verification processes.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="problem-statement">
<section id="section-1.1">
        <h3 id="name-problem-statement">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-problem-statement" class="section-name selfRef">Problem Statement</a>
        </h3>
<p id="section-1.1-1">The protocol was initially designed and implemented to provide users of the offline messaging application Letro <span>[<a href="#LETRO" class="cite xref">LETRO</a>]</span> with identifiers that are customisable, user friendly, universally unique, and verifiable.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Letro is powered by the delay-tolerant network Awala <span>[<a href="#AWALA" class="cite xref">AWALA</a>]</span>, which offers an end-to-end encrypted sneakernet to transport data between a region disconnected from the Internet and a location with access to the Internet. In the most extreme cases, this physical transport may take several weeks, during which users should be able to produce and verify digital signatures without relying on online services.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Attacks by powerful adversaries, such as nation-state actors, are part of the threat model, given that Awala and Letro explicitly target people disconnected from the Internet due to conflict or government-sponsored censorship.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">Despite its origin in delay-tolerant networking, DomainAuth has broader applicability and can be useful when the Internet is available, such as the following use cases:<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-5.1">
            <p id="section-1.1-5.1.1">Client authentication. A client could prove its identity to a server by sending a short-lived token signed with DomainAuth; this would be analogous to using a JSON Web Token <span>[<a href="#JWT" class="cite xref">JWT</a>]</span>, except that it can be verified without a prior distribution of public keys or remote operations. Alternatively, the client could sign each message sent to the server.<a href="#section-1.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-5.2">
            <p id="section-1.1-5.2.1">Artefact signing. Documents, applications, libraries, and other files could be signed on behalf of a domain name, without vendor-specific gatekeeping mechanisms. This could unlock further use cases, such as enabling users to share original content whilst proving authenticity and integrity, instead of sharing URLs to resources that could be blocked at the network level.<a href="#section-1.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-5.3">
            <p id="section-1.1-5.3.1">Peer-to-peer web hosting. A next-generation of websites could be hosted on a peer-to-peer network, with files reliably attributed to their respective domain names.<a href="#section-1.1-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.1-6">The present document is meant to provide the foundation for all the use cases above in a generic manner.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="design-goals">
<section id="section-1.2">
        <h3 id="name-design-goals">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-design-goals" class="section-name selfRef">Design Goals</a>
        </h3>
<p id="section-1.2-1">DomainAuth is designed with the following primary goals:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.2-2">
<li id="section-1.2-2.1">
            <p id="section-1.2-2.1.1"><strong>Decentralisation:</strong> The protocol avoids the need for centralised authorities beyond the DNS hierarchy itself. Each domain owner has exclusive control over their domain and its associated members.<a href="#section-1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-2.2">
            <p id="section-1.2-2.2.1"><strong>Offline verification:</strong> All signature bundles contain sufficient information to be independently verified without requiring external network queries.<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-2.3">
            <p id="section-1.2-2.3.1"><strong>User-friendly identifiers:</strong> Identities are based on familiar, human-readable domain names and usernames rather than cryptographically-derived values.<a href="#section-1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-2.4">
            <p id="section-1.2-2.4.1"><strong>Build upon well-established standards:</strong> DNSSEC for securing DNS responses, X.509 for certificate management, and CMS for digital signatures.<a href="#section-1.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-2.5">
            <p id="section-1.2-2.5.1"><strong>Minimal trust assumptions:</strong> The protocol reduces trust dependencies by leveraging DNSSEC, limiting potential credential issuance attacks to DNS hierarchy operators (primarily IANA and TLD operators).<a href="#section-1.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-2.6">
            <p id="section-1.2-2.6.1"><strong>Contextual binding:</strong> Signatures are bound to specific "services", preventing their unauthorised use across different contexts.<a href="#section-1.2-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-1.3">
        <h3 id="name-conventions-and-terminology">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
        </h3>
<p id="section-1.3-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">The following terms are used:<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-3.1">
            <p id="section-1.3-3.1.1"><strong>Organisation:</strong> A domain name that participates in the DomainAuth protocol by configuring DNSSEC and publishing the necessary DomainAuth TXT record(s).<a href="#section-1.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-3.2">
            <p id="section-1.3-3.2.1"><strong>Member:</strong> An entity that produces signatures on behalf of an organisation. There are two types of members:<a href="#section-1.3-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-3.2.2.1">
                <p id="section-1.3-3.2.2.1.1"><strong>User:</strong> A member identified by a unique username within an organisation.<a href="#section-1.3-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.3-3.2.2.2">
                <p id="section-1.3-3.2.2.2.1"><strong>Bot:</strong> A special type of member that acts on behalf of the organisation as a whole. Bots do not have usernames.<a href="#section-1.3-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.3-3.3">
            <p id="section-1.3-3.3.1"><strong>DomainAuth TXT Record:</strong> A DNS TXT record at <code>_domainauth.&lt;domain&gt;</code> that contains the organisation's public key information.<a href="#section-1.3-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-3.4">
            <p id="section-1.3-3.4.1"><strong>Organisation Certificate:</strong> A self-signed X.509 certificate owned by an organisation that serves as the root of trust for all signatures produced on behalf of that organisation.<a href="#section-1.3-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-3.5">
            <p id="section-1.3-3.5.1"><strong>Member Certificate:</strong> An X.509 certificate issued by the organisation certificate to a member.<a href="#section-1.3-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-3.6">
            <p id="section-1.3-3.6.1"><strong>Member Id Bundle:</strong> A data structure containing a member certificate, its issuing organisation certificate, and the DNSSEC chain proving the authenticity of the organisation's DomainAuth TXT record.<a href="#section-1.3-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-3.7">
            <p id="section-1.3-3.7.1"><strong>Signature Bundle:</strong> A data structure containing a digital signature and all the information needed to verify it offline. There are two types of signature bundles:<a href="#section-1.3-3.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-3.7.2.1">
                <p id="section-1.3-3.7.2.1.1"><strong>Member Signature Bundle:</strong> A signature bundle containing a signature produced by a member using their private key.<a href="#section-1.3-3.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.3-3.7.2.2">
                <p id="section-1.3-3.7.2.2.1"><strong>Organisation Signature Bundle:</strong> A signature bundle containing a signature produced directly by an organisation using its private key, with a required member attribution that assigns authorship of the content to a specific member.<a href="#section-1.3-3.7.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.3-3.8">
            <p id="section-1.3-3.8.1"><strong>DNSSEC Chain:</strong> A sequence of DNS responses that allows a verifier to cryptographically validate the authenticity of a DNS record.<a href="#section-1.3-3.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-3.9">
            <p id="section-1.3-3.9.1"><strong>Service:</strong> A protocol or system that employs DomainAuth signatures for a specific use case. Each service defines the context in which a signature is valid, and its own rules for signature creation and verification.<a href="#section-1.3-3.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="protocol-overview">
<section id="section-2">
      <h2 id="name-protocol-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<div id="architecture">
<section id="section-2.1">
        <h3 id="name-architecture">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-architecture" class="section-name selfRef">Architecture</a>
        </h3>
<p id="section-2.1-1">DomainAuth is built on three foundational layers:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.1-2">
<li id="section-2.1-2.1">
            <p id="section-2.1-2.1.1"><strong>DNS and DNSSEC Layer:</strong><a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1.2.1">
                <p id="section-2.1-2.1.2.1.1">Provides the domain name hierarchy and DNSSEC-based verification of domain ownership.<a href="#section-2.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.1.2.2">
                <p id="section-2.1-2.1.2.2.1">The DNSSEC chain connects the DNS root of trust to the organisation's domain, enabling offline validation without prior key distribution.<a href="#section-2.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.1.2.3">
                <p id="section-2.1-2.1.2.3.1">The DomainAuth TXT record bridges DNSSEC and PKI by publishing the organisation's public key information in a standardised, discoverable way.<a href="#section-2.1-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-2.1-2.2">
            <p id="section-2.1-2.2.1"><strong>PKI Layer:</strong><a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.2.2.1">
                <p id="section-2.1-2.2.2.1.1">Establishes a per-organisation PKI where each organisation issues certificates to its members.<a href="#section-2.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.2.2.2">
                <p id="section-2.1-2.2.2.2.1">The Organisation certificate functions as the domain-specific trust anchor that binds the organisation's public key to its domain name.<a href="#section-2.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.2.2.3">
                <p id="section-2.1-2.2.2.3.1">Member certificates extend the organisation's trust to specific members, containing identity information that enables them to produce signatures.<a href="#section-2.1-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-2.1-2.3">
            <p id="section-2.1-2.3.1"><strong>Signature Layer:</strong><a href="#section-2.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.3.2.1">
                <p id="section-2.1-2.3.2.1.1">Enables members to produce digital signatures on behalf of their organisation.<a href="#section-2.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.3.2.2">
                <p id="section-2.1-2.3.2.2.1">Signature bundles package digital signatures with all verification material, enabling offline validation.<a href="#section-2.1-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-2.1-3">These layers interact differently depending on the signature type:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-4.1">
            <p id="section-2.1-4.1.1">In <strong>member signatures</strong>, the chain of trust flows from the DNSSEC chain to the organisation certificate, then to the member certificate, and finally to the signature, providing end-to-end cryptographic proof of authorship.<a href="#section-2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-4.2">
            <p id="section-2.1-4.2.1">In <strong>organisation signatures</strong>, the chain of trust flows from the DNSSEC chain directly to the organisation certificate and then to the signature, with member attribution provided as a claim rather than a cryptographic proof.<a href="#section-2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-5">Furthermore, Member Id Bundles are a key architectural component that packages the complete chain of trust (DNSSEC chain, organisation certificate, and member certificate) into a single message, enabling members to produce verifiable signatures offline.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="workflow-summary">
<section id="section-2.2">
        <h3 id="name-workflow-summary">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-workflow-summary" class="section-name selfRef">Workflow Summary</a>
        </h3>
<p id="section-2.2-1">The DomainAuth protocol involves the following key workflows:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<div id="organisation-setup">
<section id="section-2.2.1">
          <h4 id="name-organisation-setup">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-organisation-setup" class="section-name selfRef">Organisation Setup</a>
          </h4>
<p id="section-2.2.1-1">First, the organisation must have DNSSEC properly configured for its domain.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2">Then, the organisation must generate an asymmetric key pair and publish its public key information in a DomainAuth TXT record at <code>_domainauth.&lt;domain&gt;</code> as described in <a href="#txt-record" class="auto internal xref">Section 3.2</a>.<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1-3">Multiple such records are allowed, which can be useful for key rotation or binding different keys to different services.<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certificate-issuance">
<section id="section-2.2.2">
          <h4 id="name-certificate-issuance">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-certificate-issuance" class="section-name selfRef">Certificate Issuance</a>
          </h4>
<p id="section-2.2.2-1">The organisation must issue an X.509 certificate using its private key, or reuse an existing certificate valid during the intended validity period.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2-2">When issuing a member certificate, the organisation must distribute it along with the organisation certificate. This can be done with a member id bundle as defined in <a href="#member-id-bundle" class="auto internal xref">Section 5</a>, which is desirable in services meant to be used offline as it also contains the DNSSEC chain.<a href="#section-2.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-bundle-production">
<section id="section-2.2.3">
          <h4 id="name-signature-bundle-production">
<a href="#section-2.2.3" class="section-number selfRef">2.2.3. </a><a href="#name-signature-bundle-production" class="section-name selfRef">Signature Bundle Production</a>
          </h4>
<p id="section-2.2.3-1">A member would produce a signature bundle as follows:<a href="#section-2.2.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2.3-2">
<li id="section-2.2.3-2.1">
              <p id="section-2.2.3-2.1.1">Use their private key to produce a CMS SignedData structure, encapsulating the member's certificate.<a href="#section-2.2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.3-2.2">
              <p id="section-2.2.3-2.2.1">Obtain the DNSSEC chain from the DomainAuth TXT record. If not provided by the organisation (e.g. in the form of a member id bundle), the member will have to resolve it or retrieve it from a cache.<a href="#section-2.2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.3-2.3">
              <p id="section-2.2.3-2.3.1">Construct a signature bundle with the CMS SignedData structure, the organisation certificate, and the DNSSEC chain.<a href="#section-2.2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-2.2.3-3">Similarly, an organisation would produce a signature bundle as follows:<a href="#section-2.2.3-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2.3-4">
<li id="section-2.2.3-4.1">
              <p id="section-2.2.3-4.1.1">Use its private key to produce a CMS SignedData structure, without encapsulating the organisation's certificate.<a href="#section-2.2.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.3-4.2">
              <p id="section-2.2.3-4.2.1">Resolve the DNSSEC chain from the DomainAuth TXT record, or use a cached chain valid during the intended validity period.<a href="#section-2.2.3-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.3-4.3">
              <p id="section-2.2.3-4.3.1">Construct a signature bundle with the CMS SignedData structure, the organisation certificate, and the DNSSEC chain.<a href="#section-2.2.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="signature-bundle-verification">
<section id="section-2.2.4">
          <h4 id="name-signature-bundle-verificati">
<a href="#section-2.2.4" class="section-number selfRef">2.2.4. </a><a href="#name-signature-bundle-verificati" class="section-name selfRef">Signature Bundle Verification</a>
          </h4>
<p id="section-2.2.4-1">The verification process involves validating the entire chain of trust as follows:<a href="#section-2.2.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2.4-2">
<li id="section-2.2.4-2.1">
              <p id="section-2.2.4-2.1.1">Verify the DNSSEC chain.<a href="#section-2.2.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.4-2.2">
              <p id="section-2.2.4-2.2.1">Verify the organisation certificate using the public key from the TXT record.<a href="#section-2.2.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.4-2.3">
              <p id="section-2.2.4-2.3.1">Determine the certificate of the signer of the CMS SignedData structure. If it is an organisation signature, use the organisation certificate. Otherwise, use the certificate of the member, which is encapsulated in the CMS SignedData structure.<a href="#section-2.2.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.4-2.4">
              <p id="section-2.2.4-2.4.1">Verify the CMS SignedData structure against the certificate of the signer.<a href="#section-2.2.4-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.4-2.5">
              <p id="section-2.2.4-2.5.1">Verify that the signature is valid for the intended service and time period.<a href="#section-2.2.4-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-2.2.4-3">Alternatively, the verifier can start with the digital signature, then verify the organisation certificate and finally the DNSSEC chain.<a href="#section-2.2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.2.4-4">For more detailed information on the verification process, particularly regarding validity periods, see <a href="#verification-process" class="auto internal xref">Section 7.1</a>.<a href="#section-2.2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="trust-model">
<section id="section-2.3">
        <h3 id="name-trust-model">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-trust-model" class="section-name selfRef">Trust Model</a>
        </h3>
<p id="section-2.3-1">DomainAuth's trust model differs significantly from traditional PKIs such as the one used for TLS:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-2">
<li id="section-2.3-2.1">
            <p id="section-2.3-2.1.1"><strong>Domain-specific trust roots:</strong> Each organisation is only able to issue certificates for itself and its members. Unlike traditional PKIs where any Certificate Authority can issue certificates for any domain, DomainAuth enforces a strict hierarchy where domain control is the only path to certificate issuance.<a href="#section-2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.3-2.2">
            <p id="section-2.3-2.2.1"><strong>DNSSEC as the foundation:</strong> Trust is anchored in DNSSEC, relying on the hierarchical nature of DNS to establish domain control. The chain of trust begins with the DNS root zone and extends through each DNS subdelegation to the organisation's domain.<a href="#section-2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.3-2.3">
            <p id="section-2.3-2.3.1"><strong>Self-contained verification:</strong> Signature bundles include all necessary information (DNSSEC chains, certificates) to allow completely offline verification.<a href="#section-2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.3-2.4">
            <p id="section-2.3-2.4.1"><strong>Short-lived credentials:</strong> DomainAuth favours short-lived credentials over revocation mechanisms, reducing complexity and vulnerability to disconnected operation. However, what constitutes "short-lived" will be entirely dependent on the nature of the service.<a href="#section-2.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.3-2.5">
            <p id="section-2.3-2.5.1"><strong>Two signature types with different trust models:</strong><a href="#section-2.3-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.5.2.1">
                <p id="section-2.3-2.5.2.1.1"><strong>Member signatures:</strong> Produced by members using their private keys, these signatures cryptographically prove that a specific member created the content. The verification chain goes from DNSSEC to the organisation certificate to the member certificate to the signature.<a href="#section-2.3-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.3-2.5.2.2">
                <p id="section-2.3-2.5.2.2.1"><strong>Organisation signatures:</strong> Produced directly by organisations using their private keys, these signatures prove that the organisation vouches for the content. When including user attribution, the organisation claims (but does not cryptographically prove) that a specific user created the content.<a href="#section-2.3-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-2.3-3">By relying on DNSSEC, DomainAuth inherits its security properties and limitations. The protocol's trust is ultimately rooted in the DNS hierarchy, including the root zone and TLD operators.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dns-integration">
<section id="section-3">
      <h2 id="name-dns-integration">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-dns-integration" class="section-name selfRef">DNS Integration</a>
      </h2>
<p id="section-3-1">This document makes no distinction between different types of DNS zones, with the exception of the root zone which <span class="bcp14">MUST NOT</span> participate in DomainAuth. The root zone exclusion avoids representation challenges in user interfaces (where it would appear as a dot or empty string) and eliminates the need for implementations to handle this special case.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">TLDs, apex domains, and subdomains are all treated equivalently. Any domain at any level in the DNS hierarchy, except the root zone, <span class="bcp14">MAY</span> implement DomainAuth. Each participating domain operates entirely independently from its parent zones, with no hierarchical relationship or inherited trust.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Throughout this document, the terms "domain" and "domain name" refer to any such zone without regard to its hierarchical position.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="dnssec-configuration">
<section id="section-3.1">
        <h3 id="name-dnssec-configuration">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-dnssec-configuration" class="section-name selfRef">DNSSEC Configuration</a>
        </h3>
<p id="section-3.1-1">Participating domains <span class="bcp14">MUST</span> have a complete DNSSEC chain of trust from the root zone to the DomainAuth TXT record.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Newly registered domains <span class="bcp14">SHOULD</span> wait at least the maximum validity period in <a href="#maximum-validity-period" class="auto internal xref">Section 9</a> before enabling DomainAuth to prevent potential attacks using DNSSEC chains from previous domain owners.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="txt-record">
<section id="section-3.2">
        <h3 id="name-txt-record">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-txt-record" class="section-name selfRef">TXT Record</a>
        </h3>
<p id="section-3.2-1">Each organisation participating in the DomainAuth protocol <span class="bcp14">MUST</span> publish a TXT record at <code>_domainauth.&lt;domain&gt;</code> with the following fields separated by simple spaces:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-2">
<li id="section-3.2-2.1">
            <p id="section-3.2-2.1.1"><strong>Version</strong> (required): An integer denoting the version of the DomainAuth TXT record format, set to <code>0</code> (zero) for this version of the specification.<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.2">
            <p id="section-3.2-2.2.1"><strong>Key Algorithm</strong> (required): An integer denoting the key algorithm:<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.2.2.1">
                <p id="section-3.2-2.2.2.1.1"><code>1</code>: RSA-PSS with modulus 2048 bits.<a href="#section-3.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2-2.2.2.2">
                <p id="section-3.2-2.2.2.2.1"><code>2</code>: RSA-PSS with modulus 3072 bits.<a href="#section-3.2-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2-2.2.2.3">
                <p id="section-3.2-2.2.2.3.1"><code>3</code>: RSA-PSS with modulus 4096 bits.<a href="#section-3.2-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2-2.2.3">
More details on the RSA-PSS algorithm can be found in <a href="#digital-signature-algorithms" class="auto internal xref">Section 8.1</a>.<a href="#section-3.2-2.2.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.3">
            <p id="section-3.2-2.3.1"><strong>Key Id Type</strong> (required): An integer denoting how the key is identified:<a href="#section-3.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.3.2.1">
                <p id="section-3.2-2.3.2.1.1"><code>1</code>: The key id is the SHA-256 digest of the key.<a href="#section-3.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2-2.3.2.2">
                <p id="section-3.2-2.3.2.2.1"><code>2</code>: The key id is the SHA-384 digest of the key.<a href="#section-3.2-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2-2.3.2.3">
                <p id="section-3.2-2.3.2.3.1"><code>3</code>: The key id is the SHA-512 digest of the key.<a href="#section-3.2-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2-2.3.3">
More details on hash functions can be found in <a href="#hash-functions" class="auto internal xref">Section 8.2</a>.<a href="#section-3.2-2.3.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.4">
            <p id="section-3.2-2.4.1"><strong>Key Id</strong> (required): The Base64-encoded (unpadded) representation of the key digest, as specified by the Key Id Type.<a href="#section-3.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.5">
            <p id="section-3.2-2.5.1"><strong>TTL Override</strong> (required): A positive integer representing the number of seconds for the maximum validity period of signatures. This value <span class="bcp14">MUST</span> be at least 1 second and not exceed the limit specified in <a href="#maximum-validity-period" class="auto internal xref">Section 9</a>. Refer to <a href="#ttl-override" class="auto internal xref">Section 3.3</a> for more details.<a href="#section-3.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.6">
            <p id="section-3.2-2.6.1"><strong>Service OID</strong> (optional): An Object Identifier (in dotted decimal notation) binding the key to a specific service. If omitted, the key is valid for any service.<a href="#section-3.2-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.2-3">Multiple TXT records <span class="bcp14">MAY</span> be published at the same zone to support different keys, key algorithms, or services.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Verifiers <span class="bcp14">MUST</span> select the appropriate TXT record based on the key information and service OID in the signature being verified.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">For example, the following TXT record specifies an RSA-2048 key identified by its SHA-512 digest with a TTL override of 24 hours (86400 seconds) and no service binding:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-6">
<pre>
_domainauth.example.com. IN TXT "0 1 3 dGhpcyBpcyBub3QgYSByZWFsIGtleSBkaWdlc3Q 86400"
</pre><a href="#section-3.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ttl-override">
<section id="section-3.3">
        <h3 id="name-ttl-override">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-ttl-override" class="section-name selfRef">TTL Override</a>
        </h3>
<p id="section-3.3-1">The TTL override field in the DomainAuth TXT record enables verification of DNS records and DNSSEC signatures for longer periods than their respective specifications would allow, which is essential for delay-tolerant use cases where users may be offline for extended periods.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">DNS records and DNSSEC signatures typically have TTL values that may be as short as a few minutes or hours. The TTL override mechanism allows the DNSSEC chain to remain verifiable for a significantly longer period, regardless of the TTL in such records. Refer to <a href="#maximum-validity-period" class="auto internal xref">Section 9</a> for the maximum validity period.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">During verification, the TTL override creates a restricted time window that extends backwards from the end of the requested verification period by the specified number of seconds. Verification will succeed if the DNSSEC records were valid at any point during this window, even if the standard DNS TTLs would have expired.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">For example, if a DNS record has a standard TTL of 3600 seconds (1 hour) but the DomainAuth TXT record specifies a TTL override of 604,800 seconds (7 days), a signature can still be verified up to 7 days after creation, even when offline. If a verifier attempts to verify a signature 5 days after it was created, the verification would succeed with the TTL override, whereas it would fail with only the standard 1-hour TTL.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dnssec-chain-serialisation">
<section id="section-3.4">
        <h3 id="name-dnssec-chain-serialisation">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-dnssec-chain-serialisation" class="section-name selfRef">DNSSEC Chain Serialisation</a>
        </h3>
<p id="section-3.4-1">The serialised chain <span class="bcp14">MUST</span> be encoded as the ASN.1 <code>DnssecChain</code> structure below, where each <code>OCTET STRING</code> contains a complete DNS message as defined in <span>[<a href="#DNS" class="cite xref">DNS</a>]</span>:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-2">
<pre>
DnssecChain ::= SET OF OCTET STRING
</pre><a href="#section-3.4-2" class="pilcrow">¶</a>
</div>
<p id="section-3.4-3">This chain <span class="bcp14">MUST</span> include all DNSSEC responses necessary to validate the <code>_domainauth.&lt;domain&gt;/TXT</code> record from the trust anchor. However, the root zone DS records <span class="bcp14">SHOULD</span> be omitted, since they will be ignored by verifiers as described in <a href="#verification-process" class="auto internal xref">Section 7.1</a>.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">Implementations <span class="bcp14">SHOULD</span> optimise the serialisation to minimise redundancy and size whilst ensuring completeness for offline verification.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="x509-certificate-profile">
<section id="section-4">
      <h2 id="name-x509-certificate-profile">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-x509-certificate-profile" class="section-name selfRef">X.509 Certificate Profile</a>
      </h2>
<p id="section-4-1">All X.509 certificates <span class="bcp14">MUST</span> comply with <span>[<a href="#X.509" class="cite xref">X.509</a>]</span>. Additionally, each certificate <span class="bcp14">MUST</span>:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">Have a validity period of at least 1 second and not exceeding the limit specified in <a href="#maximum-validity-period" class="auto internal xref">Section 9</a>.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">Only use the algorithms specified in <a href="#cryptographic-algorithms" class="auto internal xref">Section 8</a>.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.3">
          <p id="section-4-2.3.1">Contain the following extensions marked as critical:<a href="#section-4-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.3.2.1">
              <p id="section-4-2.3.2.1.1">Authority Key Identifier from <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.1" class="relref">Section 4.2.1.1</a> of [<a href="#X.509" class="cite xref">X.509</a>]</span>.<a href="#section-4-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4-2.3.2.2">
              <p id="section-4-2.3.2.2.1">Subject Key Identifier from <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.2" class="relref">Section 4.2.1.2</a> of [<a href="#X.509" class="cite xref">X.509</a>]</span>.<a href="#section-4-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
<p id="section-4-3">Additional requirements and recommendations apply to specific certificate types as described in the following sections.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div id="organisation-certificate">
<section id="section-4.1">
        <h3 id="name-organisation-certificate">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-organisation-certificate" class="section-name selfRef">Organisation Certificate</a>
        </h3>
<p id="section-4.1-1">This is certificate whose subject key is referenced by the DomainAuth TXT record. The following requirements and recommendations apply:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">Its Subject Distinguished Name <span class="bcp14">MUST</span> contain the Common Name attribute (OID <code>2.5.4.3</code>) set to the organisation's domain name with a trailing dot (e.g. <code>example.com.</code>).<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">When the certificate is used to issue other certificates, the Basic Constraints extension from <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.9" class="relref">Section 4.2.1.9</a> of [<a href="#X.509" class="cite xref">X.509</a>]</span> <span class="bcp14">MUST</span> be present and marked as critical. Additionally, the CA flag <span class="bcp14">MUST</span> be enabled, and the Path Length Constraint <span class="bcp14">SHOULD</span> be set to the lowest possible value for the length of the intended certificate chains.<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">When the certificate is used directly to sign CMS SignedData structures, the Basic Constraints extension <span class="bcp14">MAY</span> be absent. If present, it <span class="bcp14">SHOULD</span> have the CA flag disabled.<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="member-certificate">
<section id="section-4.2">
        <h3 id="name-member-certificate">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-member-certificate" class="section-name selfRef">Member Certificate</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-4.2-1.1">
            <p id="section-4.2-1.1.1">Its Subject Distinguished Name <span class="bcp14">MUST</span> contain the Common Name attribute (OID <code>2.5.4.3</code>) set to the member's name in the case of users or the at sign (<code>@</code>) in the case of bots.<a href="#section-4.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-1.2">
            <p id="section-4.2-1.2.1">The Basic Constraints extension from <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.9" class="relref">Section 4.2.1.9</a> of [<a href="#X.509" class="cite xref">X.509</a>]</span> <span class="bcp14">MAY</span> be absent. If present, it <span class="bcp14">SHOULD</span> have the CA flag disabled.<a href="#section-4.2-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="intermediate-certificate">
<section id="section-4.3">
        <h3 id="name-intermediate-certificate">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-intermediate-certificate" class="section-name selfRef">Intermediate Certificate</a>
        </h3>
<p id="section-4.3-1">Organisations <span class="bcp14">MAY</span> issue intermediate certificates to delegate the responsibility of signing member certificates to other entities.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">When an intermediate certificate is used, the Basic Constraints extension from <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.9" class="relref">Section 4.2.1.9</a> of [<a href="#X.509" class="cite xref">X.509</a>]</span> <span class="bcp14">MUST</span> be present and marked as critical. Additionally, the CA flag <span class="bcp14">MUST</span> be enabled, and the Path Length Constraint <span class="bcp14">SHOULD</span> be set to the lowest possible value for the length of the intended certificate chains.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">Note that if an intermediate certificate is assigned a Common Name, it could also be used as a member certificate and it could therefore produce member signatures.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="member-id-bundle">
<section id="section-5">
      <h2 id="name-member-id-bundle">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-member-id-bundle" class="section-name selfRef">Member Id Bundle</a>
      </h2>
<p id="section-5-1">The Member Id Bundle is a self-contained message that provides all the information needed for a member to produce verifiable signatures. It is serialised using ASN.1 with the following structure:<a href="#section-5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-2">
<pre>
MemberIdBundle ::= SEQUENCE {
    version                  [0] INTEGER,
    dnssecChain              [1] DnssecChain,
    organisationCertificate  [2] Certificate,
    memberCertificate        [3] Certificate,
    intermediateCertificates [4] SET OF Certificate OPTIONAL
}
</pre><a href="#section-5-2" class="pilcrow">¶</a>
</div>
<p id="section-5-3">Where:<a href="#section-5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1">
          <p id="section-5-4.1.1"><code>version</code> is the format version, set to <code>0</code> (zero) in this version of the specification.<a href="#section-5-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-4.2">
          <p id="section-5-4.2.1"><code>dnssecChain</code> contains the serialised DNSSEC chain proving the authenticity of the organisation's DomainAuth TXT record.<a href="#section-5-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-4.3">
          <p id="section-5-4.3.1"><code>organisationCertificate</code> is the organisation's X.509 certificate.<a href="#section-5-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-4.4">
          <p id="section-5-4.4.1"><code>memberCertificate</code> is the X.509 certificate issued to the member by the organisation.<a href="#section-5-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-4.5">
          <p id="section-5-4.5.1"><code>intermediateCertificates</code> is a set of X.509 certificates issued by the organisation to other entities that can sign member certificates. It <span class="bcp14">SHOULD NOT</span> include certificates extraneous to the chain between the organisation certificate and the member certificate.<a href="#section-5-4.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-5">The Member Id Bundle links the member to their organisation and provides all the cryptographic material needed to verify this relationship. It serves as a precursor to signature production and is typically distributed to members by their organisation's certificate management system.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">Member Id Bundles are not inherently confidential, as they contain only public information, but their integrity is critical for secure signature production.<a href="#section-5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cms-signeddata-structure">
<section id="section-6">
      <h2 id="name-cms-signeddata-structure">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-cms-signeddata-structure" class="section-name selfRef">CMS SignedData Structure</a>
      </h2>
<p id="section-6-1">DomainAuth signatures use CMS SignedData structures as defined in <span><a href="https://rfc-editor.org/rfc/rfc5652#section-5" class="relref">Section 5</a> of [<a href="#CMS" class="cite xref">CMS</a>]</span>, with additional requirements and recommendations:<a href="#section-6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1">
          <p id="section-6-2.1.1"><code>signerInfos</code> field:<a href="#section-6-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1.2.1">
              <p id="section-6-2.1.2.1.1">There <span class="bcp14">MUST</span> be exactly one <code>SignerInfo</code>.<a href="#section-6-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6-2.1.2.2">
              <p id="section-6-2.1.2.2.1">The digest and signature algorithms <span class="bcp14">MUST</span> comply with <a href="#cryptographic-algorithms" class="auto internal xref">Section 8</a>.<a href="#section-6-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6-2.1.2.3">
              <p id="section-6-2.1.2.3.1">The following signed attributes <span class="bcp14">MUST</span> be included:<a href="#section-6-2.1.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1.2.3.2.1">
                  <p id="section-6-2.1.2.3.2.1.1">Content Type attribute as defined in <span><a href="https://rfc-editor.org/rfc/rfc5652#section-11.1" class="relref">Section 11.1</a> of [<a href="#CMS" class="cite xref">CMS</a>]</span>.<a href="#section-6-2.1.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6-2.1.2.3.2.2">
                  <p id="section-6-2.1.2.3.2.2.1">Message Digest attribute as defined in <span><a href="https://rfc-editor.org/rfc/rfc5652#section-11.2" class="relref">Section 11.2</a> of [<a href="#CMS" class="cite xref">CMS</a>]</span>.<a href="#section-6-2.1.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6-2.1.2.3.2.3">
                  <p id="section-6-2.1.2.3.2.3.1">DomainAuth signature metadata attribute as defined in <a href="#signature-metadata" class="auto internal xref">Section 6.2</a>.<a href="#section-6-2.1.2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</li>
        <li class="normal" id="section-6-2.2">
          <p id="section-6-2.2.1"><code>certificates</code> field:<a href="#section-6-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.2.2.1">
              <p id="section-6-2.2.2.1.1">Any intermediate certificates between the organisation and the signer <span class="bcp14">MUST</span> be included.<a href="#section-6-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6-2.2.2.2">
              <p id="section-6-2.2.2.2.1">The organisation certificate <span class="bcp14">SHOULD NOT</span> be included, since it is already included in the Signature Bundle.<a href="#section-6-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6-2.2.2.3">
              <p id="section-6-2.2.2.3.1">Certificates outside the certification path between the organisation and the signer <span class="bcp14">SHOULD NOT</span> be included.<a href="#section-6-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
<div id="signature-types">
<section id="section-6.1">
        <h3 id="name-signature-types">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-signature-types" class="section-name selfRef">Signature Types</a>
        </h3>
<p id="section-6.1-1">DomainAuth supports two distinct types of signatures, offering different levels of assurance and operational flexibility:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div id="member-signatures">
<section id="section-6.1.1">
          <h4 id="name-member-signatures">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-member-signatures" class="section-name selfRef">Member Signatures</a>
          </h4>
<p id="section-6.1.1-1">Member signatures are produced by members (users or bots) using their own private key. They are suitable for scenarios requiring strong non-repudiation at the individual member level, or when members need to produce signatures whilst being offline for extended periods.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">The member's certificate <span class="bcp14">MUST</span> be included in the <code>SignedData.certificates</code> field.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="organisation-signatures">
<section id="section-6.1.2">
          <h4 id="name-organisation-signatures">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-organisation-signatures" class="section-name selfRef">Organisation Signatures</a>
          </h4>
<p id="section-6.1.2-1">Organisation signatures are produced using either the organisation's private key or a delegated signing key. All organisation signatures include mandatory member attribution to indicate content authorship. These signatures are suitable for scenarios where individual member certificate management is impractical or when the organisation takes direct responsibility for content.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">The SignerInfo structure <span class="bcp14">MUST</span> include the DomainAuth member attribution in its signed attributes, using the OID <code>1.3.6.1.4.1.58708.1.2</code> and the value defined in the ASN.1 structure below:<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.2-3">
<pre>
MemberAttribution ::= UTF8String
</pre><a href="#section-6.1.2-3" class="pilcrow">¶</a>
</div>
<p id="section-6.1.2-4">The member attribution value <span class="bcp14">MUST</span> conform to the naming conventions defined in <a href="#naming-conventions-and-restrictions" class="auto internal xref">Section 10</a>. For users, this is the username; for bots, this is the at sign (<code>@</code>).<a href="#section-6.1.2-4" class="pilcrow">¶</a></p>
<p id="section-6.1.2-5">Member attribution is a claim made by the organisation, not cryptographically proven by the member. Verifiers <span class="bcp14">SHOULD</span> present this distinction clearly to end users.<a href="#section-6.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="signature-metadata">
<section id="section-6.2">
        <h3 id="name-signature-metadata">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-signature-metadata" class="section-name selfRef">Signature Metadata</a>
        </h3>
<p id="section-6.2-1">Each SignedData structure includes metadata that binds the signature to a specific service and validity period. This metadata is included as a signed attribute in the SignerInfo structure.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The signature metadata attribute <span class="bcp14">MUST</span> use the OID <code>1.3.6.1.4.1.58708.1.0</code> and be encoded as the <code>SignatureMetadata</code> ASN.1 structure below:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-3">
<pre>
SignatureMetadata ::= SEQUENCE {
    serviceOid      [0] OBJECT IDENTIFIER,
    validityPeriod  [1] DatePeriod
}

DatePeriod ::= SEQUENCE {
    start  [0] GeneralizedTime,
    end    [1] GeneralizedTime
}
</pre><a href="#section-6.2-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2-4">Where:<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-5.1">
            <p id="section-6.2-5.1.1"><code>serviceOid</code> is the Object Identifier of the service for which the signature is valid.<a href="#section-6.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-5.2">
            <p id="section-6.2-5.2.1"><code>validityPeriod</code> specifies the time period during which the signature is considered valid. The <code>start</code> and <code>end</code> fields <span class="bcp14">MUST</span> be expressed in Greenwich Mean Time (GMT) and <span class="bcp14">MUST</span> include seconds. Therefore, both times will follow the format <code>YYYYMMDDHHMMSSZ</code>. Both the start and end times are inclusive, meaning the signature is valid at exactly the start time and remains valid until exactly the end time.<a href="#section-6.2-5.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="signature-bundle">
<section id="section-7">
      <h2 id="name-signature-bundle">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-signature-bundle" class="section-name selfRef">Signature Bundle</a>
      </h2>
<p id="section-7-1">The Signature Bundle is the primary artefact of the DomainAuth protocol, containing a digital signature and all the information needed to verify it offline. It is serialised using ASN.1 with the following structure:<a href="#section-7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7-2">
<pre>
SignatureBundle ::= SEQUENCE {
    version                  [0] INTEGER,
    dnssecChain              [1] DnssecChain,
    organisationCertificate  [2] Certificate,
    signature                [3] ContentInfo
}
</pre><a href="#section-7-2" class="pilcrow">¶</a>
</div>
<p id="section-7-3">Where:<a href="#section-7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.1">
          <p id="section-7-4.1.1"><code>version</code> is the format version, set to <code>0</code> (zero) in this version of the specification.<a href="#section-7-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.2">
          <p id="section-7-4.2.1"><code>dnssecChain</code> contains the serialised DNSSEC chain proving the authenticity of the organisation's DomainAuth TXT record.<a href="#section-7-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.3">
          <p id="section-7-4.3.1"><code>organisationCertificate</code> is the organisation's X.509 certificate.<a href="#section-7-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.4">
          <p id="section-7-4.4.1"><code>signature</code> is a CMS <code>ContentInfo</code> containing the SignedData structure.<a href="#section-7-4.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-5">The specific contents of the <code>signature</code> field depend on whether it is a member signature or an organisation signature, as detailed in <a href="#cms-signeddata-structure" class="auto internal xref">Section 6</a>.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">For detached signatures, the plaintext <span class="bcp14">MUST</span> be provided separately during verification.<a href="#section-7-6" class="pilcrow">¶</a></p>
<div id="verification-process">
<section id="section-7.1">
        <h3 id="name-verification-process">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-verification-process" class="section-name selfRef">Verification Process</a>
        </h3>
<p id="section-7.1-1">The verification of a signature bundle involves multiple steps that validate the entire chain of trust from the DNSSEC infrastructure to the signature itself. Implementations <span class="bcp14">MUST</span> perform the following verification steps:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.1-2">
<li id="section-7.1-2.1">
            <p id="section-7.1-2.1.1"><strong>Establish the required validity period:</strong><a href="#section-7.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.1.2.1">
                <p id="section-7.1-2.1.2.1.1">The verification process involves tracking the intersection of the required validity period and the validity period of all the components of the signature bundle (i.e. DNSSEC <code>RRSIG</code> records, X.509 certificates, and the digital signature).<a href="#section-7.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.1.2.2">
                <p id="section-7.1-2.1.2.2.1">The required validity period can be a specific time (e.g. the current time), or a time range where the signature bundle needs to be valid for at least some moment within that range.<a href="#section-7.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.1.2.3">
                <p id="section-7.1-2.1.2.3.1">Even a brief one-second overlap between the bundle's validity period and the required period is sufficient.<a href="#section-7.1-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.1.2.4">
                <p id="section-7.1-2.1.2.4.1">Service requirements heavily influence this; for example, an offline service might accept a bundle valid at any point in the past 30 days, whilst an online service might require validity at verification time.<a href="#section-7.1-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.1.2.5">
                <p id="section-7.1-2.1.2.5.1">If there is no intersection between the required period and the validity periods of all components, the signature bundle is invalid.<a href="#section-7.1-2.1.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-7.1-2.2">
            <p id="section-7.1-2.2.1"><strong>Parse the Signature Bundle:</strong><a href="#section-7.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.2.2.1">
                <p id="section-7.1-2.2.2.1.1">Extract the DNSSEC chain, organisation certificate, and CMS signature.<a href="#section-7.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.2.2.2">
                <p id="section-7.1-2.2.2.2.1">Validate the structure of each component.<a href="#section-7.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-7.1-2.3">
            <p id="section-7.1-2.3.1"><strong>Validate the DNSSEC chain:</strong><a href="#section-7.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.3.2.1">
                <p id="section-7.1-2.3.2.1.1">Verify that the chain starts from a trusted DNSSEC anchor.<a href="#section-7.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.3.2.2">
                <p id="section-7.1-2.3.2.2.1">The root zone DS records <span class="bcp14">MUST</span> be provided by the verifier. Any root zone DS records included in the DNSSEC chain <span class="bcp14">MUST</span> be ignored.<a href="#section-7.1-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.3.2.3">
                <p id="section-7.1-2.3.2.3.1">Verify all DNSSEC signatures in the chain.<a href="#section-7.1-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.3.2.4">
                <p id="section-7.1-2.3.2.4.1">Confirm that the chain leads to the <code>_domainauth.&lt;domain&gt;</code> TXT record.<a href="#section-7.1-2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.3.2.5">
                <p id="section-7.1-2.3.2.5.1">Extract the organisation's public key information from the TXT record.<a href="#section-7.1-2.3.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-7.1-2.4">
            <p id="section-7.1-2.4.1"><strong>Validate the organisation certificate:</strong><a href="#section-7.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.4.2.1">
                <p id="section-7.1-2.4.2.1.1">Verify that the certificate's public key matches the key identified in the TXT record.<a href="#section-7.1-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.4.2.2">
                <p id="section-7.1-2.4.2.2.1">Verify that the certificate's CommonName matches the domain name.<a href="#section-7.1-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.4.2.3">
                <p id="section-7.1-2.4.2.3.1">Confirm that the certificate is self-signed and valid.<a href="#section-7.1-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.4.2.4">
                <p id="section-7.1-2.4.2.4.1">Check that the certificate has the CA flag set in the Basic Constraints extension.<a href="#section-7.1-2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-7.1-2.5">
            <p id="section-7.1-2.5.1"><strong>Determine the signature type:</strong><a href="#section-7.1-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.5.2.1">
                <p id="section-7.1-2.5.2.1.1">Extract the signed attributes from the CMS SignedData structure.<a href="#section-7.1-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.5.2.2">
                <p id="section-7.1-2.5.2.2.1">Check for the presence of the member attribution attribute (<code>1.3.6.1.4.1.58708.1.2</code>).<a href="#section-7.1-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.5.2.3">
                <p id="section-7.1-2.5.2.3.1">If the member attribution attribute is present, it is an organisation signature.<a href="#section-7.1-2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.5.2.4">
                <p id="section-7.1-2.5.2.4.1">If the member attribution attribute is absent, it is a member signature.<a href="#section-7.1-2.5.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-7.1-2.6">
            <p id="section-7.1-2.6.1"><strong>Extract and validate certificates:</strong><a href="#section-7.1-2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.6.2.1">
                <p id="section-7.1-2.6.2.1.1">Extract the organisation certificate from the signature bundle.<a href="#section-7.1-2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.6.2.2">
                <p id="section-7.1-2.6.2.2.1">Extract the signer's certificate from the CMS SignedData structure if present.<a href="#section-7.1-2.6.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.6.2.2.2.1">
                    <p id="section-7.1-2.6.2.2.2.1.1">For member signatures, the signer's certificate <span class="bcp14">MUST</span> be present.<a href="#section-7.1-2.6.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-7.1-2.6.2.2.2.2">
                    <p id="section-7.1-2.6.2.2.2.2.1">For organisation signatures, the signer's certificate <span class="bcp14">MAY</span> be present if it differs from the organisation certificate.<a href="#section-7.1-2.6.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-7.1-2.6.2.3">
                <p id="section-7.1-2.6.2.3.1">Construct and validate the certification path:<a href="#section-7.1-2.6.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.6.2.3.2.1">
                    <p id="section-7.1-2.6.2.3.2.1.1">The path starts with the organisation certificate from the signature bundle.<a href="#section-7.1-2.6.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-7.1-2.6.2.3.2.2">
                    <p id="section-7.1-2.6.2.3.2.2.1">The path ends with the signer's certificate (which may be the organisation certificate itself for organisation signatures).<a href="#section-7.1-2.6.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-7.1-2.6.2.3.2.3">
                    <p id="section-7.1-2.6.2.3.2.3.1">Any intermediate certificates in the SignedData structure <span class="bcp14">MUST</span> be included in the path.<a href="#section-7.1-2.6.2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-7.1-2.6.2.4">
                <p id="section-7.1-2.6.2.4.1">Verify that all certificates in the path are valid at the verification time.<a href="#section-7.1-2.6.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-7.1-2.7">
            <p id="section-7.1-2.7.1"><strong>Validate the signature metadata:</strong><a href="#section-7.1-2.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.7.2.1">
                <p id="section-7.1-2.7.2.1.1">Extract the service OID and validity period from the signature metadata attribute.<a href="#section-7.1-2.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.7.2.2">
                <p id="section-7.1-2.7.2.2.1">Verify that the service OID matches the expected service.<a href="#section-7.1-2.7.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.7.2.3">
                <p id="section-7.1-2.7.2.3.1">Confirm that the verification time falls within the signature validity period.<a href="#section-7.1-2.7.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-7.1-2.8">
            <p id="section-7.1-2.8.1"><strong>Determine the overall validity period:</strong><a href="#section-7.1-2.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.8.2.1">
                <p id="section-7.1-2.8.2.1.1">Calculate the intersection of:<a href="#section-7.1-2.8.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.8.2.1.2.1">
                    <p id="section-7.1-2.8.2.1.2.1.1">The validity periods of all certificates in the certification path, from the organisation certificate to the signer's certificate (if different).<a href="#section-7.1-2.8.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-7.1-2.8.2.1.2.2">
                    <p id="section-7.1-2.8.2.1.2.2.1">The signature metadata validity period.<a href="#section-7.1-2.8.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-7.1-2.8.2.1.2.3">
                    <p id="section-7.1-2.8.2.1.2.3.1">The DNSSEC chain validity period, applying the TTL override from <a href="#ttl-override" class="auto internal xref">Section 3.3</a>.<a href="#section-7.1-2.8.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-7.1-2.8.2.2">
                <p id="section-7.1-2.8.2.2.1">Verifiers <span class="bcp14">MAY</span> enforce a TTL shorter than that required by the service, but not shorter than the 1-second minimum.<a href="#section-7.1-2.8.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.8.2.3">
                <p id="section-7.1-2.8.2.3.1">Verifiers <span class="bcp14">MAY</span> allow their end users to specify a shorter TTL (but still not shorter than 1 second) than the one in the TXT record.<a href="#section-7.1-2.8.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.8.2.4">
                <p id="section-7.1-2.8.2.4.1">Verify that the verification time falls within this intersection.<a href="#section-7.1-2.8.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-7.1-2.9">
            <p id="section-7.1-2.9.1"><strong>Verify the digital signature:</strong><a href="#section-7.1-2.9.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.9.2.1">
                <p id="section-7.1-2.9.2.1.1">Use the signer's public key to verify the signature over the content.<a href="#section-7.1-2.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.9.2.2">
                <p id="section-7.1-2.9.2.2.1">For detached signatures, use the externally provided content.<a href="#section-7.1-2.9.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.9.2.3">
                <p id="section-7.1-2.9.2.3.1">For encapsulated signatures, extract the content from the CMS structure.<a href="#section-7.1-2.9.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-7.1-2.10">
            <p id="section-7.1-2.10.1"><strong>Produce verification output:</strong><a href="#section-7.1-2.10.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.10.2.1">
                <p id="section-7.1-2.10.2.1.1">Always include the organisation name.<a href="#section-7.1-2.10.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-2.10.2.2">
                <p id="section-7.1-2.10.2.2.1">Include the member name (for users only, not for bots):<a href="#section-7.1-2.10.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.10.2.2.2.1">
                    <p id="section-7.1-2.10.2.2.2.1.1">For member signatures, from the signer certificate.<a href="#section-7.1-2.10.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-7.1-2.10.2.2.2.2">
                    <p id="section-7.1-2.10.2.2.2.2.1">For organisation signatures, from the member attribution.<a href="#section-7.1-2.10.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-7.1-2.10.2.3">
                <p id="section-7.1-2.10.2.3.1">Always include the signature type (member or organisation).<a href="#section-7.1-2.10.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-7.1-3">If all these steps succeed, the signature is considered valid, and the content is confirmed to originate from the identified member of the specified organisation or from the organisation itself.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">The verification process <span class="bcp14">MUST</span> be performed in full, without skipping any steps, to ensure the security properties of the DomainAuth protocol.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cryptographic-algorithms">
<section id="section-8">
      <h2 id="name-cryptographic-algorithms">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-cryptographic-algorithms" class="section-name selfRef">Cryptographic Algorithms</a>
      </h2>
<p id="section-8-1">This section describes the cryptographic algorithms used in the DomainAuth protocol. It applies to the X.509 certificates and CMS SignedData structures, but not to the DNSSEC chain.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="digital-signature-algorithms">
<section id="section-8.1">
        <h3 id="name-digital-signature-algorithm">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-digital-signature-algorithm" class="section-name selfRef">Digital Signature Algorithms</a>
        </h3>
<div id="rsa-pss">
<section id="section-8.1.1">
          <h4 id="name-rsa-pss">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-rsa-pss" class="section-name selfRef">RSA-PSS</a>
          </h4>
<p id="section-8.1.1-1">DomainAuth uses RSA-PSS (Probabilistic Signature Scheme) as the digital signature algorithm with the following parameters:<a href="#section-8.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.1-2.1">
              <p id="section-8.1.1-2.1.1">RSA-PSS with modulus 2048 bits: Minimum acceptable security level.<a href="#section-8.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.1.1-2.2">
              <p id="section-8.1.1-2.2.1">RSA-PSS with modulus 3072 bits: Recommended for general use.<a href="#section-8.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.1.1-2.3">
              <p id="section-8.1.1-2.3.1">RSA-PSS with modulus 4096 bits: Recommended for high-security applications.<a href="#section-8.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.1.1-3">For RSA-PSS signatures:<a href="#section-8.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.1-4.1">
              <p id="section-8.1.1-4.1.1">RSA-2048 <span class="bcp14">MUST</span> use SHA-256 for both key identification and signature operations.<a href="#section-8.1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.1.1-4.2">
              <p id="section-8.1.1-4.2.1">RSA-3072 <span class="bcp14">MUST</span> use SHA-384 for both key identification and signature operations.<a href="#section-8.1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.1.1-4.3">
              <p id="section-8.1.1-4.3.1">RSA-4096 <span class="bcp14">MUST</span> use SHA-512 for both key identification and signature operations.<a href="#section-8.1.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.1.1-5">The minimum modulus size for RSA keys is 2048 bits. RSA key generation <span class="bcp14">MUST</span> follow industry best practices for prime generation and testing and <span class="bcp14">MUST</span> use a cryptographically secure random number generator.<a href="#section-8.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="hash-functions">
<section id="section-8.2">
        <h3 id="name-hash-functions">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-hash-functions" class="section-name selfRef">Hash Functions</a>
        </h3>
<p id="section-8.2-1">DomainAuth uses the following hash functions:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.1">
            <p id="section-8.2-2.1.1">SHA-256: Recommended for general use.<a href="#section-8.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-2.2">
            <p id="section-8.2-2.2.1">SHA-384: Recommended for higher security applications.<a href="#section-8.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-2.3">
            <p id="section-8.2-2.3.1">SHA-512: Recommended for highest security applications.<a href="#section-8.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.2-3">All compliant implementations <span class="bcp14">MUST</span> support these algorithms. The choice of algorithm strength should be appropriate for the security requirements of the application.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">Future versions of the protocol <span class="bcp14">MAY</span> introduce additional algorithms, but this V1 specification intentionally limits the supported algorithms to those with well-established security properties and widespread implementation support.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="maximum-validity-period">
<section id="section-9">
      <h2 id="name-maximum-validity-period">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-maximum-validity-period" class="section-name selfRef">Maximum Validity Period</a>
      </h2>
<p id="section-9-1">Digital signatures <span class="bcp14">MUST NOT</span> have a validity period greater than 7,776,000 seconds (90 days). This limit applies to DNSSEC RRSIG records, X.509 certificates, and CMS SignedData structures (including the signature metadata).<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Similarly, verifiers <span class="bcp14">MUST NOT</span> allow a validity period greater than this limit when verifying signatures over a time period.<a href="#section-9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="naming-conventions-and-restrictions">
<section id="section-10">
      <h2 id="name-naming-conventions-and-rest">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-naming-conventions-and-rest" class="section-name selfRef">Naming Conventions and Restrictions</a>
      </h2>
<p id="section-10-1">DomainAuth imposes specific restrictions on member names to prevent phishing attacks and ensure consistent processing across implementations:<a href="#section-10-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10-2">
<li id="section-10-2.1">
          <p id="section-10-2.1.1"><strong>User Names:</strong>
  - <span class="bcp14">MUST NOT</span> contain at signs (<code>@</code>).
  - <span class="bcp14">MUST NOT</span> contain whitespace characters other than simple spaces (e.g., no tabs, newlines, carriage returns).
  - <span class="bcp14">SHOULD</span> be chosen to avoid visual confusion with other usernames.
  - <span class="bcp14">SHOULD</span> use consistent case and normalisation forms.<a href="#section-10-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-10-2.2">
          <p id="section-10-2.2.1"><strong>Display Considerations:</strong>
  - User interfaces <span class="bcp14">SHOULD NOT</span> truncate usernames or domain names.
  - Implementations <span class="bcp14">SHOULD</span> display member identifiers in full to avoid confusion.
  - Implementations <span class="bcp14">SHOULD</span> highlight or visually distinguish the domain portion of identifiers.<a href="#section-10-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-10-2.3">
          <p id="section-10-2.3.1"><strong>Homographic Attack Prevention:</strong>
  - Implementations <span class="bcp14">SHOULD</span> implement mitigations against homographic attacks.
  - Domain names <span class="bcp14">SHOULD</span> be displayed using Punycode when they contain non-ASCII characters.
  - Implementations <span class="bcp14">MAY</span> refuse to process signatures from domains with mixed scripts.<a href="#section-10-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-10-2.4">
          <p id="section-10-2.4.1"><strong>Bot Names:</strong>
  - <span class="bcp14">MUST</span> use the at sign (<code>@</code>) as the CommonName in certificates.
  - When displaying bot identities, implementations <span class="bcp14">SHOULD</span> clearly indicate they represent the organisation rather than an individual.<a href="#section-10-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-10-3">Organisations <span class="bcp14">SHOULD</span> establish and enforce consistent naming policies for their users to maintain clarity and prevent confusion.<a href="#section-10-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="services">
<section id="section-11">
      <h2 id="name-services">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-services" class="section-name selfRef">Services</a>
      </h2>
<div id="service-oids">
<section id="section-11.1">
        <h3 id="name-service-oids">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-service-oids" class="section-name selfRef">Service OIDs</a>
        </h3>
<p id="section-11.1-1">DomainAuth uses Object Identifiers (OIDs) to uniquely identify services and applications that use the protocol. Service OIDs serve as namespaces that prevent signature reuse across different contexts.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11.1-2">
<li id="section-11.1-2.1">
            <p id="section-11.1-2.1.1"><strong>OID Structure:</strong>
  - The DomainAuth root OID is <code>1.3.6.1.4.1.58708.1</code>.
  - Official service OIDs <span class="bcp14">MUST</span> be allocated under this root.
  - For example, the test service OID is <code>1.3.6.1.4.1.58708.1.1</code>.<a href="#section-11.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.1-2.2">
            <p id="section-11.1-2.2.1"><strong>OID Allocation:</strong>
  - Service designers <span class="bcp14">MUST</span> obtain a unique OID for their service.
  - Third-party services <span class="bcp14">MUST</span> use OIDs from their own namespace.
  - The DomainAuth OID arc is reserved exclusively for official services under the DomainAuth project umbrella.<a href="#section-11.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.1-2.3">
            <p id="section-11.1-2.3.1"><strong>OID Usage:</strong>
  - The service OID <span class="bcp14">MUST</span> be included in the signature metadata.
  - Verifiers <span class="bcp14">MUST</span> check that the OID in the signature matches the expected service.
  - DomainAuth TXT records <span class="bcp14">MAY</span> specify a service OID to restrict key usage.<a href="#section-11.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.1-2.4">
            <p id="section-11.1-2.4.1"><strong>Versioning:</strong>
  - Service designers <span class="bcp14">SHOULD</span> include version information in their OID structure.
  - Major protocol changes <span class="bcp14">SHOULD</span> use a new OID.
  - Minor, backward-compatible changes <span class="bcp14">MAY</span> use the same OID.<a href="#section-11.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-11.1-3">Service OIDs ensure that signatures created for one service cannot be repurposed for another, even if all other aspects of the signature are valid. This provides important namespace isolation and prevents cross-service attacks.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="service-specific-validation-rules">
<section id="section-11.2">
        <h3 id="name-service-specific-validation">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-service-specific-validation" class="section-name selfRef">Service-Specific Validation Rules</a>
        </h3>
<p id="section-11.2-1">Services using DomainAuth <span class="bcp14">MAY</span> define additional validation rules beyond the core protocol requirements. These rules allow services to implement domain-specific security policies.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11.2-2">
<li id="section-11.2-2.1">
            <p id="section-11.2-2.1.1"><strong>TTL Constraints:</strong>
  - Services <span class="bcp14">MUST</span> specify a maximum TTL for signatures.
  - The TTL <span class="bcp14">MUST</span> be within the range of 1 second to the limit specified in <a href="#maximum-validity-period" class="auto internal xref">Section 9</a>.
  - For the minimum TTL, several minutes is recommended to account for clock drift.
  - Services <span class="bcp14">SHOULD</span> choose the shortest TTL that meets their requirements.<a href="#section-11.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.2-2.2">
            <p id="section-11.2-2.2.1"><strong>Content Type Restrictions:</strong>
  - Services <span class="bcp14">MAY</span> restrict the types of content that can be signed.
  - Content type restrictions <span class="bcp14">SHOULD</span> be documented in the service specification.
  - Verifiers <span class="bcp14">SHOULD</span> check content type compliance during verification.<a href="#section-11.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.2-2.3">
            <p id="section-11.2-2.3.1"><strong>Member Type Restrictions:</strong>
  - Services <span class="bcp14">MAY</span> restrict which member types can produce valid signatures.
  - For example, a service might only accept signatures from users (not bots).
  - Such restrictions <span class="bcp14">SHOULD</span> be enforced during verification.<a href="#section-11.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.2-2.4">
            <p id="section-11.2-2.4.1"><strong>Certificate Extensions:</strong>
  - Services <span class="bcp14">MAY</span> define custom certificate extensions for additional authorisation.
  - Such extensions <span class="bcp14">SHOULD</span> be clearly documented.
  - Verifiers <span class="bcp14">MUST</span> check for and validate any required extensions.<a href="#section-11.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-11.2-3">Service designers <span class="bcp14">SHOULD</span> document their validation rules comprehensively to ensure consistent implementation across different verifiers. These rules <span class="bcp14">SHOULD</span> be designed to maintain the security properties of the DomainAuth protocol while addressing service-specific requirements.<a href="#section-11.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-guidelines">
<section id="section-11.3">
        <h3 id="name-implementation-guidelines">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-implementation-guidelines" class="section-name selfRef">Implementation Guidelines</a>
        </h3>
<p id="section-11.3-1">Service developers integrating DomainAuth should adhere to the following guidelines to ensure secure and consistent implementation:<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11.3-2">
<li id="section-11.3-2.1">
            <p id="section-11.3-2.1.1"><strong>User Interface Considerations:</strong>
  - Clearly display the full member identifier (username and domain).
  - Visually distinguish between user and bot signatures.
  - Indicate when signatures are expired or otherwise invalid.
  - Avoid truncating or eliding parts of member identifiers.<a href="#section-11.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.3-2.2">
            <p id="section-11.3-2.2.1"><strong>Error Handling:</strong>
  - Provide clear, actionable error messages for verification failures.
  - Distinguish between different types of validation errors.
  - Log detailed information about verification failures for debugging.
  - Never fall back to less secure verification methods on failure.<a href="#section-11.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.3-2.3">
            <p id="section-11.3-2.3.1"><strong>Integration Patterns:</strong>
  - Separate signature verification from application logic.
  - Implement verification as a self-contained module or library.
  - Use dependency injection to allow for testing and component replacement.
  - Consider signature verification as a security boundary in the application.<a href="#section-11.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.3-2.4">
            <p id="section-11.3-2.4.1"><strong>Performance Optimisations:</strong>
  - Cache verification results when appropriate (respecting validity periods).
  - Implement efficient ASN.1 parsing routines.
  - Consider performance implications of cryptographic operations.
  - Balance security requirements with resource constraints.<a href="#section-11.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.3-2.5">
            <p id="section-11.3-2.5.1"><strong>Testing:</strong>
  - Test with a variety of valid and invalid signatures.
  - Include edge cases in test scenarios.
  - Verify correct handling of expired certificates.
  - Test with different key sizes and algorithms.
  - Ensure verification fails as expected with tampered data.<a href="#section-11.3-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-11.3-3">These guidelines help ensure that DomainAuth integrations provide consistent security properties and user experience across different implementations and platforms.<a href="#section-11.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="data-serialisation">
<section id="section-11.4">
        <h3 id="name-data-serialisation">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-data-serialisation" class="section-name selfRef">Data Serialisation</a>
        </h3>
<p id="section-11.4-1">All data structures in the DomainAuth protocol are defined using Abstract Syntax Notation One (ASN.1), as referenced in <span>[<a href="#ASN.1" class="cite xref">ASN.1</a>]</span>.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
<p id="section-11.4-2">Implementations <span class="bcp14">MUST</span> support Distinguished Encoding Rules (DER) as defined in <span>[<a href="#ASN.1" class="cite xref">ASN.1</a>]</span> for storage and transmission.<a href="#section-11.4-2" class="pilcrow">¶</a></p>
<p id="section-11.4-3">Services <span class="bcp14">MAY</span> require or support additional ASN.1 encoding rules. In such cases, service implementations <span class="bcp14">MUST</span> handle the conversion between DER and the alternative encoding rules.<a href="#section-11.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-status">
<section id="section-12">
      <h2 id="name-implementation-status">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-12-1">This section records the status of known implementations of the protocol defined by this specification at the time of posting of this Internet-Draft, and is based on a proposal described in <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>. The description of implementations in this section is intended to assist the IETF in its decision processes in progressing drafts to RFCs. Please note that the listing of any individual implementation here does not imply endorsement by the IETF. Furthermore, no effort has been spent to verify the information presented here that was supplied by IETF contributors. This is not intended as, and must not be construed to be, a catalog of available implementations or their features. Readers are advised to note that other implementations may exist.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">According to <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>, "this will allow reviewers and working groups to assign due consideration to documents that have the benefit of running code, which may serve as evidence of valuable experimentation and feedback that have made the implemented protocols more mature. It is up to the individual working groups to use this information as they see fit".<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3"><em>Note to RFC Editor: Please remove this section before publication.</em><a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4">DomainAuth is the successor to the VeraId protocol as defined in <span>[<a href="#VERAID" class="cite xref">VERAID</a>]</span>, which has fully-interoperable implementations as described below. DomainAuth and VeraId are functionally identical, except for the following differences:<a href="#section-12-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12-5.1">
          <p id="section-12-5.1.1">DNS TXT record:<a href="#section-12-5.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12-5.1.2.1">
              <p id="section-12-5.1.2.1.1">Name: DomainAuth uses <code>_domainauth.example.com.</code>, whilst VeraId uses <code>_veraid.example.com.</code>.<a href="#section-12-5.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12-5.1.2.2">
              <p id="section-12-5.1.2.2.1">Value: DomainAuth requires the value to begin with the number <code>0</code>, denoting the version of the DomainAuth TXT record format, followed by a space. This value does not have a version number in VeraId.<a href="#section-12-5.1.2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-12-5.2">
          <p id="section-12-5.2.1">VeraId does not explicitly support intermediate certificates, and its implementations do not support them. Consequently, the <code>intermediateCertificates</code> field in the Member Id Bundle is not present in VeraId.<a href="#section-12-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-5.3">
          <p id="section-12-5.3.1">VeraId only allows ASN.1 DER serialisation.<a href="#section-12-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-12-6">VeraId is led by the author of this document, who intends to deprecate the VeraId specification in favour of DomainAuth and update the reference implementations to fully comply with this specification.<a href="#section-12-6" class="pilcrow">¶</a></p>
<p id="section-12-7">All implementations listed below are undergoing independent security audits as of this writing, and their respective reports are expected to be published in April 2025.<a href="#section-12-7" class="pilcrow">¶</a></p>
<div id="veraid-javascript-library">
<section id="section-12.1">
        <h3 id="name-veraid-javascript-library">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-veraid-javascript-library" class="section-name selfRef">VeraId JavaScript Library</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-12.1-1.1">
            <p id="section-12.1-1.1.1">Organisation: Relaycorp.<a href="#section-12.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.2">
            <p id="section-12.1-1.2.1">URL: https://github.com/relaycorp/veraid-js<a href="#section-12.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.3">
            <p id="section-12.1-1.3.1">Level of maturity: Used in production in the VeraId Authority application (see below).<a href="#section-12.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.4">
            <p id="section-12.1-1.4.1">Coverage: The implementation covers the entire protocol as defined in <span>[<a href="#VERAID" class="cite xref">VERAID</a>]</span>.<a href="#section-12.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.5">
            <p id="section-12.1-1.5.1">Licensing: Freely distributable with acknowledgement (MIT licence).<a href="#section-12.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.6">
            <p id="section-12.1-1.6.1">Contact: https://relaycorp.tech/<a href="#section-12.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-1.7">
            <p id="section-12.1-1.7.1">Last updated: 2025<a href="#section-12.1-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="veraid-jvm-library">
<section id="section-12.2">
        <h3 id="name-veraid-jvm-library">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-veraid-jvm-library" class="section-name selfRef">VeraId JVM Library</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-12.2-1.1">
            <p id="section-12.2-1.1.1">Organisation: Relaycorp.<a href="#section-12.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-1.2">
            <p id="section-12.2-1.2.1">URL: https://github.com/relaycorp/veraid-jvm<a href="#section-12.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-1.3">
            <p id="section-12.2-1.3.1">Level of maturity: Used in the Android version of Letro as described in <a href="#letro" class="auto internal xref">Section 12.4</a>.<a href="#section-12.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-1.4">
            <p id="section-12.2-1.4.1">Coverage: The implementation covers the entire protocol as defined in <span>[<a href="#VERAID" class="cite xref">VERAID</a>]</span>, except for Organisation Signature Bundles.<a href="#section-12.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-1.5">
            <p id="section-12.2-1.5.1">Licensing: Freely distributable with acknowledgement (Apache 2.0 licence).<a href="#section-12.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-1.6">
            <p id="section-12.2-1.6.1">Contact: https://relaycorp.tech/<a href="#section-12.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-1.7">
            <p id="section-12.2-1.7.1">Last updated: 2025<a href="#section-12.2-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="veraid-authority">
<section id="section-12.3">
        <h3 id="name-veraid-authority">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-veraid-authority" class="section-name selfRef">VeraId Authority</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-12.3-1.1">
            <p id="section-12.3-1.1.1">Organisation: Relaycorp<a href="#section-12.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-1.2">
            <p id="section-12.3-1.2.1">URL: https://github.com/relaycorp/veraid-authority<a href="#section-12.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-1.3">
            <p id="section-12.3-1.3.1">Description: A multi-tenant, cloud-native application that allows organisations to manage their members and the issuance of their respective Member Id Bundles.<a href="#section-12.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-1.4">
            <p id="section-12.3-1.4.1">Level of maturity: Used in production in the server-side component of Letro as described in <a href="#letro" class="auto internal xref">Section 12.4</a>.<a href="#section-12.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-1.5">
            <p id="section-12.3-1.5.1">Coverage: The implementation leverages the VeraId JavaScript Library to issue Member Id Bundles and Organisation Signature Bundles.<a href="#section-12.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-1.6">
            <p id="section-12.3-1.6.1">Licensing: Business Source License version 1.1<a href="#section-12.3-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-1.7">
            <p id="section-12.3-1.7.1">Contact: https://relaycorp.tech/<a href="#section-12.3-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-1.8">
            <p id="section-12.3-1.8.1">Last updated: 2025<a href="#section-12.3-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="letro">
<section id="section-12.4">
        <h3 id="name-letro">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-letro" class="section-name selfRef">Letro</a>
        </h3>
<p id="section-12.4-1"><span>[<a href="#LETRO" class="cite xref">LETRO</a>]</span> is the only VeraId service as of this writing.<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.4-2.1">
            <p id="section-12.4-2.1.1">Organisation: Relaycorp<a href="#section-12.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.4-2.2">
            <p id="section-12.4-2.2.1">URLs:<a href="#section-12.4-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.4-2.2.2.1">
                <p id="section-12.4-2.2.2.1.1">https://github.com/relaycorp/letro-android<a href="#section-12.4-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.4-2.2.2.2">
                <p id="section-12.4-2.2.2.2.1">https://docs.relaycorp.tech/letro-server/<a href="#section-12.4-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-12.4-2.3">
            <p id="section-12.4-2.3.1">Level of maturity: Experimental.<a href="#section-12.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.4-2.4">
            <p id="section-12.4-2.4.1">Coverage: The implementation exercises the entire protocol as defined in <span>[<a href="#VERAID" class="cite xref">VERAID</a>]</span>, except for organisation signatures and bot members. It uses the VeraId JVM Library to issue member signatures on Android, and the VeraId Authority to issue Member Id Bundles under a variety of domain names operated by Relaycorp (e.g. <code>applepie.rocks</code>, <code>cuppa.fans</code>).<a href="#section-12.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.4-2.5">
            <p id="section-12.4-2.5.1">Licensing: Freely distributable with acknowledgement (GNU GPLv3 and Apache 2.0 licences).<a href="#section-12.4-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.4-2.6">
            <p id="section-12.4-2.6.1">Contact: https://relaycorp.tech/<a href="#section-12.4-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.4-2.7">
            <p id="section-12.4-2.7.1">Last updated: 2024<a href="#section-12.4-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-13">
      <h2 id="name-security-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="dnssec-dependency">
<section id="section-13.1">
        <h3 id="name-dnssec-dependency">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-dnssec-dependency" class="section-name selfRef">DNSSEC Dependency</a>
        </h3>
<p id="section-13.1-1">DomainAuth's security model relies fundamentally on DNSSEC, which introduces specific security considerations:<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-13.1-2">
<li id="section-13.1-2.1">
            <p id="section-13.1-2.1.1"><strong>Trust Anchors:</strong><a href="#section-13.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.1-2.1.2.1">
                <p id="section-13.1-2.1.2.1.1">The DomainAuth protocol inherits trust from the DNSSEC root zone.<a href="#section-13.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.1.2.2">
                <p id="section-13.1-2.1.2.2.1">Compromise of the root KSK would undermine the entire system.<a href="#section-13.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.1.2.3">
                <p id="section-13.1-2.1.2.3.1">Implementations <span class="bcp14">MUST</span> securely manage and update DNSSEC trust anchors.<a href="#section-13.1-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.1-2.2">
            <p id="section-13.1-2.2.1"><strong>TLD Control:</strong><a href="#section-13.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.1-2.2.2.1">
                <p id="section-13.1-2.2.2.1.1">Many TLDs are controlled by governments or private entities.<a href="#section-13.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.2.2.2">
                <p id="section-13.1-2.2.2.2.1">A malicious TLD operator could theoretically issue fraudulent DNSSEC responses.<a href="#section-13.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.2.2.3">
                <p id="section-13.1-2.2.2.3.1">Organisations <span class="bcp14">SHOULD</span> consider the governance of their TLD when assessing security.<a href="#section-13.1-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.1-2.3">
            <p id="section-13.1-2.3.1"><strong>DNSSEC Implementation Vulnerabilities:</strong><a href="#section-13.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.1-2.3.2.1">
                <p id="section-13.1-2.3.2.1.1">Flaws in DNSSEC implementations could affect DomainAuth security.<a href="#section-13.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.3.2.2">
                <p id="section-13.1-2.3.2.2.1">Implementations <span class="bcp14">SHOULD</span> use well-tested, actively maintained DNSSEC libraries.<a href="#section-13.1-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.3.2.3">
                <p id="section-13.1-2.3.2.3.1">Security updates for DNSSEC components <span class="bcp14">SHOULD</span> be promptly applied.<a href="#section-13.1-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.1-2.4">
            <p id="section-13.1-2.4.1"><strong>DNSSEC Adoption:</strong><a href="#section-13.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.1-2.4.2.1">
                <p id="section-13.1-2.4.2.1.1">Not all domains support DNSSEC, limiting DomainAuth adoption.<a href="#section-13.1-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.4.2.2">
                <p id="section-13.1-2.4.2.2.1">DNSSEC misconfiguration can lead to verification failures.<a href="#section-13.1-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.4.2.3">
                <p id="section-13.1-2.4.2.3.1">Organisations <span class="bcp14">MUST</span> properly maintain their DNSSEC configuration.<a href="#section-13.1-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.1-2.5">
            <p id="section-13.1-2.5.1"><strong>Key Rollovers:</strong><a href="#section-13.1-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.1-2.5.2.1">
                <p id="section-13.1-2.5.2.1.1">DNSSEC key rollovers at any level can temporarily affect verification.<a href="#section-13.1-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.5.2.2">
                <p id="section-13.1-2.5.2.2.1">Organisations <span class="bcp14">SHOULD</span> follow best practices for DNSSEC key management.<a href="#section-13.1-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.1-2.5.2.3">
                <p id="section-13.1-2.5.2.3.1">Implementations <span class="bcp14">SHOULD</span> handle temporary DNSSEC validation failures gracefully.<a href="#section-13.1-2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-13.1-3">Whilst these dependencies introduce potential vulnerabilities, the distributed nature of DNS provides significant security advantages compared to centralised PKI models, particularly for offline verification scenarios.<a href="#section-13.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="homographic-and-character-encoding-attacks">
<section id="section-13.2">
        <h3 id="name-homographic-and-character-e">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-homographic-and-character-e" class="section-name selfRef">Homographic and Character Encoding Attacks</a>
        </h3>
<p id="section-13.2-1">User-friendly identifiers like domain names and usernames are susceptible to visual spoofing attacks:<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-13.2-2">
<li id="section-13.2-2.1">
            <p id="section-13.2-2.1.1"><strong>Homographic Attacks:</strong><a href="#section-13.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.2-2.1.2.1">
                <p id="section-13.2-2.1.2.1.1">Different Unicode characters that appear visually similar can be used for spoofing.<a href="#section-13.2-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.2-2.1.2.2">
                <p id="section-13.2-2.1.2.2.1">For example, Cyrillic "о" (U+043E) looks similar to Latin "o" (U+006F).<a href="#section-13.2-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.2-2.1.2.3">
                <p id="section-13.2-2.1.2.3.1">Implementations <span class="bcp14">SHOULD</span> detect and warn about mixed-script identifiers.<a href="#section-13.2-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.2-2.1.2.4">
                <p id="section-13.2-2.1.2.4.1">User interfaces <span class="bcp14">SHOULD</span> display domain names in Punycode when they contain non-ASCII characters.<a href="#section-13.2-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.2-2.2">
            <p id="section-13.2-2.2.1"><strong>Normalisation Issues:</strong><a href="#section-13.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.2-2.2.2.1">
                <p id="section-13.2-2.2.2.1.1">Different Unicode normalisation forms can represent the same visual character.<a href="#section-13.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.2-2.2.2.2">
                <p id="section-13.2-2.2.2.2.1">Implementations <span class="bcp14">SHOULD</span> normalise identifiers before display or comparison.<a href="#section-13.2-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.2-2.2.2.3">
                <p id="section-13.2-2.2.2.3.1">The preferred normalisation form is NFC (Normalization Form C).<a href="#section-13.2-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.2-2.3">
            <p id="section-13.2-2.3.1"><strong>Bidirectional Text:</strong><a href="#section-13.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.2-2.3.2.1">
                <p id="section-13.2-2.3.2.1.1">Bidirectional text can be manipulated to hide or reorder parts of identifiers.<a href="#section-13.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.2-2.3.2.2">
                <p id="section-13.2-2.3.2.2.1">Implementations <span class="bcp14">SHOULD</span> apply the Unicode Bidirectional Algorithm correctly.<a href="#section-13.2-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.2-2.3.2.3">
                <p id="section-13.2-2.3.2.3.1">User interfaces <span class="bcp14">SHOULD</span> clearly indicate reading direction for identifiers.<a href="#section-13.2-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.2-2.4">
            <p id="section-13.2-2.4.1"><strong>Display Guidelines:</strong><a href="#section-13.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.2-2.4.2.1">
                <p id="section-13.2-2.4.2.1.1">User interfaces <span class="bcp14">MUST NOT</span> truncate usernames, domain names, or identifiers.<a href="#section-13.2-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.2-2.4.2.2">
                <p id="section-13.2-2.4.2.2.1">Identifiers <span class="bcp14">SHOULD</span> be displayed with a distinct font or style.<a href="#section-13.2-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.2-2.4.2.3">
                <p id="section-13.2-2.4.2.3.1">Domain and username portions <span class="bcp14">SHOULD</span> be visually differentiated.<a href="#section-13.2-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.2-2.4.2.4">
                <p id="section-13.2-2.4.2.4.1">Implementations <span class="bcp14">SHOULD</span> consider using visual security indicators.<a href="#section-13.2-2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-13.2-3">These attacks primarily affect human perception rather than cryptographic verification. Proper implementation of user interfaces is critical to help users correctly identify the source of signed content.<a href="#section-13.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="domain-ownership-changes">
<section id="section-13.3">
        <h3 id="name-domain-ownership-changes">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-domain-ownership-changes" class="section-name selfRef">Domain Ownership Changes</a>
        </h3>
<p id="section-13.3-1">Domain transfers present specific security challenges for the DomainAuth protocol:<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-13.3-2">
<li id="section-13.3-2.1">
            <p id="section-13.3-2.1.1"><strong>Waiting Period:</strong><a href="#section-13.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.3-2.1.2.1">
                <p id="section-13.3-2.1.2.1.1">Organisations <span class="bcp14">SHOULD</span> delay implementing DomainAuth until at least the period specified in <a href="#maximum-validity-period" class="auto internal xref">Section 9</a> has elapsed since the domain was registered or acquired.<a href="#section-13.3-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.3-2.1.2.2">
                <p id="section-13.3-2.1.2.2.1">This prevents the DNSSEC chain from the previous owner from remaining valid.<a href="#section-13.3-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.3-2.2">
            <p id="section-13.3-2.2.1"><strong>Signature Validity After Transfer:</strong><a href="#section-13.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.3-2.2.2.1">
                <p id="section-13.3-2.2.2.1.1">Signatures created before a domain transfer remain cryptographically valid.<a href="#section-13.3-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.3-2.2.2.2">
                <p id="section-13.3-2.2.2.2.1">Verifiers <span class="bcp14">MAY</span> implement additional checks for recent domain transfers.<a href="#section-13.3-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.3-2.2.2.3">
                <p id="section-13.3-2.2.2.3.1">Service policies <span class="bcp14">SHOULD</span> address the handling of signatures across ownership changes.<a href="#section-13.3-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.3-2.3">
            <p id="section-13.3-2.3.1"><strong>Domain Expiration:</strong><a href="#section-13.3-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.3-2.3.2.1">
                <p id="section-13.3-2.3.2.1.1">Expired domains can be registered by new owners.<a href="#section-13.3-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.3-2.3.2.2">
                <p id="section-13.3-2.3.2.2.1">Verifiers <span class="bcp14">SHOULD</span> consider domain registration date when processing signatures.<a href="#section-13.3-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.3-2.3.2.3">
                <p id="section-13.3-2.3.2.3.1">Signatures <span class="bcp14">SHOULD NOT</span> be trusted if the domain has changed hands since issuance.<a href="#section-13.3-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.3-2.4">
            <p id="section-13.3-2.4.1"><strong>Subdomain Delegation:</strong><a href="#section-13.3-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.3-2.4.2.1">
                <p id="section-13.3-2.4.2.1.1">Changes in subdomain delegation may affect DomainAuth verification.<a href="#section-13.3-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.3-2.4.2.2">
                <p id="section-13.3-2.4.2.2.1">Organisations <span class="bcp14">SHOULD</span> carefully manage subdomain delegation.<a href="#section-13.3-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.3-2.4.2.3">
                <p id="section-13.3-2.4.2.3.1">Signature verification considers the state of delegations at verification time.<a href="#section-13.3-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-13.3-3">Domain ownership changes represent a fundamental challenge to any domain-based authentication system. DomainAuth's approach of using short-lived certificates and signatures helps mitigate these risks by limiting the time window during which historical signatures remain valid.<a href="#section-13.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="offline-verification-limitations">
<section id="section-13.4">
        <h3 id="name-offline-verification-limita">
<a href="#section-13.4" class="section-number selfRef">13.4. </a><a href="#name-offline-verification-limita" class="section-name selfRef">Offline Verification Limitations</a>
        </h3>
<p id="section-13.4-1">Offline verification introduces specific security considerations:<a href="#section-13.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-13.4-2">
<li id="section-13.4-2.1">
            <p id="section-13.4-2.1.1"><strong>Time Synchronisation:</strong><a href="#section-13.4-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.4-2.1.2.1">
                <p id="section-13.4-2.1.2.1.1">Accurate verification requires correct system time.<a href="#section-13.4-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.4-2.1.2.2">
                <p id="section-13.4-2.1.2.2.1">Devices with incorrect clocks may incorrectly validate expired signatures.<a href="#section-13.4-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.4-2.1.2.3">
                <p id="section-13.4-2.1.2.3.1">Implementations <span class="bcp14">SHOULD</span> check for obviously incorrect system time.<a href="#section-13.4-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.4-2.1.2.4">
                <p id="section-13.4-2.1.2.4.1">Critical applications <span class="bcp14">SHOULD</span> use external time sources when available.<a href="#section-13.4-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.4-2.2">
            <p id="section-13.4-2.2.1"><strong>Replay Attacks:</strong><a href="#section-13.4-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.4-2.2.2.1">
                <p id="section-13.4-2.2.2.1.1">Valid signatures can be replayed beyond their intended context.<a href="#section-13.4-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.4-2.2.2.2">
                <p id="section-13.4-2.2.2.2.1">Services <span class="bcp14">SHOULD</span> implement additional measures (e.g., nonces) for replay-sensitive operations.<a href="#section-13.4-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.4-2.2.2.3">
                <p id="section-13.4-2.2.2.3.1">Signature metadata <span class="bcp14">SHOULD</span> include context-specific information when appropriate.<a href="#section-13.4-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.4-2.3">
            <p id="section-13.4-2.3.1"><strong>Revocation Limitations:</strong><a href="#section-13.4-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.4-2.3.2.1">
                <p id="section-13.4-2.3.2.1.1">Offline verification cannot check real-time revocation status.<a href="#section-13.4-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.4-2.3.2.2">
                <p id="section-13.4-2.3.2.2.1">The protocol relies on short validity periods rather than revocation checking.<a href="#section-13.4-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.4-2.3.2.3">
                <p id="section-13.4-2.3.2.3.1">In high-security contexts, verification <span class="bcp14">SHOULD</span> go online when possible to check current status.<a href="#section-13.4-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.4-2.4">
            <p id="section-13.4-2.4.1"><strong>Freshness Guarantees:</strong><a href="#section-13.4-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.4-2.4.2.1">
                <p id="section-13.4-2.4.2.1.1">Offline verification can only guarantee that a signature was valid at some point.<a href="#section-13.4-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.4-2.4.2.2">
                <p id="section-13.4-2.4.2.2.1">Applications requiring strong freshness guarantees <span class="bcp14">SHOULD</span> use additional mechanisms.<a href="#section-13.4-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.4-2.4.2.3">
                <p id="section-13.4-2.4.2.3.1">The signature validity period provides some time-bounding guarantees.<a href="#section-13.4-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.4-2.5">
            <p id="section-13.4-2.5.1"><strong>Network Partition Attacks:</strong><a href="#section-13.4-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.4-2.5.2.1">
                <p id="section-13.4-2.5.2.1.1">Adversaries may attempt to prevent devices from going online to check current status.<a href="#section-13.4-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.4-2.5.2.2">
                <p id="section-13.4-2.5.2.2.1">Applications <span class="bcp14">SHOULD</span> track and report extended offline periods.<a href="#section-13.4-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.4-2.5.2.3">
                <p id="section-13.4-2.5.2.3.1">Critical operations <span class="bcp14">MAY</span> require periodic online connectivity.<a href="#section-13.4-2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-13.4-3">These limitations are inherent to any offline verification system and reflect fundamental tradeoffs between availability and security. DomainAuth provides a balanced approach that offers strong verification guarantees whilst supporting offline operation.<a href="#section-13.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="organisation-signatures-and-member-attribution">
<section id="section-13.5">
        <h3 id="name-organisation-signatures-and">
<a href="#section-13.5" class="section-number selfRef">13.5. </a><a href="#name-organisation-signatures-and" class="section-name selfRef">Organisation Signatures and Member Attribution</a>
        </h3>
<p id="section-13.5-1">Organisation signatures with member attribution introduce specific security considerations that implementers and developers should be aware of:<a href="#section-13.5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-13.5-2">
<li id="section-13.5-2.1">
            <p id="section-13.5-2.1.1"><strong>Trust Model Shift:</strong><a href="#section-13.5-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.5-2.1.2.1">
                <p id="section-13.5-2.1.2.1.1">Member signatures provide cryptographic proof that a specific member created the content, with the member's private key directly signing the content.<a href="#section-13.5-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.5-2.1.2.2">
                <p id="section-13.5-2.1.2.2.1">Organisation signatures with member attribution provide only a claim by the organisation about which member authored the content, without cryptographic proof from the member.<a href="#section-13.5-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.5-2.1.2.3">
                <p id="section-13.5-2.1.2.3.1">This distinction represents a fundamental shift in the trust model from cryptographic verification to organisational attestation.<a href="#section-13.5-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.5-2.2">
            <p id="section-13.5-2.2.1"><strong>Potential for Misattribution:</strong><a href="#section-13.5-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.5-2.2.2.1">
                <p id="section-13.5-2.2.2.1.1">Organisations have the technical ability to attribute content to any member, whether or not that member actually created the content.<a href="#section-13.5-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.5-2.2.2.2">
                <p id="section-13.5-2.2.2.2.1">Malicious or compromised organisations could falsely attribute content to members who did not create it.<a href="#section-13.5-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.5-2.2.2.3">
                <p id="section-13.5-2.2.2.3.1">This risk is mitigated by the fact that the organisation must still sign the content with its private key, creating an auditable record of the attribution.<a href="#section-13.5-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.5-2.3">
            <p id="section-13.5-2.3.1"><strong>Accountability Considerations:</strong><a href="#section-13.5-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.5-2.3.2.1">
                <p id="section-13.5-2.3.2.1.1">Member signatures create direct cryptographic accountability for the member.<a href="#section-13.5-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.5-2.3.2.2">
                <p id="section-13.5-2.3.2.2.1">Organisation signatures shift accountability to the organisation, even when content is attributed to a specific member.<a href="#section-13.5-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.5-2.3.2.3">
                <p id="section-13.5-2.3.2.3.1">Legal and regulatory frameworks may treat these different types of signatures differently with respect to non-repudiation and liability.<a href="#section-13.5-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.5-2.4">
            <p id="section-13.5-2.4.1"><strong>Operational Security:</strong><a href="#section-13.5-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.5-2.4.2.1">
                <p id="section-13.5-2.4.2.1.1">Organisation signatures require access to the organisation's private key, which should be more tightly controlled than member private keys.<a href="#section-13.5-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.5-2.4.2.2">
                <p id="section-13.5-2.4.2.2.1">Organisations should implement strict access controls and audit mechanisms for the use of organisation signatures, particularly when attributing content to members.<a href="#section-13.5-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.5-2.4.2.3">
                <p id="section-13.5-2.4.2.3.1">The use of certification paths in organisation signatures introduces additional complexity and potential security vulnerabilities.<a href="#section-13.5-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-13.5-2.5">
            <p id="section-13.5-2.5.1"><strong>Verification Presentation:</strong><a href="#section-13.5-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.5-2.5.2.1">
                <p id="section-13.5-2.5.2.1.1">Verification interfaces <span class="bcp14">MUST</span> clearly distinguish between cryptographically proven member signatures and organisation signatures with member attribution.<a href="#section-13.5-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.5-2.5.2.2">
                <p id="section-13.5-2.5.2.2.1">End users of applications implementing DomainAuth may need to be informed about the different trust implications of these signature types.<a href="#section-13.5-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-13.5-2.5.2.3">
                <p id="section-13.5-2.5.2.3.1">Implementations <span class="bcp14">SHOULD</span> use distinct visual indicators or terminology to prevent confusion between the two signature types.<a href="#section-13.5-2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-13.5-3">To mitigate these risks, developers integrating DomainAuth <span class="bcp14">SHOULD</span>:<a href="#section-13.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.5-4.1">
            <p id="section-13.5-4.1.1">Prefer member signatures over organisation signatures when practical.<a href="#section-13.5-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.5-4.2">
            <p id="section-13.5-4.2.1">Limit the use of organisation signatures to specific use cases where certificate management for members is impractical.<a href="#section-13.5-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.5-4.3">
            <p id="section-13.5-4.3.1">Implement strong audit logging for all organisation signatures, especially those with member attribution.<a href="#section-13.5-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.5-4.4">
            <p id="section-13.5-4.4.1">Clearly communicate the distinction between signature types to end users.<a href="#section-13.5-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.5-4.5">
            <p id="section-13.5-4.5.1">Consider implementing additional verification steps for organisation signatures with member attribution in high-security contexts.<a href="#section-13.5-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="key-management">
<section id="section-13.6">
        <h3 id="name-key-management">
<a href="#section-13.6" class="section-number selfRef">13.6. </a><a href="#name-key-management" class="section-name selfRef">Key Management</a>
        </h3>
<p id="section-13.6-1">Proper key management is essential for the security of the DomainAuth protocol. The following requirements apply:<a href="#section-13.6-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-13.6-2">
<li id="section-13.6-2.1">
            <p id="section-13.6-2.1.1"><strong>Key Generation:</strong>
  - Keys <span class="bcp14">MUST</span> be generated using a cryptographically secure random number generator.
  - RSA key generation <span class="bcp14">MUST</span> follow industry best practices for prime generation and testing.
  - The minimum modulus size for RSA keys is 2048 bits.<a href="#section-13.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-13.6-2.2">
            <p id="section-13.6-2.2.1"><strong>Key Storage:</strong>
  - Private keys <span class="bcp14">MUST</span> be protected from unauthorised access.
  - Organisation private keys <span class="bcp14">SHOULD</span> be stored with the highest level of protection available, preferably in hardware security modules (HSMs).
  - Member private keys <span class="bcp14">SHOULD</span> be protected with appropriate measures, such as operating system security mechanisms or hardware tokens.<a href="#section-13.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-13.6-2.3">
            <p id="section-13.6-2.3.1"><strong>Key Rotation:</strong>
  - Organisations <span class="bcp14">SHOULD</span> establish a regular schedule for rotating their keys.
  - Key rotation <span class="bcp14">SHOULD</span> be performed by generating a new key pair and updating the DomainAuth TXT record.
  - During key rotation, organisations <span class="bcp14">SHOULD</span> maintain both the old and new keys in DNS for a transition period, allowing for graceful migration.
  - Member certificates issued under the old key remain valid until their expiration but <span class="bcp14">SHOULD</span> be renewed under the new key when practical.<a href="#section-13.6-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-13.6-2.4">
            <p id="section-13.6-2.4.1"><strong>Key Compromise:</strong>
  - In the event of a key compromise, immediate rotation is <span class="bcp14">REQUIRED</span>.
  - The compromised key's TXT record <span class="bcp14">SHOULD</span> be removed as soon as possible.
  - Short certificate lifetimes help mitigate the impact of key compromises.<a href="#section-13.6-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-13.6-3">Implementations <span class="bcp14">SHOULD</span> provide guidance and tools to assist with secure key management practices appropriate to the security requirements of the organisation.<a href="#section-13.6-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-14">
      <h2 id="name-iana-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-14-1">This document has no IANA actions.<a href="#section-14-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-15">
      <h2 id="name-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-15.1">
        <h3 id="name-normative-references">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="ASN.1">[ASN.1]</dt>
        <dd>
<span class="refAuthor">International Telecommunications Union</span>, <span class="refTitle">"Information Technology — ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ITU-T Recommendation X.690</span>, <time datetime="1994" class="refDate">1994</time>. </dd>
<dd class="break"></dd>
<dt id="CMS">[CMS]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5652">https://www.rfc-editor.org/rfc/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNS">[DNS]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1035">https://www.rfc-editor.org/rfc/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNSSEC">[DNSSEC]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refTitle">"DNS Security Extensions (DNSSEC)"</span>, <span class="seriesInfo">BCP 237</span>, <span class="seriesInfo">RFC 9364</span>, <span class="seriesInfo">DOI 10.17487/RFC9364</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9364">https://www.rfc-editor.org/rfc/rfc9364</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7942">[RFC7942]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7942">https://www.rfc-editor.org/rfc/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.509">[X.509]</dt>
      <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-15.2">
        <h3 id="name-informative-references">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AWALA">[AWALA]</dt>
        <dd>
<span class="refAuthor">Narea, G.</span>, <span class="refTitle">"Awala"</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://specs.awala.network/">https://specs.awala.network/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JWT">[JWT]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LETRO">[LETRO]</dt>
        <dd>
<span class="refAuthor">Narea, G.</span>, <span class="refTitle">"Letro"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://letro.app/en/">https://letro.app/en/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="VERAID">[VERAID]</dt>
      <dd>
<span class="refAuthor">Narea, G.</span>, <span class="refTitle">"VeraId V1 Specification"</span>, <time datetime="2025" class="refDate">2025</time>, <span>&lt;<a href="https://veraid.net/spec/">https://veraid.net/spec/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="asn1-schemas">
<section id="appendix-A">
      <h2 id="name-asn1-schemas">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-asn1-schemas" class="section-name selfRef">ASN.1 Schemas</a>
      </h2>
<p id="appendix-A-1">The following ASN.1 schemas define the data structures used in the DomainAuth protocol:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-2">
<pre>
-- Top-level schemas for DomainAuth components

-- DNSSEC chain is a set of DNS messages
DnssecChain ::= SET OF OCTET STRING

-- Member Id Bundle
MemberIdBundle ::= SEQUENCE {
    version                  [0] INTEGER,
    dnssecChain              [1] DnssecChain,
    organisationCertificate  [2] Certificate,
    memberCertificate        [3] Certificate
}

-- Signature Bundle
SignatureBundle ::= SEQUENCE {
    version                  [0] INTEGER,
    dnssecChain              [1] DnssecChain,
    organisationCertificate  [2] Certificate,
    signature                [3] ContentInfo
}

-- Signature metadata (included as a signed attribute)
SignatureMetadata ::= SEQUENCE {
    serviceOid      [0] OBJECT IDENTIFIER,
    validityPeriod  [1] DatePeriod
}

-- Date period structure
DatePeriod ::= SEQUENCE {
    start  [0] GeneralizedTime,
    end    [1] GeneralizedTime
}

-- Member attribution (included as a signed attribute in organisation signatures)
MemberAttribution ::= UTF8String
</pre><a href="#appendix-A-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A-3">All DomainAuth data structures <span class="bcp14">MUST</span> be encoded using ASN.1 as specified in <a href="#data-serialisation" class="auto internal xref">Section 11.4</a>.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">The ASN.1 structures reference standard types from other specifications:<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-5.1">
          <p id="appendix-A-5.1.1">Certificate is defined in X.509 (RFC 5280).<a href="#appendix-A-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.2">
          <p id="appendix-A-5.2.1">ContentInfo is defined in CMS (RFC 5652).<a href="#appendix-A-5.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-6">All implementations <span class="bcp14">MUST</span> strictly adhere to these schemas. Any deviation in structure or encoding may result in verification failures.<a href="#appendix-A-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oid-registry">
<section id="appendix-B">
      <h2 id="name-oid-registry">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-oid-registry" class="section-name selfRef">OID Registry</a>
      </h2>
<p id="appendix-B-1">The following Object Identifiers (OIDs) are defined for use in the DomainAuth protocol:<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-B-2">
<li id="appendix-B-2.1">
          <p id="appendix-B-2.1.1"><strong>DomainAuth Base OID:</strong><a href="#appendix-B-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.1.2.1">
              <p id="appendix-B-2.1.2.1.1"><code>1.3.6.1.4.1.58708.1</code> (iso.org.dod.internet.private.enterprise.relaycorp.domainauth).<a href="#appendix-B-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li id="appendix-B-2.2">
          <p id="appendix-B-2.2.1"><strong>Protocol OIDs:</strong><a href="#appendix-B-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.2.2.1">
              <p id="appendix-B-2.2.2.1.1"><code>1.3.6.1.4.1.58708.1.0</code>: Signature Metadata Attribute.<a href="#appendix-B-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.2.2.2">
              <p id="appendix-B-2.2.2.2.1"><code>1.3.6.1.4.1.58708.1.2</code>: Member Attribution Attribute.<a href="#appendix-B-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li id="appendix-B-2.3">
          <p id="appendix-B-2.3.1"><strong>Service OIDs:</strong><a href="#appendix-B-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.3.2.1">
              <p id="appendix-B-2.3.2.1.1"><code>1.3.6.1.4.1.58708.1.1</code>: Test Service.<a href="#appendix-B-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ol>
<p id="appendix-B-3">Third-party services implementing DomainAuth <span class="bcp14">MUST</span> register and use their own OIDs under their own arcs. The DomainAuth OID arc (<code>1.3.6.1.4.1.58708.1</code>) is reserved exclusively for official services and protocol components under the DomainAuth project umbrella.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<p id="appendix-B-4">OID registration procedures:<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-B-5">
<li id="appendix-B-5.1">
          <p id="appendix-B-5.1.1">OIDs under the DomainAuth base OID are managed by the DomainAuth maintainers and reserved for official DomainAuth project purposes.<a href="#appendix-B-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="appendix-B-5.2">
          <p id="appendix-B-5.2.1">Third parties <span class="bcp14">MUST NOT</span> use OIDs under the DomainAuth arc for their services.<a href="#appendix-B-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="appendix-B-5.3">
          <p id="appendix-B-5.3.1">Third parties without their own OID arc <span class="bcp14">SHOULD</span> obtain one from their national registration authority or through IANA's Private Enterprise Number (PEN) registry.<a href="#appendix-B-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="appendix-B-5.4">
          <p id="appendix-B-5.4.1">Once allocated, OIDs are never reassigned to different services.<a href="#appendix-B-5.4.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="appendix-B-6">Services <span class="bcp14">SHOULD</span> use versioning in their OID structure to manage protocol evolution. Major, incompatible changes <span class="bcp14">SHOULD</span> use a new OID, whilst minor, backward-compatible changes <span class="bcp14">MAY</span> use the same OID.<a href="#appendix-B-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-guidance">
<section id="appendix-C">
      <h2 id="name-implementation-guidance">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-implementation-guidance" class="section-name selfRef">Implementation Guidance</a>
      </h2>
<div id="performance-optimisations">
<section id="appendix-C.1">
        <h3 id="name-performance-optimisations">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-performance-optimisations" class="section-name selfRef">Performance Optimisations</a>
        </h3>
<p id="appendix-C.1-1">DomainAuth implementations can benefit from several performance optimisations whilst maintaining security:<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-C.1-2">
<li id="appendix-C.1-2.1">
            <p id="appendix-C.1-2.1.1"><strong>Caching Strategies:</strong><a href="#appendix-C.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.1-2.1.2.1">
                <p id="appendix-C.1-2.1.2.1.1">Cache parsed certificates and DNSSEC chains to avoid repeated parsing.<a href="#appendix-C.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-2.1.2.2">
                <p id="appendix-C.1-2.1.2.2.1">Cache verification results for the duration of their validity.<a href="#appendix-C.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-2.1.2.3">
                <p id="appendix-C.1-2.1.2.3.1">Use LRU (Least Recently Used) or similar algorithms for cache management.<a href="#appendix-C.1-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-2.1.2.4">
                <p id="appendix-C.1-2.1.2.4.1">Ensure cache entries are invalidated when they expire.<a href="#appendix-C.1-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="appendix-C.1-2.2">
            <p id="appendix-C.1-2.2.1"><strong>Size Optimisations:</strong><a href="#appendix-C.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.1-2.2.2.1">
                <p id="appendix-C.1-2.2.2.1.1">Minimise the size of DNSSEC chains by removing redundant records.<a href="#appendix-C.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-2.2.2.2">
                <p id="appendix-C.1-2.2.2.2.1">Use the minimum required set of certificates in signature bundles.<a href="#appendix-C.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-2.2.2.3">
                <p id="appendix-C.1-2.2.2.3.1">Consider compression for storage or transmission (whilst maintaining original formats for cryptographic operations).<a href="#appendix-C.1-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="appendix-C.1-2.3">
            <p id="appendix-C.1-2.3.1"><strong>Computational Efficiency:</strong><a href="#appendix-C.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.1-2.3.2.1">
                <p id="appendix-C.1-2.3.2.1.1">Use efficient ASN.1 parsing libraries.<a href="#appendix-C.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-2.3.2.2">
                <p id="appendix-C.1-2.3.2.2.1">Implement lazy parsing for large structures.<a href="#appendix-C.1-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-2.3.2.3">
                <p id="appendix-C.1-2.3.2.3.1">Consider hardware acceleration for cryptographic operations when available.<a href="#appendix-C.1-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-2.3.2.4">
                <p id="appendix-C.1-2.3.2.4.1">Batch operations when processing multiple signatures.<a href="#appendix-C.1-2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="appendix-C.1-2.4">
            <p id="appendix-C.1-2.4.1"><strong>Memory Management:</strong><a href="#appendix-C.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.1-2.4.2.1">
                <p id="appendix-C.1-2.4.2.1.1">Implement streaming processing for large documents.<a href="#appendix-C.1-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-2.4.2.2">
                <p id="appendix-C.1-2.4.2.2.1">Avoid keeping entire documents in memory when possible.<a href="#appendix-C.1-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-2.4.2.3">
                <p id="appendix-C.1-2.4.2.3.1">Free resources promptly after use.<a href="#appendix-C.1-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-2.4.2.4">
                <p id="appendix-C.1-2.4.2.4.1">Consider memory constraints on resource-limited devices.<a href="#appendix-C.1-2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="appendix-C.1-2.5">
            <p id="appendix-C.1-2.5.1"><strong>Parallel Processing:</strong><a href="#appendix-C.1-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.1-2.5.2.1">
                <p id="appendix-C.1-2.5.2.1.1">Parallelise independent verification steps when possible.<a href="#appendix-C.1-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-2.5.2.2">
                <p id="appendix-C.1-2.5.2.2.1">Consider using worker threads for CPU-intensive operations.<a href="#appendix-C.1-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-2.5.2.3">
                <p id="appendix-C.1-2.5.2.3.1">Balance parallelisation benefits against overhead costs.<a href="#appendix-C.1-2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
</section>
</div>
<div id="implementation-recommendations">
<section id="appendix-C.2">
        <h3 id="name-implementation-recommendati">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-implementation-recommendati" class="section-name selfRef">Implementation Recommendations</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="appendix-C.2-1">
<li id="appendix-C.2-1.1">
            <p id="appendix-C.2-1.1.1"><strong>Library/SDK Design:</strong>
  - DomainAuth libraries and SDKs <span class="bcp14">SHOULD</span> provide distinct functions for creating member signatures and organisation signatures.
  - Verification functions <span class="bcp14">SHOULD</span> be unified, with the signature type included in the verification output.
  - Libraries <span class="bcp14">SHOULD NOT</span> require developers to specify the signature type during verification, as this should be determined automatically from the signature bundle.<a href="#appendix-C.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.2-1.2">
            <p id="appendix-C.2-1.2.1"><strong>Use Case Considerations:</strong>
  - Member signatures are recommended for applications where non-repudiation at the individual level is critical.
  - Organisation signatures with member attribution are appropriate for applications where certificate management for individual members is impractical or where organisational accountability is sufficient.<a href="#appendix-C.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.2-1.3">
            <p id="appendix-C.2-1.3.1"><strong>Hybrid Approaches:</strong>
  - Some applications may benefit from supporting both signature types, allowing flexibility based on the specific context or user role.
  - In hybrid implementations, clear policies should govern when each signature type is used.<a href="#appendix-C.2-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="user-interface-guidelines">
<section id="appendix-C.3">
        <h3 id="name-user-interface-guidelines">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-user-interface-guidelines" class="section-name selfRef">User Interface Guidelines</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="appendix-C.3-1">
<li id="appendix-C.3-1.1">
            <p id="appendix-C.3-1.1.1"><strong>Signature Type Indication:</strong> User interfaces <span class="bcp14">SHOULD</span> clearly indicate whether a signature is a member signature or an organisation signature with member attribution. Different visual indicators (icons, colors, labels) <span class="bcp14">SHOULD</span> be used to distinguish between the two signature types.<a href="#appendix-C.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.3-1.2">
            <p id="appendix-C.3-1.2.1"><strong>Attribution Presentation:</strong> For organisation signatures, interfaces <span class="bcp14">SHOULD</span> clearly indicate that the member attribution is a claim made by the organisation, not cryptographic proof. Example phrasing: <code>Signed by example.com on behalf of alice</code> rather than <code>Signed by alice of example.com</code>.<a href="#appendix-C.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.3-1.3">
            <p id="appendix-C.3-1.3.1"><strong>Verification Details:</strong> Interfaces <span class="bcp14">SHOULD</span> provide access to detailed verification information, including the full certification path and validity periods. Advanced users <span class="bcp14">SHOULD</span> be able to view the complete verification process and results.<a href="#appendix-C.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.3-1.4">
            <p id="appendix-C.3-1.4.1"><strong>Error Handling:</strong> Clear error messages <span class="bcp14">SHOULD</span> be displayed when verification fails, with appropriate guidance for users. Different error handling may be appropriate for different signature types, reflecting their distinct trust models.<a href="#appendix-C.3-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-D">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-D-1">The author is grateful to the Open Technology Fund for funding the implementation of VeraId, which heavily influenced the final specification of the VeraId protocol, and therefore DomainAuth as its successor.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">The author would also like to thank the authors of <span>[<a href="#DNS" class="cite xref">DNS</a>]</span>, <span>[<a href="#DNSSEC" class="cite xref">DNSSEC</a>]</span>, <span>[<a href="#X.509" class="cite xref">X.509</a>]</span>, <span>[<a href="#CMS" class="cite xref">CMS</a>]</span>, and <span>[<a href="#ASN.1" class="cite xref">ASN.1</a>]</span>, which underpin the present protocol.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Gus Narea</span></div>
<div dir="auto" class="left"><span class="org">Relaycorp</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gus@relaycorp.tech" class="email">gus@relaycorp.tech</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
